var vessel_fav_handler=function(c){var f=this;if($(f).hasClass("disabled"))!$(f).hasClass("js-loginBttn")&&!$(f).hasClass("scrambled")&&alert(gettext("Your vessel list is full. Please upgrade your account."));else{var h=$(f).attr("data-vesselid"),i=$(f).attr("data-vesselname"),b=$(f).attr("data-vesselflag"),d=$(f).attr("data-vesselicon"),a=$(f).attr("href").split("?")[0];$.get(a+"?tagview=1&vesselid="+h,function(a){var g=[];g.hotlist_count=a.hotlist_count;g.hotlist_deletions_count=a.hotlist_deletions_count;
g.hotlist_adds_left=a.hotlist_adds_left;for(var c=a.tags_raw,m=[],q=0;q<c.length;q++)m.push(c[q].name);$("#vesselsettingsdialog").dialog("destroy");if($(f).hasClass("favs-del")){for(var c=a.vesseltags,k=[],q=0;q<c.length;q++)k.push(c[q].name);openEditDialog(f,h,i,b,d,g,m,k,a.vesselcomment,a.vessel_is_on_hotlist)}else $(f).hasClass("favs-add")&&!$(this).hasClass("js-loginBttn")&&openAddDialog(f,h,i,b,d,g,m)})}c.preventDefault()};
function openAddDialog(c,f,h,i,b,d,a){$("#title_editmode").hide();$("#title_addmode").show();$("#actions_editmode").hide();$("#actions_addmode").show();$("#vesselsettingsdialog #vesselid").text(f);$("#vesselsettingsdialog #hotlist_count").text(d.hotlist_count);$("#vesselsettingsdialog #hotlist_deletions_count").text(d.hotlist_deletions_count);$("#vesselsettingsdialog #hotlist_adds_left").text(d.hotlist_adds_left);$("#vesselsettingsdialog #myTags").tagit({availableTags:a,allowSpaces:!0,beforeTagAdded:function(a,
b){if(b.tagLabel.indexOf("?")!=-1)return!1}});$("#vesselsettingsdialog #myTags").tagit("removeAll");$("#vesselsettingsdialog #comment").val("");$("#vesselsettingsdialog #satais_checkbox").attr("checked",!1);$("#vesselsettingsdialog").dialog({width:620,position:{my:"center",at:"center",of:window},modal:!0,resizable:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#vesselsettingsdialog").dialog("close")});var a='<span class="flag-icon '+i+'"></span> '+h+' <div class="vtype-icon '+
b+'"></div>';$("#ui-dialog-title-vesselsettingsdialog").html(a)},create:function(){var a=$(this);$("#vesselsettingsdialog #cancelbutton").unbind("click");$("#vesselsettingsdialog #cancelbutton").click(function(){a.dialog("close")});$("#vesselsettingsdialog #savebutton").unbind("click");$("#vesselsettingsdialog #savebutton").click(function(){add_to_myfleet(c);a.dialog("close")})}})}
function openEditDialog(c,f,h,i,b,d,a,e,g,j){$("#title_editmode").show();$("#title_addmode").hide();$("#actions_editmode").show();$("#actions_addmode").hide();$("#vesselsettingsdialog #comment").val(g);$("#vesselsettingsdialog #satais_checkbox").attr("checked",j);$("#vesselsettingsdialog #hotliststate").text(j==!0?"checked":"");$("#vesselsettingsdialog #hotlist_count").text(d.hotlist_count);$("#vesselsettingsdialog #hotlist_deletions_count").text(d.hotlist_deletions_count);$("#vesselsettingsdialog #hotlist_adds_left").text(d.hotlist_adds_left);
$("#vesselsettingsdialog #myTags").tagit({availableTags:a,allowSpaces:!0,beforeTagAdded:function(a,b){if(b.tagLabel.indexOf("?")!=-1)return!1}});$("#vesselsettingsdialog #myTags").tagit("removeAll");for(d=0;d<e.length;d++)$("#vesselsettingsdialog #myTags").tagit("createTag",e[d]);$("#vesselsettingsdialog #vesselid").text(f);$("#vesselsettingsdialog").dialog({width:620,position:{my:"center",at:"center",of:window},modal:!0,resizable:!1,open:function(){$(".ui-widget-overlay").bind("click",function(){$("#vesselsettingsdialog").dialog("close")});
var a='<span class="flag-icon '+i+'"></span> '+h+' <div class="vtype-icon '+b+'"></div>';$("#ui-dialog-title-vesselsettingsdialog").html(a)},create:function(){$("#vesselsettingsdialog #btn_remove_from_fleet").unbind("click");$("#vesselsettingsdialog #btn_remove_from_fleet").click(function(){deleteVesselFromList(c)});$("#vesselsettingsdialog #btn_save_and_close").unbind("click");$("#vesselsettingsdialog #btn_save_and_close").click(function(){editVessel(c)})}})}
function deleteVesselFromList(c){var f=remove_from_fleet_question;$("#vesselsettingsdialog #hotliststate").text()=="checked"&&(f=remove_from_fleet_question+" "+hotlist_warning+" "+hotlist_warning_general);confirm(f)&&($("#vesselsettingsdialog #vesselid").text(),f=$(c).attr("href"),$.ajax({timeout:6E4,type:"GET",url:f,success:function(f){if(f.result==!0){$(c).removeClass("favs-del");$(c).removeClass("on_hotlist");$(c).addClass("favs-add");var i=$(c).attr("href").match(/(.*)\?del=(\d+)(.*)/);$(c).attr("href",
i[1]+"?add="+i[2]+i[3]);$(c).hasClass("vesseldetail")&&refresh_vesselsettingscontrol();var b=$(c).attr("data-original-title"),d=$(c).attr("add_title");$(c).attr("data-original-title",d);$(c).attr("del_title",b);f.listitems_left>0&&$("a.nav-icon.favs-add.disabled[href^="+i[1]+"?add]").each(function(){var a=$(this);a.removeClass("disabled");var b=a.attr("title"),g=a.attr("add_title");a.attr("title",g);a.attr("dis_title",b)});$("#vesselsettingsdialog").dialog("close")}}}))}
function editVessel(c){var f=$("#vesselsettingsdialog #vesselid").text(),h=$("#vesselsettingsdialog #comment").val(),i=$("#vesselsettingsdialog #satais_checkbox").attr("checked")=="checked"?!0:!1;if(i||$("#vesselsettingsdialog #hotliststate").text()!="checked"||confirm(unset_hotliststatus_question+" "+hotlist_warning_general)){var b=$(c).attr("href"),d=$("#vesselsettingsdialog #myTags").tagit("assignedTags");$.ajax({context:this,timeout:6E4,type:"POST",url:b,data:{comment:h,satais:i,vesselid:f,tags:d.toString()},
success:function(a){a.result=="ok"&&($(c).removeClass("on_hotlist"),i&&a.sat_success&&$(c).addClass("on_hotlist"),$(c).hasClass("vesseldetail")&&refresh_vesselsettingscontrol(),$("#vesselsettingsdialog").dialog("close"))},error:function(){}})}}
function add_to_myfleet(c){$.ajax({timeout:6E4,type:"GET",url:$(c).attr("href"),success:function(f){if(f.result==!0){set_vesselsettings(c);$(c).removeClass("favs-add");$(c).addClass("favs-del");var h=$(c).attr("href").match(/(.*)\?add=(\d+)(.*)/);$(c).attr("href",h[1]+"?del="+h[2]+h[3]);var i=$(c).attr("data-original-title"),b=$(c).attr("del_title");$(c).attr("data-original-title",b);$(c).attr("add_title",i);f.listitems_left<1&&$("a.nav-icon.favs-add[href^="+h[1]+"?add]").each(function(){var b=$(this);
b.addClass("disabled");var a=b.attr("title"),e=b.attr("dis_title");b.attr("title",e);b.attr("add_title",a)})}else $(c).addClass("disabled")}})}function set_vesselsettings(c){var f=$("#vesselsettingsdialog #myTags").tagit("assignedTags"),h=$("#vesselsettingsdialog #satais_checkbox").attr("checked")=="checked"?!0:!1,i=$("#vesselsettingsdialog #comment").val();post_tags_comment_and_satstatus(c,f,i,h)}
function post_tags_comment_and_satstatus(c,f,h,i){var b=$(c).attr("href").split("?")[0],d=$(c).attr("href").split("?")[1].split("=")[1];$.ajax({context:this,timeout:6E4,type:"POST",url:b,data:{comment:h,vesselid:d,tags:f.toString(),satais:i},success:function(a){a.result=="ok"&&(i&&a.sat_success&&$(c).addClass("on_hotlist"),$(c).hasClass("vesseldetail")&&refresh_vesselsettingscontrol())},error:function(){$("#tagdialog").dialog("close")}})}
function refresh_vesselsettingscontrol(){$.ajax({url:"",data:{control:"vesselsettingscontrol"},success:function(c){$("#vesselsettingscontrol").html(c);$(".tooltip-bs").tooltip();$(".tooltip-bs-html").tooltip({html:!0})}})};(function(c,f,h){(function(c){typeof define==="function"&&define.amd?define(["jquery"],c):jQuery&&!jQuery.fn.dataTable&&c(jQuery)})(function(i){var b=function(d){function a(a,g){var c=b.defaults.columns,d=a.aoColumns.length,c=i.extend({},b.models.oColumn,c,{sSortingClass:a.oClasses.sSortable,sSortingClassJUI:a.oClasses.sSortJUI,nTh:g?g:f.createElement("th"),sTitle:c.sTitle?c.sTitle:g?g.innerHTML:"",aDataSort:c.aDataSort?c.aDataSort:[d],mData:c.mData?c.oDefaults:d});a.aoColumns.push(c);if(a.aoPreSearchCols[d]===
h||a.aoPreSearchCols[d]===null)a.aoPreSearchCols[d]=i.extend({},b.models.oSearch);else{c=a.aoPreSearchCols[d];if(c.bRegex===h)c.bRegex=!0;if(c.bSmart===h)c.bSmart=!0;if(c.bCaseInsensitive===h)c.bCaseInsensitive=!0}e(a,d,null)}function e(a,b,e){var g=a.aoColumns[b];if(e!==h&&e!==null){if(e.mDataProp&&!e.mData)e.mData=e.mDataProp;if(e.sType!==h)g.sType=e.sType,g._bAutoType=!1;i.extend(g,e);t(g,e,"sWidth","sWidthOrig");if(e.iDataSort!==h)g.aDataSort=[e.iDataSort];t(g,e,"aDataSort")}var c=g.mRender?C(g.mRender):
null,d=C(g.mData);g.fnGetData=function(a,b){var e=d(a,b);if(g.mRender&&b&&b!=="")return c(e,b,a);return e};g.fnSetData=P(g.mData);if(!a.oFeatures.bSort)g.bSortable=!1;if(!g.bSortable||i.inArray("asc",g.asSorting)==-1&&i.inArray("desc",g.asSorting)==-1)g.sSortingClass=a.oClasses.sSortableNone,g.sSortingClassJUI="";else if(i.inArray("asc",g.asSorting)==-1&&i.inArray("desc",g.asSorting)==-1)g.sSortingClass=a.oClasses.sSortable,g.sSortingClassJUI=a.oClasses.sSortJUI;else if(i.inArray("asc",g.asSorting)!=
-1&&i.inArray("desc",g.asSorting)==-1)g.sSortingClass=a.oClasses.sSortableAsc,g.sSortingClassJUI=a.oClasses.sSortJUIAscAllowed;else if(i.inArray("asc",g.asSorting)==-1&&i.inArray("desc",g.asSorting)!=-1)g.sSortingClass=a.oClasses.sSortableDesc,g.sSortingClassJUI=a.oClasses.sSortJUIDescAllowed}function g(a){if(a.oFeatures.bAutoWidth===!1)return!1;ea(a);for(var b=0,e=a.aoColumns.length;b<e;b++)a.aoColumns[b].nTh.style.width=a.aoColumns[b].sWidth}function j(a,b){var e=k(a,"bVisible");return typeof e[b]===
"number"?e[b]:null}function m(a,b){var e=k(a,"bVisible"),e=i.inArray(b,e);return e!==-1?e:null}function q(a){return k(a,"bVisible").length}function k(a,b){var e=[];i.map(a.aoColumns,function(a,g){a[b]&&e.push(g)});return e}function p(a){for(var e=b.ext.aTypes,g=e.length,c=0;c<g;c++){var d=e[c](a);if(d!==null)return d}return"string"}function o(a,b){for(var e=b.split(","),g=[],c=0,d=a.aoColumns.length;c<d;c++)for(var j=0;j<d;j++)if(a.aoColumns[c].sName==e[j]){g.push(j);break}return g}function n(a){for(var b=
"",e=0,g=a.aoColumns.length;e<g;e++)b+=a.aoColumns[e].sName+",";if(b.length==g)return"";return b.slice(0,-1)}function r(b,e,g,c){var d,j,f,h,m;if(e)for(d=e.length-1;d>=0;d--){var q=e[d].aTargets;i.isArray(q)||K(b,1,"aTargets must be an array of targets, not a "+typeof q);j=0;for(f=q.length;j<f;j++)if(typeof q[j]==="number"&&q[j]>=0){for(;b.aoColumns.length<=q[j];)a(b);c(q[j],e[d])}else if(typeof q[j]==="number"&&q[j]<0)c(b.aoColumns.length+q[j],e[d]);else if(typeof q[j]==="string"){h=0;for(m=b.aoColumns.length;h<
m;h++)(q[j]=="_all"||i(b.aoColumns[h].nTh).hasClass(q[j]))&&c(h,e[d])}}if(g){d=0;for(b=g.length;d<b;d++)c(d,g[d])}}function s(a,e){var g;g=i.isArray(e)?e.slice():i.extend(!0,{},e);var c=a.aoData.length,d=i.extend(!0,{},b.models.oRow);d._aData=g;a.aoData.push(d);for(var j,d=0,f=a.aoColumns.length;d<f;d++)if(g=a.aoColumns[d],typeof g.fnRender==="function"&&g.bUseRendered&&g.mData!==null?H(a,c,d,M(a,c,d)):H(a,c,d,w(a,c,d)),g._bAutoType&&g.sType!="string"&&(j=w(a,c,d,"type"),j!==null&&j!==""))if(j=p(j),
g.sType===null)g.sType=j;else if(g.sType!=j&&g.sType!="html")g.sType="string";a.aiDisplayMaster.push(c);a.oFeatures.bDeferRender||fa(a,c);return c}function z(a){var e,g,c,d,j,f,h;if(a.bDeferLoading||a.sAjaxSource===null)for(e=a.nTBody.firstChild;e;){if(e.nodeName.toUpperCase()=="TR"){g=a.aoData.length;e._DT_RowIndex=g;a.aoData.push(i.extend(!0,{},b.models.oRow,{nTr:e}));a.aiDisplayMaster.push(g);j=e.firstChild;for(c=0;j;){f=j.nodeName.toUpperCase();if(f=="TD"||f=="TH")H(a,g,c,i.trim(j.innerHTML)),
c++;j=j.nextSibling}}e=e.nextSibling}d=W(a);c=[];e=0;for(g=d.length;e<g;e++)for(j=d[e].firstChild;j;)f=j.nodeName.toUpperCase(),(f=="TD"||f=="TH")&&c.push(j),j=j.nextSibling;g=0;for(d=a.aoColumns.length;g<d;g++){h=a.aoColumns[g];if(h.sTitle===null)h.sTitle=h.nTh.innerHTML;var m=h._bAutoType,q=typeof h.fnRender==="function",n=h.sClass!==null,k=h.bVisible,r,s;if(m||q||n||!k){f=0;for(e=a.aoData.length;f<e;f++){j=a.aoData[f];r=c[f*d+g];if(m&&h.sType!="string"&&(s=w(a,f,g,"type"),s!==""))if(s=p(s),h.sType===
null)h.sType=s;else if(h.sType!=s&&h.sType!="html")h.sType="string";if(h.mRender)r.innerHTML=w(a,f,g,"display");else if(h.mData!==g)r.innerHTML=w(a,f,g,"display");if(q)s=M(a,f,g),r.innerHTML=s,h.bUseRendered&&H(a,f,g,s);n&&(r.className+=" "+h.sClass);k?j._anHidden[g]=null:(j._anHidden[g]=r,r.parentNode.removeChild(r));h.fnCreatedCell&&h.fnCreatedCell.call(a.oInstance,r,w(a,f,g,"display"),j._aData,f,g)}}}if(a.aoRowCreatedCallback.length!==0){e=0;for(g=a.aoData.length;e<g;e++)j=a.aoData[e],I(a,"aoRowCreatedCallback",
null,[j.nTr,j._aData,e])}}function v(a,b){return b._DT_RowIndex!==h?b._DT_RowIndex:null}function E(a,b,e){for(var b=Q(a,b),g=0,a=a.aoColumns.length;g<a;g++)if(b[g]===e)return g;return-1}function y(a,b,e,g){for(var c=[],d=0,j=g.length;d<j;d++)c.push(w(a,b,g[d],e));return c}function w(a,b,e,g){var c=a.aoColumns[e];if((e=c.fnGetData(a.aoData[b]._aData,g))===h){if(a.iDrawError!=a.iDraw&&c.sDefaultContent===null)K(a,0,"Requested unknown parameter "+(typeof c.mData=="function"?"{mData function}":"'"+c.mData+
"'")+" from the data source for row "+b),a.iDrawError=a.iDraw;return c.sDefaultContent}if(e===null&&c.sDefaultContent!==null)e=c.sDefaultContent;else if(typeof e==="function")return e();if(g=="display"&&e===null)return"";return e}function H(a,b,e,g){a.aoColumns[e].fnSetData(a.aoData[b]._aData,g)}function C(a){if(a===null)return function(){return null};else if(typeof a==="function")return function(b,e,g){return a(b,e,g)};else if(typeof a==="string"&&(a.indexOf(".")!==-1||a.indexOf("[")!==-1)){var b=
function(a,e,g){var c=g.split("."),d;if(g!==""){var x=0;for(d=c.length;x<d;x++){if(g=c[x].match(X)){c[x]=c[x].replace(X,"");c[x]!==""&&(a=a[c[x]]);d=[];c.splice(0,x+1);for(var c=c.join("."),x=0,j=a.length;x<j;x++)d.push(b(a[x],e,c));a=g[0].substring(1,g[0].length-1);a=a===""?d:d.join(a);break}if(a===null||a[c[x]]===h)return h;a=a[c[x]]}}return a};return function(e,g){return b(e,g,a)}}else return function(b){return b[a]}}function P(a){if(a===null)return function(){};else if(typeof a==="function")return function(b,
e){a(b,"set",e)};else if(typeof a==="string"&&(a.indexOf(".")!==-1||a.indexOf("[")!==-1)){var b=function(a,e,g){var g=g.split("."),c,d,x=0;for(d=g.length-1;x<d;x++){if(c=g[x].match(X)){g[x]=g[x].replace(X,"");a[g[x]]=[];c=g.slice();c.splice(0,x+1);d=c.join(".");for(var j=0,f=e.length;j<f;j++)c={},b(c,e[j],d),a[g[x]].push(c);return}if(a[g[x]]===null||a[g[x]]===h)a[g[x]]={};a=a[g[x]]}a[g[g.length-1].replace(X,"")]=e};return function(e,g){return b(e,g,a)}}else return function(b,e){b[a]=e}}function B(a){for(var b=
[],e=a.aoData.length,g=0;g<e;g++)b.push(a.aoData[g]._aData);return b}function O(a){a.aoData.splice(0,a.aoData.length);a.aiDisplayMaster.splice(0,a.aiDisplayMaster.length);a.aiDisplay.splice(0,a.aiDisplay.length);F(a)}function R(a,b){for(var e=-1,g=0,c=a.length;g<c;g++)a[g]==b?e=g:a[g]>b&&a[g]--;e!=-1&&a.splice(e,1)}function M(a,b,e){var g=a.aoColumns[e];return g.fnRender({iDataRow:b,iDataColumn:e,oSettings:a,aData:a.aoData[b]._aData,mDataProp:g.mData},w(a,b,e,"display"))}function fa(a,b){var e=a.aoData[b],
g;if(e.nTr===null){e.nTr=f.createElement("tr");e.nTr._DT_RowIndex=b;if(e._aData.DT_RowId)e.nTr.id=e._aData.DT_RowId;if(e._aData.DT_RowClass)e.nTr.className=e._aData.DT_RowClass;for(var c=0,d=a.aoColumns.length;c<d;c++){var j=a.aoColumns[c];g=f.createElement(j.sCellType);g.innerHTML=typeof j.fnRender==="function"&&(!j.bUseRendered||j.mData===null)?M(a,b,c):w(a,b,c,"display");if(j.sClass!==null)g.className=j.sClass;j.bVisible?(e.nTr.appendChild(g),e._anHidden[c]=null):e._anHidden[c]=g;j.fnCreatedCell&&
j.fnCreatedCell.call(a.oInstance,g,w(a,b,c,"display"),e._aData,b,c)}I(a,"aoRowCreatedCallback",null,[e.nTr,e._aData,b])}}function ra(a){var b,e,g;if(i("th, td",a.nTHead).length!==0){b=0;for(g=a.aoColumns.length;b<g;b++)if(e=a.aoColumns[b].nTh,e.setAttribute("role","columnheader"),a.aoColumns[b].bSortable&&(e.setAttribute("tabindex",a.iTabIndex),e.setAttribute("aria-controls",a.sTableId)),a.aoColumns[b].sClass!==null&&i(e).addClass(a.aoColumns[b].sClass),a.aoColumns[b].sTitle!=e.innerHTML)e.innerHTML=
a.aoColumns[b].sTitle}else{var c=f.createElement("tr");b=0;for(g=a.aoColumns.length;b<g;b++)e=a.aoColumns[b].nTh,e.innerHTML=a.aoColumns[b].sTitle,e.setAttribute("tabindex","0"),a.aoColumns[b].sClass!==null&&i(e).addClass(a.aoColumns[b].sClass),c.appendChild(e);i(a.nTHead).html("")[0].appendChild(c);Y(a.aoHeader,a.nTHead)}i(a.nTHead).children("tr").attr("role","row");if(a.bJUI){b=0;for(g=a.aoColumns.length;b<g;b++){e=a.aoColumns[b].nTh;c=f.createElement("div");c.className=a.oClasses.sSortJUIWrapper;
i(e).contents().appendTo(c);var d=f.createElement("span");d.className=a.oClasses.sSortIcon;c.appendChild(d);e.appendChild(c)}}if(a.oFeatures.bSort)for(b=0;b<a.aoColumns.length;b++)a.aoColumns[b].bSortable!==!1?ga(a,a.aoColumns[b].nTh,b):i(a.aoColumns[b].nTh).addClass(a.oClasses.sSortableNone);a.oClasses.sFooterTH!==""&&i(a.nTFoot).children("tr").children("th").addClass(a.oClasses.sFooterTH);if(a.nTFoot!==null){e=T(a,null,a.aoFooter);b=0;for(g=a.aoColumns.length;b<g;b++)if(e[b])a.aoColumns[b].nTf=
e[b],a.aoColumns[b].sClass&&i(e[b]).addClass(a.aoColumns[b].sClass)}}function Z(a,b,e){var g,c,d,j=[],f=[],i=a.aoColumns.length,m;e===h&&(e=!1);g=0;for(c=b.length;g<c;g++){j[g]=b[g].slice();j[g].nTr=b[g].nTr;for(d=i-1;d>=0;d--)!a.aoColumns[d].bVisible&&!e&&j[g].splice(d,1);f.push([])}g=0;for(c=j.length;g<c;g++){if(a=j[g].nTr)for(;d=a.firstChild;)a.removeChild(d);d=0;for(b=j[g].length;d<b;d++)if(m=i=1,f[g][d]===h){a.appendChild(j[g][d].cell);for(f[g][d]=1;j[g+i]!==h&&j[g][d].cell==j[g+i][d].cell;)f[g+
i][d]=1,i++;for(;j[g][d+m]!==h&&j[g][d].cell==j[g][d+m].cell;){for(e=0;e<i;e++)f[g+e][d+m]=1;m++}j[g][d].cell.rowSpan=i;j[g][d].cell.colSpan=m}}}function D(a){var b=I(a,"aoPreDrawCallback","preDraw",[a]);if(i.inArray(!1,b)!==-1)N(a,!1);else{var e,g,b=[],c=0,d=a.asStripeClasses.length;e=a.aoOpenRows.length;a.bDrawing=!0;if(a.iInitDisplayStart!==h&&a.iInitDisplayStart!=-1)a._iDisplayStart=a.oFeatures.bServerSide?a.iInitDisplayStart:a.iInitDisplayStart>=a.fnRecordsDisplay()?0:a.iInitDisplayStart,a.iInitDisplayStart=
-1,F(a);if(a.bDeferLoading)a.bDeferLoading=!1,a.iDraw++;else if(a.oFeatures.bServerSide){if(!a.bDestroying&&!sa(a))return}else a.iDraw++;if(a.aiDisplay.length!==0){var j=a._iDisplayStart;g=a._iDisplayEnd;if(a.oFeatures.bServerSide)j=0,g=a.aoData.length;for(;j<g;j++){var m=a.aoData[a.aiDisplay[j]];m.nTr===null&&fa(a,a.aiDisplay[j]);var n=m.nTr;if(d!==0){var k=a.asStripeClasses[c%d];if(m._sRowStripe!=k)i(n).removeClass(m._sRowStripe).addClass(k),m._sRowStripe=k}I(a,"aoRowCallback",null,[n,a.aoData[a.aiDisplay[j]]._aData,
c,j]);b.push(n);c++;if(e!==0)for(m=0;m<e;m++)if(n==a.aoOpenRows[m].nParent){b.push(a.aoOpenRows[m].nTr);break}}}else{b[0]=f.createElement("tr");if(a.asStripeClasses[0])b[0].className=a.asStripeClasses[0];e=a.oLanguage;d=e.sZeroRecords;if(a.iDraw==1&&a.sAjaxSource!==null&&!a.oFeatures.bServerSide)d=e.sLoadingRecords;else if(e.sEmptyTable&&a.fnRecordsTotal()===0)d=e.sEmptyTable;e=f.createElement("td");e.setAttribute("valign","top");e.colSpan=q(a);e.className=a.oClasses.sRowEmpty;e.innerHTML=ha(a,d);
b[c].appendChild(e)}I(a,"aoHeaderCallback","header",[i(a.nTHead).children("tr")[0],B(a),a._iDisplayStart,a.fnDisplayEnd(),a.aiDisplay]);I(a,"aoFooterCallback","footer",[i(a.nTFoot).children("tr")[0],B(a),a._iDisplayStart,a.fnDisplayEnd(),a.aiDisplay]);c=f.createDocumentFragment();e=f.createDocumentFragment();if(a.nTBody){d=a.nTBody.parentNode;e.appendChild(a.nTBody);if(!a.oScroll.bInfinite||!a._bInitComplete||a.bSorted||a.bFiltered)for(;e=a.nTBody.firstChild;)a.nTBody.removeChild(e);e=0;for(g=b.length;e<
g;e++)c.appendChild(b[e]);a.nTBody.appendChild(c);d!==null&&d.appendChild(a.nTBody)}I(a,"aoDrawCallback","draw",[a]);a.bSorted=!1;a.bFiltered=!1;a.bDrawing=!1;a.oFeatures.bServerSide&&(N(a,!1),a._bInitComplete||aa(a))}}function ba(a){a.oFeatures.bSort?U(a,a.oPreviousSearch):a.oFeatures.bFilter?S(a,a.oPreviousSearch):(F(a),D(a))}function ta(a){var e=i("<div></div>")[0],g=i(a.nTable).parents("div."+a.oClasses.sWrapper+":first");g.length?(g.attr("id",a.sTableId+"_wrapper"),g.attr("role","grid"),a.nTableWrapper=
g[0]):(a.nTable.parentNode.insertBefore(e,a.nTable),a.nTableWrapper=i('<div id="'+a.sTableId+'_wrapper" class="'+a.oClasses.sWrapper+'" role="grid"></div>')[0]);a.nTableReinsertBefore=a.nTable.nextSibling;for(var c=a.nTableWrapper,d=a.sDom.split(""),j,f,h,m,q,n,k,p,r=0;r<d.length;r++){p=f=0;h=d[r];if(h=="<"){m=i("<div></div>")[0];q=d[r+1];if(q=="'"||q=='"'){n="";for(k=2;d[r+k]!=q;)n+=d[r+k],k++;if(n=="H")n=a.oClasses.sJUIHeader;else if(n=="F")n=a.oClasses.sJUIFooter;n.indexOf(".")!=-1?(q=n.split("."),
m.id=q[0].substr(1,q[0].length-1),m.className=q[1]):n.charAt(0)=="#"?m.id=n.substr(1,n.length-1):m.className=n;r+=k}c.appendChild(m);c=m}else if(h==">")c=c.parentNode;else if(h=="l"&&a.oFeatures.bPaginate&&a.oFeatures.bLengthChange)p=i("div."+a.oClasses.sLength,a.nTableWrapper).length>0,j=ua(a),f=1;else if(h=="f"&&a.oFeatures.bFilter)j=va(a),f=1;else if(h=="r"&&a.oFeatures.bProcessing)j=wa(a),f=1;else if(h=="t")p=1,j=xa(a),f=1;else if(h=="i"&&a.oFeatures.bInfo)p=i("div."+a.oClasses.sInfo,a.nTableWrapper).length>
0,j=ya(a),f=1;else if(h=="p"&&a.oFeatures.bPaginate)p=i("div."+a.oClasses.sPaging.split(" ")[0],a.nTableWrapper).length>0,j=za(a),f=1;else if(b.ext.aoFeatures.length!==0){m=b.ext.aoFeatures;k=0;for(q=m.length;k<q;k++)if(h==m[k].cFeature){(j=m[k].fnInit(a))&&(f=1);break}}f==1&&j!==null&&(typeof a.aanFeatures[h]!=="object"&&(a.aanFeatures[h]=[]),a.aanFeatures[h].push(j),p||c.appendChild(j))}g.length||e.parentNode.replaceChild(a.nTableWrapper,e)}function Y(a,b){var e=i(b).children("tr"),g,c,d,j,f,h,
m,q,n,k,p=function(a,b,e){for(a=a[b];a[e];)e++;return e};a.splice(0,a.length);d=0;for(h=e.length;d<h;d++)a.push([]);d=0;for(h=e.length;d<h;d++){g=e[d];for(c=g.firstChild;c;){if(c.nodeName.toUpperCase()=="TD"||c.nodeName.toUpperCase()=="TH"){q=c.getAttribute("colspan")*1;n=c.getAttribute("rowspan")*1;q=!q||q===0||q===1?1:q;n=!n||n===0||n===1?1:n;m=p(a,d,0);k=q===1?!0:!1;for(f=0;f<q;f++)for(j=0;j<n;j++)a[d+j][m+f]={cell:c,unique:k},a[d+j].nTr=g}c=c.nextSibling}}}function T(a,b,e){var g=[];if(!e)e=a.aoHeader,
b&&(e=[],Y(e,b));for(var b=0,c=e.length;b<c;b++)for(var d=0,j=e[b].length;d<j;d++)if(e[b][d].unique&&(!g[d]||!a.bSortCellsTop))g[d]=e[b][d].cell;return g}function sa(a){if(a.bAjaxDataGet){a.iDraw++;N(a,!0);var b=Aa(a);ia(a,b);a.fnServerData.call(a.oInstance,a.sAjaxSource,b,function(b){Ba(a,b)},a);return!1}else return!0}function Aa(a){var b=a.aoColumns.length,e=[],g,c,d,j;e.push({name:"sEcho",value:a.iDraw});e.push({name:"iColumns",value:b});e.push({name:"sColumns",value:n(a)});e.push({name:"iDisplayStart",
value:a._iDisplayStart});e.push({name:"iDisplayLength",value:a.oFeatures.bPaginate!==!1?a._iDisplayLength:-1});for(d=0;d<b;d++)g=a.aoColumns[d].mData,e.push({name:"mDataProp_"+d,value:typeof g==="function"?"function":g});if(a.oFeatures.bFilter!==!1){e.push({name:"sSearch",value:a.oPreviousSearch.sSearch});e.push({name:"bRegex",value:a.oPreviousSearch.bRegex});for(d=0;d<b;d++)e.push({name:"sSearch_"+d,value:a.aoPreSearchCols[d].sSearch}),e.push({name:"bRegex_"+d,value:a.aoPreSearchCols[d].bRegex}),
e.push({name:"bSearchable_"+d,value:a.aoColumns[d].bSearchable})}if(a.oFeatures.bSort!==!1){var f=0;g=a.aaSortingFixed!==null?a.aaSortingFixed.concat(a.aaSorting):a.aaSorting.slice();for(d=0;d<g.length;d++){c=a.aoColumns[g[d][0]].aDataSort;for(j=0;j<c.length;j++)e.push({name:"iSortCol_"+f,value:c[j]}),e.push({name:"sSortDir_"+f,value:g[d][1]}),f++}e.push({name:"iSortingCols",value:f});for(d=0;d<b;d++)e.push({name:"bSortable_"+d,value:a.aoColumns[d].bSortable})}return e}function ia(a,b){I(a,"aoServerParams",
"serverParams",[b])}function Ba(a,b){if(b.sEcho!==h)if(b.sEcho*1<a.iDraw)return;else a.iDraw=b.sEcho*1;(!a.oScroll.bInfinite||a.oScroll.bInfinite&&(a.bSorted||a.bFiltered))&&O(a);a._iRecordsTotal=parseInt(b.iTotalRecords,10);a._iRecordsDisplay=parseInt(b.iTotalDisplayRecords,10);var e=n(a),e=b.sColumns!==h&&e!==""&&b.sColumns!=e,g;e&&(g=o(a,b.sColumns));for(var c=C(a.sAjaxDataProp)(b),d=0,j=c.length;d<j;d++)if(e){for(var f=[],i=0,m=a.aoColumns.length;i<m;i++)f.push(c[d][g[i]]);s(a,f)}else s(a,c[d]);
a.aiDisplay=a.aiDisplayMaster.slice();a.bAjaxDataGet=!1;D(a);a.bAjaxDataGet=!0;N(a,!1)}function va(a){var b=a.oPreviousSearch,e=a.oLanguage.sSearch,e=e.indexOf("_INPUT_")!==-1?e.replace("_INPUT_",'<input type="text" />'):e===""?'<input type="text" />':e+' <input type="text" />',g=f.createElement("div");g.className=a.oClasses.sFilter;g.innerHTML="<label>"+e+"</label>";if(!a.aanFeatures.f)g.id=a.sTableId+"_filter";e=i('input[type="text"]',g);g._DT_Input=e[0];e.val(b.sSearch.replace('"',"&quot;"));e.bind("keyup.DT",
function(){for(var e=a.aanFeatures.f,g=this.value===""?"":this.value,c=0,d=e.length;c<d;c++)e[c]!=i(this).parents("div.dataTables_filter")[0]&&i(e[c]._DT_Input).val(g);g!=b.sSearch&&S(a,{sSearch:g,bRegex:b.bRegex,bSmart:b.bSmart,bCaseInsensitive:b.bCaseInsensitive})});e.attr("aria-controls",a.sTableId).bind("keypress.DT",function(a){if(a.keyCode==13)return!1});return g}function S(a,b,e){var g=a.oPreviousSearch,c=a.aoPreSearchCols,d=function(a){g.sSearch=a.sSearch;g.bRegex=a.bRegex;g.bSmart=a.bSmart;
g.bCaseInsensitive=a.bCaseInsensitive};if(a.oFeatures.bServerSide)d(b);else{Ca(a,b.sSearch,e,b.bRegex,b.bSmart,b.bCaseInsensitive);d(b);for(b=0;b<a.aoPreSearchCols.length;b++)Da(a,c[b].sSearch,b,c[b].bRegex,c[b].bSmart,c[b].bCaseInsensitive);Ea(a)}a.bFiltered=!0;i(a.oInstance).trigger("filter",a);a._iDisplayStart=0;F(a);D(a);ja(a,0)}function Ea(a){for(var e=b.ext.afnFiltering,g=k(a,"bSearchable"),c=0,d=e.length;c<d;c++)for(var j=0,f=0,h=a.aiDisplay.length;f<h;f++){var i=a.aiDisplay[f-j];e[c](a,y(a,
i,"filter",g),i)||(a.aiDisplay.splice(f-j,1),j++)}}function Da(a,b,e,g,c,d){if(b!=="")for(var j=0,b=ka(b,g,c,d),g=a.aiDisplay.length-1;g>=0;g--)c=Fa(w(a,a.aiDisplay[g],e,"filter"),a.aoColumns[e].sType),b.test(c)||(a.aiDisplay.splice(g,1),j++)}function Ca(a,e,g,c,d,j){c=ka(e,c,d,j);d=a.oPreviousSearch;g||(g=0);b.ext.afnFiltering.length!==0&&(g=1);if(e.length<=0)a.aiDisplay.splice(0,a.aiDisplay.length),a.aiDisplay=a.aiDisplayMaster.slice();else if(a.aiDisplay.length==a.aiDisplayMaster.length||d.sSearch.length>
e.length||g==1||e.indexOf(d.sSearch)!==0){a.aiDisplay.splice(0,a.aiDisplay.length);ja(a,1);for(e=0;e<a.aiDisplayMaster.length;e++)c.test(a.asDataSearch[e])&&a.aiDisplay.push(a.aiDisplayMaster[e])}else for(e=g=0;e<a.asDataSearch.length;e++)c.test(a.asDataSearch[e])||(a.aiDisplay.splice(e-g,1),g++)}function ja(a,b){if(!a.oFeatures.bServerSide){a.asDataSearch=[];for(var e=k(a,"bSearchable"),g=b===1?a.aiDisplayMaster:a.aiDisplay,c=0,d=g.length;c<d;c++)a.asDataSearch[c]=la(a,y(a,g[c],"filter",e))}}function la(a,
b){var e=b.join("  ");e.indexOf("&")!==-1&&(e=i("<div>").html(e).text());return e.replace(/[\n\r]/g," ")}function ka(a,b,e,g){e?(a=b?a.split(" "):ma(a).split(" "),a="^(?=.*?"+a.join(")(?=.*?")+").*$"):a=b?a:ma(a);return RegExp(a,g?"i":"")}function Fa(a,e){if(typeof b.ext.ofnSearch[e]==="function")return b.ext.ofnSearch[e](a);else if(a===null)return"";else if(e=="html")return a.replace(/[\r\n]/g," ").replace(/<.*?>/g,"");else if(typeof a==="string")return a.replace(/[\r\n]/g," ");return a}function ma(a){return a.replace(RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^|\\-)",
"g"),"\\$1")}function ya(a){var b=i("div."+a.oClasses.sInfo,a.nTableWrapper);b.length?b=b[0]:(b=f.createElement("div"),b.className=a.oClasses.sInfo);if(!a.aanFeatures.i)a.aoDrawCallback.push({fn:Ga,sName:"information"}),b.id=a.sTableId+"_info";a.nTable.setAttribute("aria-describedby",a.sTableId+"_info");return b}function Ga(a){if(a.oFeatures.bInfo&&a.aanFeatures.i.length!==0){var b=a.oLanguage,e=a._iDisplayStart+1,g=a.fnDisplayEnd(),c=a.fnRecordsTotal(),d=a.fnRecordsDisplay(),j;j=d===0?b.sInfoEmpty:
b.sInfo;d!=c&&(j+="<br />"+b.sInfoFiltered);j+=b.sInfoPostFix;j=ha(a,j);b.fnInfoCallback!==null&&(j=b.fnInfoCallback.call(a.oInstance,a,e,g,c,d,j));a=a.aanFeatures.i;b=0;for(e=a.length;b<e;b++)i(a[b]).html(j)}}function ha(a,b){var e=a.fnFormatNumber(a._iDisplayStart+1),g=a.fnDisplayEnd(),g=a.fnFormatNumber(g),c=a.fnRecordsDisplay(),c=a.fnFormatNumber(c),d=a.fnRecordsTotal(),d=a.fnFormatNumber(d);a.oScroll.bInfinite&&(e=a.fnFormatNumber(1));return b.replace(/_START_/g,e).replace(/_END_/g,g).replace(/_TOTAL_/g,
c).replace(/_MAX_/g,d)}function ca(a){var b,e,g=a.iInitDisplayStart;if(a.bInitialised===!1)setTimeout(function(){ca(a)},200);else{ta(a);ra(a);Z(a,a.aoHeader);a.nTFoot&&Z(a,a.aoFooter);N(a,!0);a.oFeatures.bAutoWidth&&ea(a);b=0;for(e=a.aoColumns.length;b<e;b++)if(a.aoColumns[b].sWidth!==null)a.aoColumns[b].nTh.style.width=u(a.aoColumns[b].sWidth);a.oFeatures.bSort?U(a):a.oFeatures.bFilter?S(a,a.oPreviousSearch):(a.aiDisplay=a.aiDisplayMaster.slice(),F(a),D(a));a.sAjaxSource!==null&&!a.oFeatures.bServerSide?
(e=[],ia(a,e),a.fnServerData.call(a.oInstance,a.sAjaxSource,e,function(e){var c=a.sAjaxDataProp!==""?C(a.sAjaxDataProp)(e):e;for(b=0;b<c.length;b++)s(a,c[b]);a.iInitDisplayStart=g;a.oFeatures.bSort?U(a):(a.aiDisplay=a.aiDisplayMaster.slice(),F(a),D(a));N(a,!1);aa(a,e)},a)):a.oFeatures.bServerSide||(N(a,!1),aa(a))}}function aa(a,b){a._bInitComplete=!0;I(a,"aoInitComplete","init",[a,b])}function na(a){var e=b.defaults.oLanguage;!a.sEmptyTable&&a.sZeroRecords&&e.sEmptyTable==="No data available in table"&&
t(a,a,"sZeroRecords","sEmptyTable");!a.sLoadingRecords&&a.sZeroRecords&&e.sLoadingRecords==="Loading..."&&t(a,a,"sZeroRecords","sLoadingRecords")}function ua(a){if(a.oScroll.bInfinite)return null;var b='<select size="1" '+('name="'+a.sTableId+'_length"')+">",e,g,c=a.aLengthMenu;if(c.length==2&&typeof c[0]==="object"&&typeof c[1]==="object"){e=0;for(g=c[0].length;e<g;e++)b+='<option value="'+c[0][e]+'">'+c[1][e]+"</option>"}else{e=0;for(g=c.length;e<g;e++)b+='<option value="'+c[e]+'">'+c[e]+"</option>"}b+=
"</select>";c=i("div."+a.oClasses.sLength,a.nTableWrapper);c.length?c=c[0]:(c=f.createElement("div"),c.className=a.oClasses.sLength);if(!a.aanFeatures.l)c.id=a.sTableId+"_length";c.innerHTML="<label>"+a.oLanguage.sLengthMenu.replace("_MENU_",b)+"</label>";i('select option[value="'+a._iDisplayLength+'"]',c).attr("selected",!0);i("select",c).bind("change.DT",function(){var b=i(this).val(),c=a.aanFeatures.l;e=0;for(g=c.length;e<g;e++)c[e]!=this.parentNode&&i("select",c[e]).val(b);a._iDisplayLength=parseInt(b,
10);F(a);if(a.fnDisplayEnd()==a.fnRecordsDisplay()&&(a._iDisplayStart=a.fnDisplayEnd()-a._iDisplayLength,a._iDisplayStart<0))a._iDisplayStart=0;if(a._iDisplayLength==-1)a._iDisplayStart=0;D(a)});i("select",c).attr("aria-controls",a.sTableId);return c}function F(a){a._iDisplayEnd=a.oFeatures.bPaginate===!1?a.aiDisplay.length:a._iDisplayStart+a._iDisplayLength>a.aiDisplay.length||a._iDisplayLength==-1?a.aiDisplay.length:a._iDisplayStart+a._iDisplayLength}function za(a){if(a.oScroll.bInfinite)return null;
var e=i("div."+a.oClasses.sPaging.split(" ")[0],a.nTableWrapper),e=e.length?e[0]:f.createElement("div");e.className=a.oClasses.sPaging+a.sPaginationType;b.ext.oPagination[a.sPaginationType].fnInit(a,e,function(a){F(a);D(a)});a.aanFeatures.p||a.aoDrawCallback.push({fn:function(a){b.ext.oPagination[a.sPaginationType].fnUpdate(a,function(a){F(a);D(a)})},sName:"pagination"});return e}function oa(a,b){var e=a._iDisplayStart;if(typeof b==="number"){if(a._iDisplayStart=b*a._iDisplayLength,a._iDisplayStart>
a.fnRecordsDisplay())a._iDisplayStart=0}else if(b=="first")a._iDisplayStart=0;else if(b=="previous"){if(a._iDisplayStart=a._iDisplayLength>=0?a._iDisplayStart-a._iDisplayLength:0,a._iDisplayStart<0)a._iDisplayStart=0}else if(b=="next")a._iDisplayLength>=0?a._iDisplayStart+a._iDisplayLength<a.fnRecordsDisplay()&&(a._iDisplayStart+=a._iDisplayLength):a._iDisplayStart=0;else if(b=="last")if(a._iDisplayLength>=0){var g=parseInt((a.fnRecordsDisplay()-1)/a._iDisplayLength,10)+1;a._iDisplayStart=(g-1)*a._iDisplayLength}else a._iDisplayStart=
0;else K(a,0,"Unknown paging action: "+b);i(a.oInstance).trigger("page",a);return e!=a._iDisplayStart}function wa(a){var b=f.createElement("div");if(!a.aanFeatures.r)b.id=a.sTableId+"_processing";b.innerHTML=a.oLanguage.sProcessing;b.className=a.oClasses.sProcessing;a.nTable.parentNode.insertBefore(b,a.nTable);return b}function N(a,b){if(a.oFeatures.bProcessing)for(var e=a.aanFeatures.r,g=0,c=e.length;g<c;g++)e[g].style.visibility=b?"visible":"hidden";i(a.oInstance).trigger("processing",[a,b])}function xa(a){if(a.oScroll.sX===
""&&a.oScroll.sY==="")return a.nTable;var b=f.createElement("div"),e=f.createElement("div"),g=f.createElement("div"),c=f.createElement("div"),d=f.createElement("div"),j=f.createElement("div"),h=a.nTable.cloneNode(!1),m=a.nTable.cloneNode(!1),q=a.nTable.getElementsByTagName("thead")[0],n=a.nTable.getElementsByTagName("tfoot").length===0?null:a.nTable.getElementsByTagName("tfoot")[0],k=a.oClasses;e.appendChild(g);d.appendChild(j);c.appendChild(a.nTable);b.appendChild(e);b.appendChild(c);g.appendChild(h);
h.appendChild(q);n!==null&&(b.appendChild(d),j.appendChild(m),m.appendChild(n));b.className=k.sScrollWrapper;e.className=k.sScrollHead;g.className=k.sScrollHeadInner;c.className=k.sScrollBody;d.className=k.sScrollFoot;j.className=k.sScrollFootInner;if(a.oScroll.bAutoCss)e.style.overflow="hidden",e.style.position="relative",d.style.overflow="hidden",c.style.overflow="auto";e.style.border="0";e.style.width="100%";d.style.border="0";g.style.width=a.oScroll.sXInner!==""?a.oScroll.sXInner:"100%";h.removeAttribute("id");
h.style.marginLeft="0";a.nTable.style.marginLeft="0";if(n!==null)m.removeAttribute("id"),m.style.marginLeft="0";g=i(a.nTable).children("caption");g.length>0&&(g=g[0],g._captionSide==="top"?h.appendChild(g):g._captionSide==="bottom"&&n&&m.appendChild(g));if(a.oScroll.sX!==""){e.style.width=u(a.oScroll.sX);c.style.width=u(a.oScroll.sX);if(n!==null)d.style.width=u(a.oScroll.sX);i(c).scroll(function(){e.scrollLeft=this.scrollLeft;if(n!==null)d.scrollLeft=this.scrollLeft})}if(a.oScroll.sY!=="")c.style.height=
u(a.oScroll.sY);a.aoDrawCallback.push({fn:Ha,sName:"scrolling"});a.oScroll.bInfinite&&i(c).scroll(function(){!a.bDrawing&&i(this).scrollTop()!==0&&i(this).scrollTop()+i(this).height()>i(a.nTable).height()-a.oScroll.iLoadGap&&a.fnDisplayEnd()<a.fnRecordsDisplay()&&(oa(a,"next"),F(a),D(a))});a.nScrollHead=e;a.nScrollFoot=d;return b}function Ha(a){var b=a.nScrollHead.getElementsByTagName("div")[0],e=b.getElementsByTagName("table")[0],g=a.nTable.parentNode,c,d,f,h,m,q,n,k,p=[],r=[],s=a.nTFoot!==null?
a.nScrollFoot.getElementsByTagName("div")[0]:null,z=a.nTFoot!==null?s.getElementsByTagName("table")[0]:null,o=a.oBrowser.bScrollOversize,v=function(a){n=a.style;n.paddingTop="0";n.paddingBottom="0";n.borderTopWidth="0";n.borderBottomWidth="0";n.height=0};i(a.nTable).children("thead, tfoot").remove();c=i(a.nTHead).clone()[0];a.nTable.insertBefore(c,a.nTable.childNodes[0]);f=a.nTHead.getElementsByTagName("tr");h=c.getElementsByTagName("tr");a.nTFoot!==null&&(m=i(a.nTFoot).clone()[0],a.nTable.insertBefore(m,
a.nTable.childNodes[1]),q=a.nTFoot.getElementsByTagName("tr"),m=m.getElementsByTagName("tr"));if(a.oScroll.sX==="")g.style.width="100%",b.parentNode.style.width="100%";var y=T(a,c);c=0;for(d=y.length;c<d;c++)k=j(a,c),y[c].style.width=a.aoColumns[k].sWidth;a.nTFoot!==null&&J(function(a){a.style.width=""},m);if(a.oScroll.bCollapse&&a.oScroll.sY!=="")g.style.height=g.offsetHeight+a.nTHead.offsetHeight+"px";c=i(a.nTable).outerWidth();if(a.oScroll.sX===""){if(a.nTable.style.width="100%",o&&(i("tbody",
g).height()>g.offsetHeight||i(g).css("overflow-y")=="scroll"))a.nTable.style.width=u(i(a.nTable).outerWidth()-a.oScroll.iBarWidth)}else if(a.oScroll.sXInner!=="")a.nTable.style.width=u(a.oScroll.sXInner);else if(c==i(g).width()&&i(g).height()<i(a.nTable).height()){if(a.nTable.style.width=u(c-a.oScroll.iBarWidth),i(a.nTable).outerWidth()>c-a.oScroll.iBarWidth)a.nTable.style.width=u(c)}else a.nTable.style.width=u(c);c=i(a.nTable).outerWidth();J(v,h);J(function(a){p.push(u(i(a).width()))},h);J(function(a,
b){a.style.width=p[b]},f);i(h).height(0);a.nTFoot!==null&&(J(v,m),J(function(a){r.push(u(i(a).width()))},m),J(function(a,b){a.style.width=r[b]},q),i(m).height(0));J(function(a,b){a.innerHTML="";a.style.width=p[b]},h);a.nTFoot!==null&&J(function(a,b){a.innerHTML="";a.style.width=r[b]},m);if(i(a.nTable).outerWidth()<c){f=g.scrollHeight>g.offsetHeight||i(g).css("overflow-y")=="scroll"?c+a.oScroll.iBarWidth:c;if(o&&(g.scrollHeight>g.offsetHeight||i(g).css("overflow-y")=="scroll"))a.nTable.style.width=
u(f-a.oScroll.iBarWidth);g.style.width=u(f);a.nScrollHead.style.width=u(f);if(a.nTFoot!==null)a.nScrollFoot.style.width=u(f);a.oScroll.sX===""?K(a,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width."):a.oScroll.sXInner!==""&&K(a,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")}else if(g.style.width=
u("100%"),a.nScrollHead.style.width=u("100%"),a.nTFoot!==null)a.nScrollFoot.style.width=u("100%");if(a.oScroll.sY===""&&o)g.style.height=u(a.nTable.offsetHeight+a.oScroll.iBarWidth);if(a.oScroll.sY!==""&&a.oScroll.bCollapse&&(g.style.height=u(a.oScroll.sY),o=a.oScroll.sX!==""&&a.nTable.offsetWidth>g.offsetWidth?a.oScroll.iBarWidth:0,a.nTable.offsetHeight<g.offsetHeight))g.style.height=u(a.nTable.offsetHeight+o);o=i(a.nTable).outerWidth();e.style.width=u(o);b.style.width=u(o);e=i(a.nTable).height()>
g.clientHeight||i(g).css("overflow-y")=="scroll";b.style.paddingRight=e?a.oScroll.iBarWidth+"px":"0px";if(a.nTFoot!==null)z.style.width=u(o),s.style.width=u(o),s.style.paddingRight=e?a.oScroll.iBarWidth+"px":"0px";i(g).scroll();if(a.bSorted||a.bFiltered)g.scrollTop=0}function J(a,b,e){for(var g=0,c=0,d=b.length,j,f;c<d;){j=b[c].firstChild;for(f=e?e[c].firstChild:null;j;)j.nodeType===1&&(e?a(j,f,g):a(j,g),g++),j=j.nextSibling,f=e?f.nextSibling:null;c++}}function Ia(a,b){if(!a||a===null||a==="")return 0;
if(!b)b=f.body;var e,g=f.createElement("div");g.style.width=u(a);b.appendChild(g);e=g.offsetWidth;b.removeChild(g);return e}function ea(a){var b=0,e,g=0,c=a.aoColumns.length,d,j,h=i("th",a.nTHead),m=a.nTable.getAttribute("width");j=a.nTable.parentNode;for(d=0;d<c;d++)if(a.aoColumns[d].bVisible&&(g++,a.aoColumns[d].sWidth!==null)){e=Ia(a.aoColumns[d].sWidthOrig,j);if(e!==null)a.aoColumns[d].sWidth=u(e);b++}if(c==h.length&&b===0&&g==c&&a.oScroll.sX===""&&a.oScroll.sY==="")for(d=0;d<a.aoColumns.length;d++){if(e=
i(h[d]).width(),e!==null)a.aoColumns[d].sWidth=u(e)}else{b=a.nTable.cloneNode(!1);d=a.nTHead.cloneNode(!0);g=f.createElement("tbody");e=f.createElement("tr");b.removeAttribute("id");b.appendChild(d);a.nTFoot!==null&&(b.appendChild(a.nTFoot.cloneNode(!0)),J(function(a){a.style.width=""},b.getElementsByTagName("tr")));b.appendChild(g);g.appendChild(e);g=i("thead th",b);g.length===0&&(g=i("tbody tr:eq(0)>td",b));h=T(a,d);for(d=g=0;d<c;d++){var q=a.aoColumns[d];q.bVisible&&q.sWidthOrig!==null&&q.sWidthOrig!==
""?h[d-g].style.width=u(q.sWidthOrig):q.bVisible?h[d-g].style.width="":g++}for(d=0;d<c;d++)a.aoColumns[d].bVisible&&(g=Ja(a,d),g!==null&&(g=g.cloneNode(!0),a.aoColumns[d].sContentPadding!==""&&(g.innerHTML+=a.aoColumns[d].sContentPadding),e.appendChild(g)));j.appendChild(b);if(a.oScroll.sX!==""&&a.oScroll.sXInner!=="")b.style.width=u(a.oScroll.sXInner);else if(a.oScroll.sX!==""){if(b.style.width="",i(b).width()<j.offsetWidth)b.style.width=u(j.offsetWidth)}else if(a.oScroll.sY!=="")b.style.width=u(j.offsetWidth);
else if(m)b.style.width=u(m);b.style.visibility="hidden";Ka(a,b);c=i("tbody tr:eq(0)",b).children();c.length===0&&(c=T(a,i("thead",b)[0]));if(a.oScroll.sX!==""){for(d=g=j=0;d<a.aoColumns.length;d++)a.aoColumns[d].bVisible&&(j+=a.aoColumns[d].sWidthOrig===null?i(c[g]).outerWidth():parseInt(a.aoColumns[d].sWidth.replace("px",""),10)+(i(c[g]).outerWidth()-i(c[g]).width()),g++);b.style.width=u(j);a.nTable.style.width=u(j)}for(d=g=0;d<a.aoColumns.length;d++)if(a.aoColumns[d].bVisible){j=i(c[g]).width();
if(j!==null&&j>0)a.aoColumns[d].sWidth=u(j);g++}c=i(b).css("width");a.nTable.style.width=c.indexOf("%")!==-1?c:u(i(b).outerWidth());b.parentNode.removeChild(b)}if(m)a.nTable.style.width=u(m)}function Ka(a,b){if(a.oScroll.sX===""&&a.oScroll.sY!=="")i(b).width(),b.style.width=u(i(b).outerWidth()-a.oScroll.iBarWidth);else if(a.oScroll.sX!=="")b.style.width=u(i(b).outerWidth())}function Ja(a,b){var e=La(a,b);if(e<0)return null;if(a.aoData[e].nTr===null){var g=f.createElement("td");g.innerHTML=w(a,e,b,
"");return g}return Q(a,e)[b]}function La(a,b){for(var e=-1,g=-1,c=0;c<a.aoData.length;c++){var d=w(a,c,b,"display")+"",d=d.replace(/<.*?>/g,"");if(d.length>e)e=d.length,g=c}return g}function u(a){if(a===null)return"0px";if(typeof a=="number"){if(a<0)return"0px";return a+"px"}var b=a.charCodeAt(a.length-1);if(b<48||b>57)return a;return a+"px"}function Ma(){var a=f.createElement("p"),b=a.style;b.width="100%";b.height="200px";b.padding="0px";var e=f.createElement("div"),b=e.style;b.position="absolute";
b.top="0px";b.left="0px";b.visibility="hidden";b.width="200px";b.height="150px";b.padding="0px";b.overflow="hidden";e.appendChild(a);f.body.appendChild(e);b=a.offsetWidth;e.style.overflow="scroll";a=a.offsetWidth;if(b==a)a=e.clientWidth;f.body.removeChild(e);return b-a}function U(a,e){var g,c,d,j,f,q,n=[],k=[],p=b.ext.oSort,r=a.aoData,s=a.aoColumns,o=a.oLanguage.oAria;if(!a.oFeatures.bServerSide&&(a.aaSorting.length!==0||a.aaSortingFixed!==null)){n=a.aaSortingFixed!==null?a.aaSortingFixed.concat(a.aaSorting):
a.aaSorting.slice();for(g=0;g<n.length;g++)if(c=n[g][0],d=m(a,c),j=a.aoColumns[c].sSortDataType,b.ext.afnSortData[j])if(f=b.ext.afnSortData[j].call(a.oInstance,a,c,d),f.length===r.length){d=0;for(j=r.length;d<j;d++)H(a,d,c,f[d])}else K(a,0,"Returned data sort array (col "+c+") is the wrong length");g=0;for(c=a.aiDisplayMaster.length;g<c;g++)k[a.aiDisplayMaster[g]]=g;var z=n.length,v;g=0;for(c=r.length;g<c;g++)for(d=0;d<z;d++){v=s[n[d][0]].aDataSort;f=0;for(q=v.length;f<q;f++)j=s[v[f]].sType,j=p[(j?
j:"string")+"-pre"],r[g]._aSortData[v[f]]=j?j(w(a,g,v[f],"sort")):w(a,g,v[f],"sort")}a.aiDisplayMaster.sort(function(a,b){var e,g,c,d,j;for(e=0;e<z;e++){j=s[n[e][0]].aDataSort;g=0;for(c=j.length;g<c;g++)if(d=s[j[g]].sType,d=p[(d?d:"string")+"-"+n[e][1]](r[a]._aSortData[j[g]],r[b]._aSortData[j[g]]),d!==0)return d}return p["numeric-asc"](k[a],k[b])})}(e===h||e)&&!a.oFeatures.bDeferRender&&V(a);g=0;for(c=a.aoColumns.length;g<c;g++)j=s[g].sTitle.replace(/<.*?>/g,""),d=s[g].nTh,d.removeAttribute("aria-sort"),
d.removeAttribute("aria-label"),s[g].bSortable?n.length>0&&n[0][0]==g?(d.setAttribute("aria-sort",n[0][1]=="asc"?"ascending":"descending"),d.setAttribute("aria-label",j+((s[g].asSorting[n[0][2]+1]?s[g].asSorting[n[0][2]+1]:s[g].asSorting[0])=="asc"?o.sSortAscending:o.sSortDescending))):d.setAttribute("aria-label",j+(s[g].asSorting[0]=="asc"?o.sSortAscending:o.sSortDescending)):d.setAttribute("aria-label",j);a.bSorted=!0;i(a.oInstance).trigger("sort",a);a.oFeatures.bFilter?S(a,a.oPreviousSearch,1):
(a.aiDisplay=a.aiDisplayMaster.slice(),a._iDisplayStart=0,F(a),D(a))}function ga(a,b,e,g){Na(b,{},function(b){if(a.aoColumns[e].bSortable!==!1){var c=function(){var g,c;if(b.shiftKey){for(var d=!1,j=0;j<a.aaSorting.length;j++)if(a.aaSorting[j][0]==e){d=!0;g=a.aaSorting[j][0];c=a.aaSorting[j][2]+1;a.aoColumns[g].asSorting[c]?(a.aaSorting[j][1]=a.aoColumns[g].asSorting[c],a.aaSorting[j][2]=c):a.aaSorting.splice(j,1);break}d===!1&&a.aaSorting.push([e,a.aoColumns[e].asSorting[0],0])}else a.aaSorting.length==
1&&a.aaSorting[0][0]==e?(g=a.aaSorting[0][0],c=a.aaSorting[0][2]+1,a.aoColumns[g].asSorting[c]||(c=0),a.aaSorting[0][1]=a.aoColumns[g].asSorting[c],a.aaSorting[0][2]=c):(a.aaSorting.splice(0,a.aaSorting.length),a.aaSorting.push([e,a.aoColumns[e].asSorting[0],0]));U(a)};a.oFeatures.bProcessing?(N(a,!0),setTimeout(function(){c();a.oFeatures.bServerSide||N(a,!1)},0)):c();typeof g=="function"&&g(a)}})}function V(a){var b,e,g,c,d,j=a.aoColumns.length,f=a.oClasses;for(b=0;b<j;b++)a.aoColumns[b].bSortable&&
i(a.aoColumns[b].nTh).removeClass(f.sSortAsc+" "+f.sSortDesc+" "+a.aoColumns[b].sSortingClass);e=a.aaSortingFixed!==null?a.aaSortingFixed.concat(a.aaSorting):a.aaSorting.slice();for(b=0;b<a.aoColumns.length;b++)if(a.aoColumns[b].bSortable){d=a.aoColumns[b].sSortingClass;c=-1;for(g=0;g<e.length;g++)if(e[g][0]==b){d=e[g][1]=="asc"?f.sSortAsc:f.sSortDesc;c=g;break}i(a.aoColumns[b].nTh).addClass(d);a.bJUI&&(d=i("span."+f.sSortIcon,a.aoColumns[b].nTh),d.removeClass(f.sSortJUIAsc+" "+f.sSortJUIDesc+" "+
f.sSortJUI+" "+f.sSortJUIAscAllowed+" "+f.sSortJUIDescAllowed),d.addClass(c==-1?a.aoColumns[b].sSortingClassJUI:e[c][1]=="asc"?f.sSortJUIAsc:f.sSortJUIDesc))}else i(a.aoColumns[b].nTh).addClass(a.aoColumns[b].sSortingClass);d=f.sSortColumn;if(a.oFeatures.bSort&&a.oFeatures.bSortClasses){a=Q(a);c=[];for(b=0;b<j;b++)c.push("");b=0;for(g=1;b<e.length;b++)f=parseInt(e[b][0],10),c[f]=d+g,g<3&&g++;d=RegExp(d+"[123]");var h;b=0;for(e=a.length;b<e;b++)if(f=b%j,g=a[b].className,h=c[f],f=g.replace(d,h),f!=
g)a[b].className=i.trim(f);else if(h.length>0&&g.indexOf(h)==-1)a[b].className=g+" "+h}}function pa(a){if(a.oFeatures.bStateSave&&!a.bDestroying){var b,e;b=a.oScroll.bInfinite;var g={iCreate:(new Date).getTime(),iStart:b?0:a._iDisplayStart,iEnd:b?a._iDisplayLength:a._iDisplayEnd,iLength:a._iDisplayLength,aaSorting:i.extend(!0,[],a.aaSorting),oSearch:i.extend(!0,{},a.oPreviousSearch),aoSearchCols:i.extend(!0,[],a.aoPreSearchCols),abVisCols:[]};b=0;for(e=a.aoColumns.length;b<e;b++)g.abVisCols.push(a.aoColumns[b].bVisible);
I(a,"aoStateSaveParams","stateSaveParams",[a,g]);a.fnStateSave.call(a.oInstance,a,g)}}function Oa(a,b){if(a.oFeatures.bStateSave){var e=a.fnStateLoad.call(a.oInstance,a);if(e){var g=I(a,"aoStateLoadParams","stateLoadParams",[a,e]);if(i.inArray(!1,g)===-1){a.oLoadedState=i.extend(!0,{},e);a._iDisplayStart=e.iStart;a.iInitDisplayStart=e.iStart;a._iDisplayEnd=e.iEnd;a._iDisplayLength=e.iLength;a.aaSorting=e.aaSorting.slice();a.saved_aaSorting=e.aaSorting.slice();i.extend(a.oPreviousSearch,e.oSearch);
i.extend(!0,a.aoPreSearchCols,e.aoSearchCols);b.saved_aoColumns=[];for(g=0;g<e.abVisCols.length;g++)b.saved_aoColumns[g]={},b.saved_aoColumns[g].bVisible=e.abVisCols[g];I(a,"aoStateLoaded","stateLoaded",[a,e])}}}}function A(a){for(var e=0;e<b.settings.length;e++)if(b.settings[e].nTable===a)return b.settings[e];return null}function W(a){for(var b=[],a=a.aoData,e=0,g=a.length;e<g;e++)a[e].nTr!==null&&b.push(a[e].nTr);return b}function Q(a,b){var e=[],g,c,d,j,f,i;c=0;var m=a.aoData.length;b!==h&&(c=
b,m=b+1);for(d=c;d<m;d++)if(i=a.aoData[d],i.nTr!==null){c=[];for(g=i.nTr.firstChild;g;)j=g.nodeName.toLowerCase(),(j=="td"||j=="th")&&c.push(g),g=g.nextSibling;j=g=0;for(f=a.aoColumns.length;j<f;j++)a.aoColumns[j].bVisible?e.push(c[j-g]):(e.push(i._anHidden[j]),g++)}return e}function K(a,e,g){a=a===null?"DataTables warning: "+g:"DataTables warning (table id = '"+a.sTableId+"'): "+g;if(e===0)if(b.ext.sErrMode=="alert")alert(a);else throw Error(a);else c.console&&console.log&&console.log(a)}function t(a,
b,e,g){g===h&&(g=e);b[e]!==h&&(a[g]=b[e])}function Pa(a,b){var e,g;for(g in b)b.hasOwnProperty(g)&&(e=b[g],typeof d[g]==="object"&&e!==null&&i.isArray(e)===!1?i.extend(!0,a[g],e):a[g]=e);return a}function Na(a,b,e){i(a).bind("click.DT",b,function(b){a.blur();e(b)}).bind("keypress.DT",b,function(a){a.which===13&&e(a)}).bind("selectstart.DT",function(){return!1})}function G(a,b,e,g){e&&a[b].push({fn:e,sName:g})}function I(a,b,e,g){for(var b=a[b],c=[],d=b.length-1;d>=0;d--)c.push(b[d].fn.apply(a.oInstance,
g));e!==null&&i(a.oInstance).trigger(e,g);return c}function Qa(a){var b=i('<div style="position:absolute; top:0; left:0; height:1px; width:1px; overflow:hidden"><div style="position:absolute; top:1px; left:1px; width:100px; overflow:scroll;"><div id="DT_BrowserTest" style="width:100%; height:10px;"></div></div></div>')[0];f.body.appendChild(b);a.oBrowser.bScrollOversize=i("#DT_BrowserTest",b)[0].offsetWidth===100?!0:!1;f.body.removeChild(b)}function Ra(a){return function(){var e=[A(this[b.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));
return b.ext.oApi[a].apply(this,e)}}var X=/\[.*?\]$/,Sa=c.JSON?JSON.stringify:function(a){var b=typeof a;if(b!=="object"||a===null)return b==="string"&&(a='"'+a+'"'),a+"";var e,g,c=[],d=i.isArray(a);for(e in a)g=a[e],b=typeof g,b==="string"?g='"'+g+'"':b==="object"&&g!==null&&(g=Sa(g)),c.push((d?"":'"'+e+'":')+g);return(d?"[":"{")+c+(d?"]":"}")};this.$=function(a,e){var g,c,d=[],j;c=A(this[b.ext.iApiIndex]);var f=c.aoData,h=c.aiDisplay,m=c.aiDisplayMaster;e||(e={});e=i.extend({},{filter:"none",order:"current",
page:"all"},e);if(e.page=="current"){g=c._iDisplayStart;for(c=c.fnDisplayEnd();g<c;g++)(j=f[h[g]].nTr)&&d.push(j)}else if(e.order=="current"&&e.filter=="none"){g=0;for(c=m.length;g<c;g++)(j=f[m[g]].nTr)&&d.push(j)}else if(e.order=="current"&&e.filter=="applied"){g=0;for(c=h.length;g<c;g++)(j=f[h[g]].nTr)&&d.push(j)}else if(e.order=="original"&&e.filter=="none"){g=0;for(c=f.length;g<c;g++)(j=f[g].nTr)&&d.push(j)}else if(e.order=="original"&&e.filter=="applied"){g=0;for(c=f.length;g<c;g++)j=f[g].nTr,
i.inArray(g,h)!==-1&&j&&d.push(j)}else K(c,1,"Unknown selection options");d=i(d);g=d.filter(a);d=d.find(a);return i([].concat(i.makeArray(g),i.makeArray(d)))};this._=function(a,b){var e=[],g,c,d=this.$(a,b);g=0;for(c=d.length;g<c;g++)e.push(this.fnGetData(d[g]));return e};this.fnAddData=function(a,e){if(a.length===0)return[];var g=[],c,d=A(this[b.ext.iApiIndex]);if(typeof a[0]==="object"&&a[0]!==null)for(var j=0;j<a.length;j++){c=s(d,a[j]);if(c==-1)return g;g.push(c)}else{c=s(d,a);if(c==-1)return g;
g.push(c)}d.aiDisplay=d.aiDisplayMaster.slice();(e===h||e)&&ba(d);return g};this.fnAdjustColumnSizing=function(a){var e=A(this[b.ext.iApiIndex]);g(e);a===h||a?this.fnDraw(!1):(e.oScroll.sX!==""||e.oScroll.sY!=="")&&this.oApi._fnScrollDraw(e)};this.fnClearTable=function(a){var e=A(this[b.ext.iApiIndex]);O(e);(a===h||a)&&D(e)};this.fnClose=function(a){for(var e=A(this[b.ext.iApiIndex]),g=0;g<e.aoOpenRows.length;g++)if(e.aoOpenRows[g].nParent==a)return(a=e.aoOpenRows[g].nTr.parentNode)&&a.removeChild(e.aoOpenRows[g].nTr),
e.aoOpenRows.splice(g,1),0;return 1};this.fnDeleteRow=function(a,e,g){var c=A(this[b.ext.iApiIndex]),d,j,a=typeof a==="object"?v(c,a):a,f=c.aoData.splice(a,1);d=0;for(j=c.aoData.length;d<j;d++)if(c.aoData[d].nTr!==null)c.aoData[d].nTr._DT_RowIndex=d;d=i.inArray(a,c.aiDisplay);c.asDataSearch.splice(d,1);R(c.aiDisplayMaster,a);R(c.aiDisplay,a);typeof e==="function"&&e.call(this,c,f);if(c._iDisplayStart>=c.fnRecordsDisplay()&&(c._iDisplayStart-=c._iDisplayLength,c._iDisplayStart<0))c._iDisplayStart=
0;if(g===h||g)F(c),D(c);return f};this.fnDestroy=function(a){var e=A(this[b.ext.iApiIndex]),g=e.nTableWrapper.parentNode,c=e.nTBody,j,f,a=a===h?!1:a;e.bDestroying=!0;I(e,"aoDestroyCallback","destroy",[e]);if(!a){j=0;for(f=e.aoColumns.length;j<f;j++)e.aoColumns[j].bVisible===!1&&this.fnSetColumnVis(j,!0)}i(e.nTableWrapper).find("*").andSelf().unbind(".DT");i("tbody>tr>td."+e.oClasses.sRowEmpty,e.nTable).parent().remove();e.nTable!=e.nTHead.parentNode&&(i(e.nTable).children("thead").remove(),e.nTable.appendChild(e.nTHead));
e.nTFoot&&e.nTable!=e.nTFoot.parentNode&&(i(e.nTable).children("tfoot").remove(),e.nTable.appendChild(e.nTFoot));e.nTable.parentNode.removeChild(e.nTable);i(e.nTableWrapper).remove();e.aaSorting=[];e.aaSortingFixed=[];V(e);i(W(e)).removeClass(e.asStripeClasses.join(" "));i("th, td",e.nTHead).removeClass([e.oClasses.sSortable,e.oClasses.sSortableAsc,e.oClasses.sSortableDesc,e.oClasses.sSortableNone].join(" "));e.bJUI&&(i("th span."+e.oClasses.sSortIcon+", td span."+e.oClasses.sSortIcon,e.nTHead).remove(),
i("th, td",e.nTHead).each(function(){var a=i("div."+e.oClasses.sSortJUIWrapper,this),b=a.contents();i(this).append(b);a.remove()}));!a&&e.nTableReinsertBefore?g.insertBefore(e.nTable,e.nTableReinsertBefore):a||g.appendChild(e.nTable);j=0;for(f=e.aoData.length;j<f;j++)e.aoData[j].nTr!==null&&c.appendChild(e.aoData[j].nTr);if(e.oFeatures.bAutoWidth===!0)e.nTable.style.width=u(e.sDestroyWidth);if(f=e.asDestroyStripes.length){a=i(c).children("tr");for(j=0;j<f;j++)a.filter(":nth-child("+f+"n + "+j+")").addClass(e.asDestroyStripes[j])}j=
0;for(f=b.settings.length;j<f;j++)b.settings[j]==e&&b.settings.splice(j,1);d=e=null};this.fnDraw=function(a){var e=A(this[b.ext.iApiIndex]);a===!1?(F(e),D(e)):ba(e)};this.fnFilter=function(a,e,g,c,d,j){var m=A(this[b.ext.iApiIndex]);if(m.oFeatures.bFilter){if(g===h||g===null)g=!1;if(c===h||c===null)c=!0;if(d===h||d===null)d=!0;if(j===h||j===null)j=!0;if(e===h||e===null){if(S(m,{sSearch:a+"",bRegex:g,bSmart:c,bCaseInsensitive:j},1),d&&m.aanFeatures.f){e=m.aanFeatures.f;g=0;for(c=e.length;g<c;g++)try{e[g]._DT_Input!=
f.activeElement&&i(e[g]._DT_Input).val(a)}catch(q){i(e[g]._DT_Input).val(a)}}}else i.extend(m.aoPreSearchCols[e],{sSearch:a+"",bRegex:g,bSmart:c,bCaseInsensitive:j}),S(m,m.oPreviousSearch,1)}};this.fnGetData=function(a,e){var g=A(this[b.ext.iApiIndex]);if(a!==h){var c=a;if(typeof a==="object"){var d=a.nodeName.toLowerCase();d==="tr"?c=v(g,a):d==="td"&&(c=v(g,a.parentNode),e=E(g,c,a))}if(e!==h)return w(g,c,e,"");return g.aoData[c]!==h?g.aoData[c]._aData:null}return B(g)};this.fnGetNodes=function(a){var e=
A(this[b.ext.iApiIndex]);if(a!==h)return e.aoData[a]!==h?e.aoData[a].nTr:null;return W(e)};this.fnGetPosition=function(a){var e=A(this[b.ext.iApiIndex]),g=a.nodeName.toUpperCase();if(g=="TR")return v(e,a);else if(g=="TD"||g=="TH")return g=v(e,a.parentNode),a=E(e,g,a),[g,m(e,a),a];return null};this.fnIsOpen=function(a){for(var e=A(this[b.ext.iApiIndex]),g=0;g<e.aoOpenRows.length;g++)if(e.aoOpenRows[g].nParent==a)return!0;return!1};this.fnOpen=function(a,e,g){var c=A(this[b.ext.iApiIndex]),d=W(c);if(i.inArray(a,
d)!==-1){this.fnClose(a);var d=f.createElement("tr"),j=f.createElement("td");d.appendChild(j);j.className=g;j.colSpan=q(c);typeof e==="string"?j.innerHTML=e:i(j).html(e);e=i("tr",c.nTBody);i.inArray(a,e)!=-1&&i(d).insertAfter(a);c.aoOpenRows.push({nTr:d,nParent:a});return d}};this.fnPageChange=function(a,e){var g=A(this[b.ext.iApiIndex]);oa(g,a);F(g);(e===h||e)&&D(g)};this.fnSetColumnVis=function(a,e,c){var d=A(this[b.ext.iApiIndex]),j,f,i=d.aoColumns,m=d.aoData,n,k;if(i[a].bVisible!=e){if(e){for(j=
f=0;j<a;j++)i[j].bVisible&&f++;k=f>=q(d);if(!k)for(j=a;j<i.length;j++)if(i[j].bVisible){n=j;break}j=0;for(f=m.length;j<f;j++)m[j].nTr!==null&&(k?m[j].nTr.appendChild(m[j]._anHidden[a]):m[j].nTr.insertBefore(m[j]._anHidden[a],Q(d,j)[n]))}else{j=0;for(f=m.length;j<f;j++)m[j].nTr!==null&&(n=Q(d,j)[a],m[j]._anHidden[a]=n,n.parentNode.removeChild(n))}i[a].bVisible=e;Z(d,d.aoHeader);d.nTFoot&&Z(d,d.aoFooter);j=0;for(f=d.aoOpenRows.length;j<f;j++)d.aoOpenRows[j].nTr.colSpan=q(d);if(c===h||c)g(d),D(d);pa(d)}};
this.fnSettings=function(){return A(this[b.ext.iApiIndex])};this.fnSort=function(a){var e=A(this[b.ext.iApiIndex]);e.aaSorting=a;U(e)};this.fnSortListener=function(a,e,g){ga(A(this[b.ext.iApiIndex]),a,e,g)};this.fnUpdate=function(a,e,c,d,j){var f=A(this[b.ext.iApiIndex]),e=typeof e==="object"?v(f,e):e;if(i.isArray(a)&&c===h){f.aoData[e]._aData=a.slice();for(c=0;c<f.aoColumns.length;c++)this.fnUpdate(w(f,e,c),e,c,!1,!1)}else if(i.isPlainObject(a)&&c===h){f.aoData[e]._aData=i.extend(!0,{},a);for(c=
0;c<f.aoColumns.length;c++)this.fnUpdate(w(f,e,c),e,c,!1,!1)}else{H(f,e,c,a);var a=w(f,e,c,"display"),m=f.aoColumns[c];m.fnRender!==null&&(a=M(f,e,c),m.bUseRendered&&H(f,e,c,a));if(f.aoData[e].nTr!==null)Q(f,e)[c].innerHTML=a}c=i.inArray(e,f.aiDisplay);f.asDataSearch[c]=la(f,y(f,e,"filter",k(f,"bSearchable")));(j===h||j)&&g(f);(d===h||d)&&ba(f);return 0};this.fnVersionCheck=b.ext.fnVersionCheck;this.oApi={_fnExternApiFunc:Ra,_fnInitialise:ca,_fnInitComplete:aa,_fnLanguageCompat:na,_fnAddColumn:a,
_fnColumnOptions:e,_fnAddData:s,_fnCreateTr:fa,_fnGatherData:z,_fnBuildHead:ra,_fnDrawHead:Z,_fnDraw:D,_fnReDraw:ba,_fnAjaxUpdate:sa,_fnAjaxParameters:Aa,_fnAjaxUpdateDraw:Ba,_fnServerParams:ia,_fnAddOptionsHtml:ta,_fnFeatureHtmlTable:xa,_fnScrollDraw:Ha,_fnAdjustColumnSizing:g,_fnFeatureHtmlFilter:va,_fnFilterComplete:S,_fnFilterCustom:Ea,_fnFilterColumn:Da,_fnFilter:Ca,_fnBuildSearchArray:ja,_fnBuildSearchRow:la,_fnFilterCreateSearch:ka,_fnDataToSearch:Fa,_fnSort:U,_fnSortAttachListener:ga,_fnSortingClasses:V,
_fnFeatureHtmlPaginate:za,_fnPageChange:oa,_fnFeatureHtmlInfo:ya,_fnUpdateInfo:Ga,_fnFeatureHtmlLength:ua,_fnFeatureHtmlProcessing:wa,_fnProcessingDisplay:N,_fnVisibleToColumnIndex:j,_fnColumnIndexToVisible:m,_fnNodeToDataIndex:v,_fnVisbleColumns:q,_fnCalculateEnd:F,_fnConvertToWidth:Ia,_fnCalculateColumnWidths:ea,_fnScrollingWidthAdjust:Ka,_fnGetWidestNode:Ja,_fnGetMaxLenString:La,_fnStringToCss:u,_fnDetectType:p,_fnSettingsFromNode:A,_fnGetDataMaster:B,_fnGetTrNodes:W,_fnGetTdNodes:Q,_fnEscapeRegex:ma,
_fnDeleteIndex:R,_fnReOrderIndex:o,_fnColumnOrdering:n,_fnLog:K,_fnClearTable:O,_fnSaveState:pa,_fnLoadState:Oa,_fnCreateCookie:function(a,b,e,g,d){var j=new Date;j.setTime(j.getTime()+e*1E3);var e=c.location.pathname.split("/"),a=a+"_"+e.pop().replace(/[\/:]/g,"").toLowerCase(),h;d!==null?(h=typeof i.parseJSON==="function"?i.parseJSON(b):eval("("+b+")"),b=d(a,h,j.toGMTString(),e.join("/")+"/")):b=a+"="+encodeURIComponent(b)+"; expires="+j.toGMTString()+"; path="+e.join("/")+"/";a=f.cookie.split(";");
d=b.split(";")[0].length;j=[];if(d+f.cookie.length+10>4096){for(var m=0,q=a.length;m<q;m++)if(a[m].indexOf(g)!=-1){var n=a[m].split("=");try{(h=eval("("+decodeURIComponent(n[1])+")"))&&h.iCreate&&j.push({name:n[0],time:h.iCreate})}catch(k){}}for(j.sort(function(a,b){return b.time-a.time});d+f.cookie.length+10>4096;){if(j.length===0)return;g=j.pop();f.cookie=g.name+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+e.join("/")+"/"}}f.cookie=b},_fnReadCookie:function(a){for(var b=c.location.pathname.split("/"),
a=a+"_"+b[b.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",b=f.cookie.split(";"),e=0;e<b.length;e++){for(var g=b[e];g.charAt(0)==" ";)g=g.substring(1,g.length);if(g.indexOf(a)===0)return decodeURIComponent(g.substring(a.length,g.length))}return null},_fnDetectHeader:Y,_fnGetUniqueThs:T,_fnScrollBarWidth:Ma,_fnApplyToChildren:J,_fnMap:t,_fnGetRowData:y,_fnGetCellData:w,_fnSetCellData:H,_fnGetObjectDataFn:C,_fnSetObjectDataFn:P,_fnApplyColumnDefs:r,_fnBindAction:Na,_fnExtend:Pa,_fnCallbackReg:G,_fnCallbackFire:I,
_fnJsonString:Sa,_fnRender:M,_fnNodeToColumnIndex:E,_fnInfoMacros:ha,_fnBrowserDetect:Qa,_fnGetColumns:k};i.extend(b.ext.oApi,this.oApi);for(var qa in b.ext.oApi)qa&&(this[qa]=Ra(qa));var da=this;this.each(function(){var g=0,c,j,m;j=this.getAttribute("id");var q=!1,n=!1;if(this.nodeName.toLowerCase()!="table")K(null,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);else{g=0;for(c=b.settings.length;g<c;g++){if(b.settings[g].nTable==this)if(d===h||d.bRetrieve)return b.settings[g].oInstance;
else if(d.bDestroy){b.settings[g].oInstance.fnDestroy();break}else{K(b.settings[g],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, pass no arguments or see the docs for bRetrieve and bDestroy");return}if(b.settings[g].sTableId==this.id){b.settings.splice(g,1);break}}if(j===null||j==="")this.id=j="DataTables_Table_"+b.ext._oExternConfig.iNextUnique++;var k=i.extend(!0,{},b.models.oSettings,{nTable:this,oApi:da.oApi,oInit:d,sDestroyWidth:i(this).width(),sInstance:j,
sTableId:j});b.settings.push(k);k.oInstance=da.length===1?da:i(this).dataTable();d||(d={});d.oLanguage&&na(d.oLanguage);d=Pa(i.extend(!0,{},b.defaults),d);t(k.oFeatures,d,"bPaginate");t(k.oFeatures,d,"bLengthChange");t(k.oFeatures,d,"bFilter");t(k.oFeatures,d,"bSort");t(k.oFeatures,d,"bInfo");t(k.oFeatures,d,"bProcessing");t(k.oFeatures,d,"bAutoWidth");t(k.oFeatures,d,"bSortClasses");t(k.oFeatures,d,"bServerSide");t(k.oFeatures,d,"bDeferRender");t(k.oScroll,d,"sScrollX","sX");t(k.oScroll,d,"sScrollXInner",
"sXInner");t(k.oScroll,d,"sScrollY","sY");t(k.oScroll,d,"bScrollCollapse","bCollapse");t(k.oScroll,d,"bScrollInfinite","bInfinite");t(k.oScroll,d,"iScrollLoadGap","iLoadGap");t(k.oScroll,d,"bScrollAutoCss","bAutoCss");t(k,d,"asStripeClasses");t(k,d,"asStripClasses","asStripeClasses");t(k,d,"fnServerData");t(k,d,"fnFormatNumber");t(k,d,"sServerMethod");t(k,d,"aaSorting");t(k,d,"aaSortingFixed");t(k,d,"aLengthMenu");t(k,d,"sPaginationType");t(k,d,"sAjaxSource");t(k,d,"sAjaxDataProp");t(k,d,"iCookieDuration");
t(k,d,"sCookiePrefix");t(k,d,"sDom");t(k,d,"bSortCellsTop");t(k,d,"iTabIndex");t(k,d,"oSearch","oPreviousSearch");t(k,d,"aoSearchCols","aoPreSearchCols");t(k,d,"iDisplayLength","_iDisplayLength");t(k,d,"bJQueryUI","bJUI");t(k,d,"fnCookieCallback");t(k,d,"fnStateLoad");t(k,d,"fnStateSave");t(k.oLanguage,d,"fnInfoCallback");G(k,"aoDrawCallback",d.fnDrawCallback,"user");G(k,"aoServerParams",d.fnServerParams,"user");G(k,"aoStateSaveParams",d.fnStateSaveParams,"user");G(k,"aoStateLoadParams",d.fnStateLoadParams,
"user");G(k,"aoStateLoaded",d.fnStateLoaded,"user");G(k,"aoRowCallback",d.fnRowCallback,"user");G(k,"aoRowCreatedCallback",d.fnCreatedRow,"user");G(k,"aoHeaderCallback",d.fnHeaderCallback,"user");G(k,"aoFooterCallback",d.fnFooterCallback,"user");G(k,"aoInitComplete",d.fnInitComplete,"user");G(k,"aoPreDrawCallback",d.fnPreDrawCallback,"user");k.oFeatures.bServerSide&&k.oFeatures.bSort&&k.oFeatures.bSortClasses?G(k,"aoDrawCallback",V,"server_side_sort_classes"):k.oFeatures.bDeferRender&&G(k,"aoDrawCallback",
V,"defer_sort_classes");if(d.bJQueryUI){if(i.extend(k.oClasses,b.ext.oJUIClasses),d.sDom===b.defaults.sDom&&b.defaults.sDom==="lfrtip")k.sDom='<"H"lfr>t<"F"ip>'}else i.extend(k.oClasses,b.ext.oStdClasses);i(this).addClass(k.oClasses.sTable);if(k.oScroll.sX!==""||k.oScroll.sY!=="")k.oScroll.iBarWidth=Ma();if(k.iInitDisplayStart===h)k.iInitDisplayStart=d.iDisplayStart,k._iDisplayStart=d.iDisplayStart;if(d.bStateSave)k.oFeatures.bStateSave=!0,Oa(k,d),G(k,"aoDrawCallback",pa,"state_save");if(d.iDeferLoading!==
null)k.bDeferLoading=!0,g=i.isArray(d.iDeferLoading),k._iRecordsDisplay=g?d.iDeferLoading[0]:d.iDeferLoading,k._iRecordsTotal=g?d.iDeferLoading[1]:d.iDeferLoading;d.aaData!==null&&(n=!0);d.oLanguage.sUrl!==""?(k.oLanguage.sUrl=d.oLanguage.sUrl,i.getJSON(k.oLanguage.sUrl,null,function(a){na(a);i.extend(!0,k.oLanguage,d.oLanguage,a);ca(k)}),q=!0):i.extend(!0,k.oLanguage,d.oLanguage);if(d.asStripeClasses===null)k.asStripeClasses=[k.oClasses.sStripeOdd,k.oClasses.sStripeEven];c=k.asStripeClasses.length;
k.asDestroyStripes=[];if(c){j=!1;m=i(this).children("tbody").children("tr:lt("+c+")");for(g=0;g<c;g++)m.hasClass(k.asStripeClasses[g])&&(j=!0,k.asDestroyStripes.push(k.asStripeClasses[g]));j&&m.removeClass(k.asStripeClasses.join(" "))}j=[];g=this.getElementsByTagName("thead");g.length!==0&&(Y(k.aoHeader,g[0]),j=T(k));if(d.aoColumns===null){m=[];g=0;for(c=j.length;g<c;g++)m.push(null)}else m=d.aoColumns;g=0;for(c=m.length;g<c;g++){if(d.saved_aoColumns!==h&&d.saved_aoColumns.length==c)m[g]===null&&
(m[g]={}),m[g].bVisible=d.saved_aoColumns[g].bVisible;a(k,j?j[g]:null)}r(k,d.aoColumnDefs,m,function(a,b){e(k,a,b)});g=0;for(c=k.aaSorting.length;g<c;g++){k.aaSorting[g][0]>=k.aoColumns.length&&(k.aaSorting[g][0]=0);var p=k.aoColumns[k.aaSorting[g][0]];k.aaSorting[g][2]===h&&(k.aaSorting[g][2]=0);d.aaSorting===h&&k.saved_aaSorting===h&&(k.aaSorting[g][1]=p.asSorting[0]);j=0;for(m=p.asSorting.length;j<m;j++)if(k.aaSorting[g][1]==p.asSorting[j]){k.aaSorting[g][2]=j;break}}V(k);Qa(k);g=i(this).children("caption").each(function(){this._captionSide=
i(this).css("caption-side")});c=i(this).children("thead");c.length===0&&(c=[f.createElement("thead")],this.appendChild(c[0]));k.nTHead=c[0];c=i(this).children("tbody");c.length===0&&(c=[f.createElement("tbody")],this.appendChild(c[0]));k.nTBody=c[0];k.nTBody.setAttribute("role","alert");k.nTBody.setAttribute("aria-live","polite");k.nTBody.setAttribute("aria-relevant","all");c=i(this).children("tfoot");if(c.length===0&&g.length>0&&(k.oScroll.sX!==""||k.oScroll.sY!==""))c=[f.createElement("tfoot")],
this.appendChild(c[0]);if(c.length>0)k.nTFoot=c[0],Y(k.aoFooter,k.nTFoot);if(n)for(g=0;g<d.aaData.length;g++)s(k,d.aaData[g]);else z(k);k.aiDisplay=k.aiDisplayMaster.slice();k.bInitialised=!0;q===!1&&ca(k)}});da=null;return this};b.fnVersionCheck=function(c){for(var a=function(a,b){for(;a.length<b;)a+="0";return a},e=b.ext.sVersion.split("."),c=c.split("."),g="",j="",f=0,h=c.length;f<h;f++)g+=a(e[f],3),j+=a(c[f],3);return parseInt(g,10)>=parseInt(j,10)};b.fnIsDataTable=function(c){for(var a=b.settings,
e=0;e<a.length;e++)if(a[e].nTable===c||a[e].nScrollHead===c||a[e].nScrollFoot===c)return!0;return!1};b.fnTables=function(c){var a=[];jQuery.each(b.settings,function(b,g){(!c||c===!0&&i(g.nTable).is(":visible"))&&a.push(g.nTable)});return a};b.version="1.9.4";b.settings=[];b.models={};b.models.ext={afnFiltering:[],afnSortData:[],aoFeatures:[],aTypes:[],fnVersionCheck:b.fnVersionCheck,iApiIndex:0,ofnSearch:{},oApi:{},oStdClasses:{},oJUIClasses:{},oPagination:{},oSort:{},sVersion:b.version,sErrMode:"alert",
_oExternConfig:{iNextUnique:0}};b.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0};b.models.oRow={nTr:null,_aData:[],_aSortData:[],_anHidden:[],_sRowStripe:""};b.models.oColumn={aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bUseRendered:null,bVisible:null,_bAutoType:!0,fnCreatedCell:null,fnGetData:null,fnRender:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,
sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};b.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollAutoCss:!0,bScrollCollapse:!1,bScrollInfinite:!1,bServerSide:!1,bSort:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCookieCallback:null,
fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(b){if(b<1E3)return b;for(var a=b+"",b=a.split(""),e="",a=a.length,g=0;g<a;g++)g%3===0&&g!==0&&(e=this.oLanguage.sInfoThousands+e),e=b[a-g-1]+e;return e},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:function(b,a,e,g){g.jqXHR=i.ajax({url:b,data:a,success:function(a){a.sError&&g.oApi._fnLog(g,0,a.sError);i(g.oInstance).trigger("xhr",[g,a]);e(a)},
dataType:"json",cache:!1,type:g.sServerMethod,error:function(a,b){b=="parsererror"&&g.oApi._fnLog(g,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},fnServerParams:null,fnStateLoad:function(b){var b=this.oApi._fnReadCookie(b.sCookiePrefix+b.sInstance),a;try{a=typeof i.parseJSON==="function"?i.parseJSON(b):eval("("+b+")")}catch(e){a=null}return a},fnStateLoadParams:null,fnStateLoaded:null,fnStateSave:function(b,a){this.oApi._fnCreateCookie(b.sCookiePrefix+
b.sInstance,this.oApi._fnJsonString(a),b.iCookieDuration,b.sCookiePrefix,b.fnCookieCallback)},fnStateSaveParams:null,iCookieDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iScrollLoadGap:100,iTabIndex:0,oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",
sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oSearch:i.extend({},b.models.oSearch),sAjaxDataProp:"aaData",sAjaxSource:null,sCookiePrefix:"SpryMedia_DataTables_",sDom:"lfrtip",sPaginationType:"two_button",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET"};
b.defaults.columns={aDataSort:null,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bUseRendered:!0,bVisible:!0,fnCreatedCell:null,fnRender:null,iDataSort:-1,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};b.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortClasses:null,
bStateSave:null},oScroll:{bAutoCss:null,bCollapse:null,bInfinite:null,iBarWidth:0,iLoadGap:null,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1},aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],asDataSearch:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:null,asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],
aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iCookieDuration:0,sCookiePrefix:"",fnCookieCallback:null,aoStateSave:[],aoStateLoad:[],oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,fnServerData:null,aoServerParams:[],sServerMethod:null,
fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iDisplayEnd:10,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length},fnRecordsDisplay:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length},fnDisplayEnd:function(){return this.oFeatures.bServerSide?
this.oFeatures.bPaginate===!1||this._iDisplayLength==-1?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null};b.ext=i.extend(!0,{},b.models.ext);i.extend(b.ext.oStdClasses,{sTable:"dataTable",sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",
sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",
sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",
sFooterTH:"",sJUIHeader:"",sJUIFooter:""});i.extend(b.ext.oJUIClasses,b.ext.oStdClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",
sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPageLast:"last ui-corner-tr ui-corner-br",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",
sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollFoot:"dataTables_scrollFoot ui-state-default",
sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"});i.extend(b.ext.oPagination,{two_button:{fnInit:function(b,a,e){var g=b.oLanguage.oPaginate,c=function(a){b.oApi._fnPageChange(b,a.data.action)&&e(b)},g=!b.bJUI?'<a class="'+b.oClasses.sPagePrevDisabled+'" tabindex="'+b.iTabIndex+'" role="button">'+g.sPrevious+'</a><a class="'+
b.oClasses.sPageNextDisabled+'" tabindex="'+b.iTabIndex+'" role="button">'+g.sNext+"</a>":'<a class="'+b.oClasses.sPagePrevDisabled+'" tabindex="'+b.iTabIndex+'" role="button"><span class="'+b.oClasses.sPageJUIPrev+'"></span></a><a class="'+b.oClasses.sPageNextDisabled+'" tabindex="'+b.iTabIndex+'" role="button"><span class="'+b.oClasses.sPageJUINext+'"></span></a>';i(a).append(g);var f=i("a",a),g=f[0],f=f[1];b.oApi._fnBindAction(g,{action:"previous"},c);b.oApi._fnBindAction(f,{action:"next"},c);
if(!b.aanFeatures.p)a.id=b.sTableId+"_paginate",g.id=b.sTableId+"_previous",f.id=b.sTableId+"_next",g.setAttribute("aria-controls",b.sTableId),f.setAttribute("aria-controls",b.sTableId)},fnUpdate:function(b){if(b.aanFeatures.p)for(var a=b.oClasses,e=b.aanFeatures.p,g,c=0,f=e.length;c<f;c++)if(g=e[c].firstChild)g.className=b._iDisplayStart===0?a.sPagePrevDisabled:a.sPagePrevEnabled,g=g.nextSibling,g.className=b.fnDisplayEnd()==b.fnRecordsDisplay()?a.sPageNextDisabled:a.sPageNextEnabled}},iFullNumbersShowPages:5,
full_numbers:{fnInit:function(b,a,e){var g=b.oLanguage.oPaginate,c=b.oClasses,f=function(a){b.oApi._fnPageChange(b,a.data.action)&&e(b)};i(a).append('<a  tabindex="'+b.iTabIndex+'" class="'+c.sPageButton+" "+c.sPageFirst+'">'+g.sFirst+'</a><a  tabindex="'+b.iTabIndex+'" class="'+c.sPageButton+" "+c.sPagePrevious+'">'+g.sPrevious+'</a><span></span><a tabindex="'+b.iTabIndex+'" class="'+c.sPageButton+" "+c.sPageNext+'">'+g.sNext+'</a><a tabindex="'+b.iTabIndex+'" class="'+c.sPageButton+" "+c.sPageLast+
'">'+g.sLast+"</a>");var h=i("a",a),g=h[0],c=h[1],k=h[2],h=h[3];b.oApi._fnBindAction(g,{action:"first"},f);b.oApi._fnBindAction(c,{action:"previous"},f);b.oApi._fnBindAction(k,{action:"next"},f);b.oApi._fnBindAction(h,{action:"last"},f);if(!b.aanFeatures.p)a.id=b.sTableId+"_paginate",g.id=b.sTableId+"_first",c.id=b.sTableId+"_previous",k.id=b.sTableId+"_next",h.id=b.sTableId+"_last"},fnUpdate:function(c,a){if(c.aanFeatures.p){var e=b.ext.oPagination.iFullNumbersShowPages,g=Math.floor(e/2),j=Math.ceil(c.fnRecordsDisplay()/
c._iDisplayLength),f=Math.ceil(c._iDisplayStart/c._iDisplayLength)+1,h="",k,p=c.oClasses,o,n=c.aanFeatures.p,r=function(b){c.oApi._fnBindAction(this,{page:b+k-1},function(b){c.oApi._fnPageChange(c,b.data.page);a(c);b.preventDefault()})};c._iDisplayLength===-1?f=g=k=1:j<e?(k=1,g=j):f<=g?(k=1,g=e):f>=j-g?(k=j-e+1,g=j):(k=f-Math.ceil(e/2)+1,g=k+e-1);for(e=k;e<=g;e++)h+=f!==e?'<a tabindex="'+c.iTabIndex+'" class="'+p.sPageButton+'">'+c.fnFormatNumber(e)+"</a>":'<a tabindex="'+c.iTabIndex+'" class="'+
p.sPageButtonActive+'">'+c.fnFormatNumber(e)+"</a>";e=0;for(g=n.length;e<g;e++)o=n[e],o.hasChildNodes()&&(i("span:eq(0)",o).html(h).children("a").each(r),o=o.getElementsByTagName("a"),o=[o[0],o[1],o[o.length-2],o[o.length-1]],i(o).removeClass(p.sPageButton+" "+p.sPageButtonActive+" "+p.sPageButtonStaticDisabled),i([o[0],o[1]]).addClass(f==1?p.sPageButtonStaticDisabled:p.sPageButton),i([o[2],o[3]]).addClass(j===0||f===j||c._iDisplayLength===-1?p.sPageButtonStaticDisabled:p.sPageButton))}}}});i.extend(b.ext.oSort,
{"string-pre":function(b){typeof b!="string"&&(b=b!==null&&b.toString?b.toString():"");return b.toLowerCase()},"string-asc":function(b,a){return b<a?-1:b>a?1:0},"string-desc":function(b,a){return b<a?1:b>a?-1:0},"html-pre":function(b){return b.replace(/<.*?>/g,"").toLowerCase()},"html-asc":function(b,a){return b<a?-1:b>a?1:0},"html-desc":function(b,a){return b<a?1:b>a?-1:0},"date-pre":function(b){b=Date.parse(b);if(isNaN(b)||b==="")b=Date.parse("01/01/1970 00:00:00");return b},"date-asc":function(b,
a){return b-a},"date-desc":function(b,a){return a-b},"numeric-pre":function(b){return b=="-"||b===""?0:b*1},"numeric-asc":function(b,a){return b-a},"numeric-desc":function(b,a){return a-b}});i.extend(b.ext.aTypes,[function(b){if(typeof b==="number")return"numeric";else if(typeof b!=="string")return null;var a,e=!1;a=b.charAt(0);if("0123456789-".indexOf(a)==-1)return null;for(var g=1;g<b.length;g++){a=b.charAt(g);if("0123456789.".indexOf(a)==-1)return null;if(a=="."){if(e)return null;e=!0}}return"numeric"},
function(b){var a=Date.parse(b);if(a!==null&&!isNaN(a)||typeof b==="string"&&b.length===0)return"date";return null},function(b){if(typeof b==="string"&&b.indexOf("<")!=-1&&b.indexOf(">")!=-1)return"html";return null}]);i.fn.DataTable=b;i.fn.dataTable=b;i.fn.dataTableSettings=b.settings;i.fn.dataTableExt=b.ext})})(window,document);jQuery.fn.dataTableExt.oApi.fnSetFilteringDelay=function(c,f){var h=this,f=typeof f=="undefined"?400:f;this.each(function(c){$.fn.dataTableExt.iApiIndex=c;var b=null,d=null,a=$("#"+h.fnSettings().sTableId+"_search");a.unbind("keyup").bind("keyup",function(){if(d===null||d!=a.val())window.clearTimeout(b),d=a.val(),b=window.setTimeout(function(){$.fn.dataTableExt.iApiIndex=c;var b=$("#"+h.fnSettings().sTableId+"_search_checkbox"),g=a.val();b.length&&b.attr("checked")==="checked"&&(g="~"+g);h.fnFilter(g)},
f)});return this});return this};jQuery.fn.highlight=function(c){function f(c,i){var b=0;if(c.nodeType==3){var d=c.data.toUpperCase().indexOf(i);if(d>=0){b=document.createElement("span");d=c.splitText(d);d.splitText(i.length);var a=d.cloneNode(!0);b.appendChild(a);d.parentNode.replaceChild(b,d);b=1}}else if(c.nodeType==1&&c.childNodes&&!/(script|style)/i.test(c.tagName))for(d=0;d<c.childNodes.length;++d)d+=f(c.childNodes[d],i);return b}return this.each(function(){f(this,c.toUpperCase())})};
jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){with(this.parentNode)replaceChild(this.firstChild,this),normalize()}).end()};jQuery.fn.dataTableExt.oApi.fnReloadAjax=function(c){this.fnClearTable(this);this.oApi._fnProcessingDisplay(c,!0)};
$.fn.dataTableExt.oPagination.input={fnInit:function(c,f,h){var i=document.createElement("span");i.className="paginate_button_first";var b=document.createElement("span");b.className="paginate_button_previous";var d=document.createElement("span");d.className="paginate_button_next";var a=document.createElement("input");a.className="paginate_input";var e=document.createElement("span");e.className="paginate_of";var g=document.createElement("span");g.className="paginate_page";var j=document.createElement("span");
j.className="paginate_button_last";c.sTableId!==""&&(f.setAttribute("id",c.sTableId+"_paginate"),i.setAttribute("id",c.sTableId+"_first"),b.setAttribute("id",c.sTableId+"_previous"),d.setAttribute("id",c.sTableId+"_next"),g.setAttribute("id",c.sTableId+"_paginate_page"),j.setAttribute("id",c.sTableId+"_last"));f.appendChild(i);f.appendChild(b);f.appendChild(g);f.appendChild(a);f.appendChild(e);f.appendChild(d);f.appendChild(j);$(i).click(function(){c._iDisplayStart>0&&(c.oApi._fnPageChange(c,"first"),
h(c))});$(j).click(function(){c._iDisplayStart+c._iDisplayLength<c.fnRecordsDisplay()&&(c.oApi._fnPageChange(c,"last"),h(c))});$(b).click(function(){c._iDisplayStart>0&&(c.oApi._fnPageChange(c,"previous"),h(c))});$(d).click(function(){c._iDisplayStart+c._iDisplayLength<c.fnRecordsDisplay()&&(c.oApi._fnPageChange(c,"next"),h(c))});$(a).keydown(function(a){a.which==38||a.which==39?this.value++:(a.which==37||a.which==40)&&this.value>1&&this.value--});var m=null;$(f).on("keyup","input.paginate_input",
function(){m&&window.clearTimeout(m);m=window.setTimeout(function(a){if(!(a.value==""||a.value.match(/[^0-9]/)))if(a=c._iDisplayLength*(a.value-1),!(a>=c.fnRecordsDisplay())&&!(a<0))c._iDisplayStart=a,h(c)},300,this)});$("span",f).bind("mousedown",function(){return!1});$("span",f).bind("selectstart",function(){return!1})},fnUpdate:function(c){if(c.aanFeatures.p)for(var f=Math.ceil(c.fnRecordsDisplay()/c._iDisplayLength),h=Math.ceil(c._iDisplayStart/c._iDisplayLength)+1,c=c.aanFeatures.p,i=0,b=c.length;i<
b;i++){var d=c[i].getElementsByTagName("span"),a=c[i].getElementsByTagName("input");d[3].innerHTML=gettext(" of ")+f;a[0].value=h}}};$.fn.dataTableExt.oApi.fnLengthChange=function(c,f){c._iDisplayLength=f;c.oApi._fnCalculateEnd(c);if(c._iDisplayEnd==c.aiDisplay.length&&(c._iDisplayStart=c._iDisplayEnd-c._iDisplayLength,c._iDisplayStart<0))c._iDisplayStart=0;if(c._iDisplayLength==-1)c._iDisplayStart=0;c.oApi._fnDraw(c);$("select",c.oFeatures.l).val(f)};
$.fn.dataTableExt.oApi.fnResetAllFilters=function(c,f){for(iCol=0;iCol<c.aoPreSearchCols.length;iCol++)c.aoPreSearchCols[iCol].sSearch="";c.oPreviousSearch.sSearch="";typeof f==="undefined"&&(f=!0);f&&this.fnDraw()};function create_datatable(c,f){"ds"in window||(window.ds={});"widgets"in ds||(ds.widgets={});"tables"in ds.widgets||(ds.widgets.tables={});f.requestCallbacks=[];f.responseCallbacks=[];for(var h=0;h<f.filters.length;h++){var i=$("#"+c+"_filter_"+f.filters[h]),b=i.attr("data-col");$.isNumeric(b)||f.requestCallbacks.push([function(a){if($(this).attr("data-filtertype")=="tagfilter"){var b=[];$(this).find("a.selected").each(function(){var a=$(this).attr("id");b.push(a.split("_")[1])});var g=b.join(",");
a.push({name:"filter_"+$(this).attr("data-filtername"),value:g})}else if($(this).attr("data-filtertype")=="daterange")g=$(this).attr("data-filtervalue"),a.push({name:"filter_"+$(this).attr("data-filtername"),value:g});else if($(this).attr("data-filtertype")=="range"){var g=parseInt(i.attr("data-filtervalue_min")),c=parseInt(i.attr("data-filtervalue_max")),d=i.find(".slider-range").slider("values"),f=d[0]+";"+d[1];d[0]==g&&d[1]==c&&(f="");a.push({name:"filter_"+$(this).attr("data-filtername"),value:f})}else $(this).attr("data-filtertype")==
"checkbox"?(g=$(this).attr("checked"),g=g=="checked"?"1":"0",a.push({name:"filter_"+$(this).attr("data-filtername"),value:g})):a.push({name:"filter_"+$(this).attr("data-filtername"),value:this.value})},i[0]])}f.fnServerData=function(a,b,g,d){b.push({name:"table",value:c});for(var f=0;f<d.oInit.requestCallbacks.length;f++)$.isArray(d.oInit.requestCallbacks[f])?d.oInit.requestCallbacks[f][0].call(d.oInit.requestCallbacks[f][1],b):d.oInit.requestCallbacks[f].call(this,b);d.jqXHR=$.ajax({url:a,data:b,
success:function(a){"success"in a&&!a.success&&d.oApi._fnLog(d,0,a.message);$(d.oInstance).trigger("xhr",[d,a]);g(a);for(var c=0;c<d.oInit.responseCallbacks.length;c++)$.isArray(d.oInit.responseCallbacks[c])?d.oInit.responseCallbacks[c][0].call(d.oInit.responseCallbacks[c][1],b,a):d.oInit.responseCallbacks[c].call(this,b,a)},dataType:"json",cache:!1,type:d.sServerMethod,error:function(a,b){b=="parsererror"&&d.oApi._fnLog(d,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})};
f.fnCreatedRow=function(a){$(".tooltip-bs",a).tooltip();$(".tooltip-bs-html",a).tooltip({html:!0})};f.fnInitComplete=function(a){if("l"in a.aanFeatures)for(var b=0;b<a.aanFeatures.l.length;b++);};var d=$("#"+c).dataTable(f);f.bFilter&&d.fnSetFilteringDelay();$(".dataTables_processing, .ajax_processing").each(function(){var a=$(this).height()/2,b=$(this).width()/2;$(this).css("margin-left","-"+b+"px").css("margin-top","-"+a+"px")});$(".dataTables_length > label > select").chosen();for(h=0;h<f.filters.length;h++)i=
$("#"+c+"_filter_"+f.filters[h]),filterinit(d,i);(f.filters.length||f.bFilter)&&$("#"+c+"_filter_reset").click(function(){if(f.bFilter){var a=$("#"+c+"_search");a.val("");a.removeClass("datatable_filter_active")}for(a=0;a<f.filters.length;a++){var b=$("#"+c+"_filter_"+f.filters[a]);if(b.is("select.chzn-select"))b.val(""),b.trigger("liszt:updated"),b.parent().removeClass("datatable_filter_active");else if(b.is("input.default"))b.val("");else if(b.is("span.daterange"))b.attr("data-filtervalue",""),
b.html(gettext("Select date range"));else if(b.is("div.range")){var g=b.find(".slider-range"),j=b.attr("data-unit"),h=parseInt(b.attr("data-filtervalue_min")),i=parseInt(b.attr("data-filtervalue_max"));g.slider("values",[h,i]);b.find(".amount").html(g.slider("values",0)+j+" - "+g.slider("values",1)+j)}else b.is("div")?b.find("a.selected").each(function(){$(this).removeClass("selected")}):b.is("input:checkbox")&&b.attr("checked",!1)}d.fnResetAllFilters()});d.addRequestCallback=function(a,b){var g=
this.fnSettings();b?g.oInit.requestCallbacks.push([a,b]):g.oInit.requestCallbacks.push(a)};d.addResponseCallback=function(a,b){var g=this.fnSettings();b?g.oInit.responseCallbacks.push([a,b]):g.oInit.responseCallbacks.push(a)};ds.widgets.tables[c]=d}
function filterinit(c,f){if(f.is("select.chzn-select")){try{f.chosen()}catch(h){l("chosen-js ist nicht da!",h)}f.change(function(){var a=$(this).attr("data-col");$.isNumeric(a)?c.fnFilter(this.value,Number(a),!1,!1,!1):c._fnReDraw()})}else if(f.is("input.default"))f.keyup(function(){var a=$(this).attr("data-col");$.isNumeric(a)?c.fnFilter(this.value,Number(a),!1,!1,!1):c._fnReDraw()});else if(f.is("span.daterange")){var i=f.attr("data-filterpresets"),i={opens:"left",format:"DD/MM/YYYY",separator:" - ",
locale:{applyLabel:gettext("Submit"),fromLabel:gettext("From"),toLabel:"To",customRangeLabel:gettext("Custom Range"),daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],firstDay:1},showWeekNumbers:!0,buttonClasses:["btn-danger"],dateLimit:!1,presets:i};f.daterangepicker(i,function(a,b){var e;a==null?(this.element.html(gettext("Select date range")),this.element.attr("data-filtervalue",
""),e=""):(e=a.format("DD/MM/YYYY")+" - "+b.format("DD/MM/YYYY"),this.element.html(e),this.element.attr("data-filtervalue",e));var g=this.element.attr("data-col");$.isNumeric(g)?c.fnFilter(e,Number(g),!1,!1,!1):c._fnReDraw()})}else if(f.is("div.range")){var i=f.find(".slider-range"),b=f.find(".amount"),d=f.attr("data-unit"),a=parseInt(f.attr("data-filtervalue_min")),e=parseInt(f.attr("data-filtervalue_max")),g=a,j=e;f.attr("data-filtervalue_current_min")&&(g=parseInt(f.attr("data-filtervalue_current_min")),
j=parseInt(f.attr("data-filtervalue_current_max")));i.slider({disabled:f.attr("disabled")=="disabled",range:!0,min:a,max:e,values:[g,j],slide:function(a,e){b.html(e.values[0]+d+" - "+e.values[1]+d)},change:function(b,g){if(b.originalEvent){var d=$(this).parent().attr("data-col"),j=g.values[0]+";"+g.values[1];g.values[0]==a&&g.values[1]==e&&(j="");$.isNumeric(d)?c.fnFilter(j,Number(d),!1,!1,!1):c._fnReDraw()}}});b.html(i.slider("values",0)+d+" - "+i.slider("values",1)+d)}else if(f.is("div"))f.on("click",
"a",function(a){var b=$(this);b.hasClass("selected")?b.removeClass("selected"):b.addClass("selected");c._fnReDraw();a.preventDefault()});else f.is("input:checkbox")&&f.change(function(a){c._fnReDraw();a.preventDefault()})};(function(c,f,h){var i=c.L,b={version:"0.7.2"};typeof module==="object"&&typeof module.exports==="object"?module.exports=b:typeof define==="function"&&define.amd&&define(b);b.noConflict=function(){c.L=i;return this};c.L=b;b.Util={extend:function(a){var b=Array.prototype.slice.call(arguments,1),g,c,d,f;c=0;for(d=b.length;c<d;c++)for(g in f=b[c]||{},f)f.hasOwnProperty(g)&&(a[g]=f[g]);return a},bind:function(a,b){var g=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return a.apply(b,
g||arguments)}},stamp:function(){var a=0;return function(b){b._leaflet_id=b._leaflet_id||++a;return b._leaflet_id}}(),invokeEach:function(a,b,g){var c,d;if(typeof a==="object"){d=Array.prototype.slice.call(arguments,3);for(c in a)b.apply(g,[c,a[c]].concat(d));return!0}return!1},limitExecByInterval:function(a,b,g){var c,d;return function k(){var f=arguments;c?d=!0:(c=!0,setTimeout(function(){c=!1;d&&(k.apply(g,f),d=!1)},b),a.apply(g,f))}},falseFn:function(){return!1},formatNum:function(a,b){var g=
Math.pow(10,b||5);return Math.round(a*g)/g},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},splitWords:function(a){return b.Util.trim(a).split(/\s+/)},setOptions:function(a,e){a.options=b.extend({},a.options,e);return a.options},getParamString:function(a,b,g){var c=[],d;for(d in a)c.push(encodeURIComponent(g?d.toUpperCase():d)+"="+encodeURIComponent(a[d]));return(!b||b.indexOf("?")===-1?"?":"&")+c.join("&")},template:function(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,
c){var d=b[c];if(d===h)throw Error("No value provided for variable "+a);else typeof d==="function"&&(d=d(b));return d})},isArray:Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="};(function(){function a(a){var b,e,g=["webkit","moz","o","ms"];for(b=0;b<g.length&&!e;b++)e=c[g[b]+a];return e}function e(a){var b=+new Date,e=Math.max(0,16-(b-g));g=b+e;return c.setTimeout(a,e)}var g=0,d=c.requestAnimationFrame||
a("RequestAnimationFrame")||e,f=c.cancelAnimationFrame||a("CancelAnimationFrame")||a("CancelRequestAnimationFrame")||function(a){c.clearTimeout(a)};b.Util.requestAnimFrame=function(a,g,f,h){a=b.bind(a,g);if(f&&d===e)a();else return d.call(c,a,h)};b.Util.cancelAnimFrame=function(a){a&&f.call(c,a)}})();b.extend=b.Util.extend;b.bind=b.Util.bind;b.stamp=b.Util.stamp;b.setOptions=b.Util.setOptions;b.Class=function(){};b.Class.extend=function(a){var e=function(){this.initialize&&this.initialize.apply(this,
arguments);this._initHooks&&this.callInitHooks()},g=function(){};g.prototype=this.prototype;var c=new g;c.constructor=e;e.prototype=c;for(var d in this)this.hasOwnProperty(d)&&d!=="prototype"&&(e[d]=this[d]);a.statics&&(b.extend(e,a.statics),delete a.statics);a.includes&&(b.Util.extend.apply(null,[c].concat(a.includes)),delete a.includes);if(a.options&&c.options)a.options=b.extend({},c.options,a.options);b.extend(c,a);c._initHooks=[];var f=this;e.__super__=f.prototype;c.callInitHooks=function(){if(!this._initHooksCalled){f.prototype.callInitHooks&&
f.prototype.callInitHooks.call(this);this._initHooksCalled=!0;for(var a=0,b=c._initHooks.length;a<b;a++)c._initHooks[a].call(this)}};return e};b.Class.include=function(a){b.extend(this.prototype,a)};b.Class.mergeOptions=function(a){b.extend(this.prototype.options,a)};b.Class.addInitHook=function(a){var b=Array.prototype.slice.call(arguments,1),g;this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push(typeof a==="function"?a:function(){this[a].apply(this,b)})};b.Mixin=
{};b.Mixin.Events={addEventListener:function(a,e,g){var j;if(b.Util.invokeEach(a,this.addEventListener,this,e,g))return this;var c=this._leaflet_events=this._leaflet_events||{},d=g&&g!==this&&b.stamp(g),f,h,i,o,n,a=b.Util.splitWords(a);f=0;for(h=a.length;f<h;f++)i={action:e,context:g||this},o=a[f],d?(n=o+"_idx",o=n+"_len",j=c[n]=c[n]||{},n=j,n[d]||(n[d]=[],c[o]=(c[o]||0)+1),n[d].push(i)):(c[o]=c[o]||[],c[o].push(i));return this},hasEventListeners:function(a){var b=this._leaflet_events;return!!b&&
(a in b&&b[a].length>0||a+"_idx"in b&&b[a+"_idx_len"]>0)},removeEventListener:function(a,e,g){if(!this._leaflet_events)return this;if(!a)return this.clearAllEventListeners();if(b.Util.invokeEach(a,this.removeEventListener,this,e,g))return this;var c=this._leaflet_events,d=g&&g!==this&&b.stamp(g),f,h,i,o,n,r,s,a=b.Util.splitWords(a);f=0;for(h=a.length;f<h;f++)if(i=a[f],o=i+"_idx",n=o+"_len",r=c[o],e){if(i=d&&r?r[d]:c[i]){for(o=i.length-1;o>=0;o--)if(i[o].action===e&&(!g||i[o].context===g))s=i.splice(o,
1),s[0].action=b.Util.falseFn;g&&r&&i.length===0&&(delete r[d],c[n]--)}}else delete c[i],delete c[o],delete c[n];return this},clearAllEventListeners:function(){delete this._leaflet_events;return this},fireEvent:function(a,e){if(!this.hasEventListeners(a))return this;var g=b.Util.extend({},e,{type:a,target:this}),c=this._leaflet_events,d,f,h,i;if(c[a]){d=c[a].slice();f=0;for(h=d.length;f<h;f++)d[f].action.call(d[f].context,g)}c=c[a+"_idx"];for(i in c)if(d=c[i].slice()){f=0;for(h=d.length;f<h;f++)d[f].action.call(d[f].context,
g)}return this},addOneTimeEventListener:function(a,e,g){if(b.Util.invokeEach(a,this.addOneTimeEventListener,this,e,g))return this;var c=b.bind(function(){this.removeEventListener(a,e,g).removeEventListener(a,c,g)},this);return this.addEventListener(a,e,g).addEventListener(a,c,g)}};b.Mixin.Events.on=b.Mixin.Events.addEventListener;b.Mixin.Events.off=b.Mixin.Events.removeEventListener;b.Mixin.Events.once=b.Mixin.Events.addOneTimeEventListener;b.Mixin.Events.fire=b.Mixin.Events.fireEvent;(function(){var a=
"ActiveXObject"in c,e=a&&!f.addEventListener,g=navigator.userAgent.toLowerCase(),d=g.indexOf("webkit")!==-1,i=g.indexOf("chrome")!==-1,q=g.indexOf("phantom")!==-1,k=g.indexOf("android")!==-1,p=g.search("android [23]")!==-1,g=g.indexOf("gecko")!==-1,o=typeof orientation!==h+"",n=c.navigator&&c.navigator.msPointerEnabled&&c.navigator.msMaxTouchPoints&&!c.PointerEvent,r=c.PointerEvent&&c.navigator.pointerEnabled&&c.navigator.maxTouchPoints||n,s="devicePixelRatio"in c&&c.devicePixelRatio>1||"matchMedia"in
c&&c.matchMedia("(min-resolution:144dpi)")&&c.matchMedia("(min-resolution:144dpi)").matches,z=f.documentElement,v=a&&"transition"in z.style,E="WebKitCSSMatrix"in c&&"m11"in new c.WebKitCSSMatrix&&!p,y="MozPerspective"in z.style,w="OTransition"in z.style,H=!c.L_DISABLE_3D&&(v||E||y||w)&&!q,q=!c.L_NO_TOUCH&&!q&&function(){if(r||"ontouchstart"in z)return!0;var a=f.createElement("div"),b=!1;if(!a.setAttribute)return!1;a.setAttribute("ontouchstart","return;");typeof a.ontouchstart==="function"&&(b=!0);
a.removeAttribute("ontouchstart");return b}();b.Browser={ie:a,ielt9:e,webkit:d,gecko:g&&!d&&!c.opera&&!a,android:k,android23:p,chrome:i,ie3d:v,webkit3d:E,gecko3d:y,opera3d:w,any3d:H,mobile:o,mobileWebkit:o&&d,mobileWebkit3d:o&&E,mobileOpera:o&&c.opera,touch:q,msPointer:n,pointer:r,retina:s}})();b.Point=function(a,b,g){this.x=g?Math.round(a):a;this.y=g?Math.round(b):b};b.Point.prototype={clone:function(){return new b.Point(this.x,this.y)},add:function(a){return this.clone()._add(b.point(a))},_add:function(a){this.x+=
a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(b.point(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){this.x*=a;this.y*=a;return this},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},
floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},distanceTo:function(a){var a=b.point(a),e=a.x-this.x,a=a.y-this.y;return Math.sqrt(e*e+a*a)},equals:function(a){a=b.point(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=b.point(a);return Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+b.Util.formatNum(this.x)+", "+b.Util.formatNum(this.y)+")"}};b.point=
function(a,e,g){if(a instanceof b.Point)return a;if(b.Util.isArray(a))return new b.Point(a[0],a[1]);if(a===h||a===null)return a;return new b.Point(a,e,g)};b.Bounds=function(a,b){if(a)for(var g=b?[a,b]:a,c=0,d=g.length;c<d;c++)this.extend(g[c])};b.Bounds.prototype={extend:function(a){a=b.point(a);!this.min&&!this.max?(this.min=a.clone(),this.max=a.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y));
return this},getCenter:function(a){return new b.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new b.Point(this.min.x,this.max.y)},getTopRight:function(){return new b.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var e,a=typeof a[0]==="number"||a instanceof b.Point?b.point(a):b.bounds(a);a instanceof b.Bounds?(e=a.min,a=a.max):e=a;return e.x>=this.min.x&&a.x<=this.max.x&&e.y>=this.min.y&&a.y<=
this.max.y},intersects:function(a){var a=b.bounds(a),e=this.min,g=this.max,c=a.min,a=a.max,d=a.y>=e.y&&c.y<=g.y;return a.x>=e.x&&c.x<=g.x&&d},isValid:function(){return!(!this.min||!this.max)}};b.bounds=function(a,e){if(!a||a instanceof b.Bounds)return a;return new b.Bounds(a,e)};b.Transformation=function(a,b,g,c){this._a=a;this._b=b;this._c=g;this._d=c};b.Transformation.prototype={transform:function(a,b){return this._transform(a.clone(),b)},_transform:function(a,b){b=b||1;a.x=b*(this._a*a.x+this._b);
a.y=b*(this._c*a.y+this._d);return a},untransform:function(a,e){e=e||1;return new b.Point((a.x/e-this._b)/this._a,(a.y/e-this._d)/this._c)}};b.DomUtil={get:function(a){return typeof a==="string"?f.getElementById(a):a},getStyle:function(a,b){var g=a.style[b];!g&&a.currentStyle&&(g=a.currentStyle[b]);if((!g||g==="auto")&&f.defaultView)g=(g=f.defaultView.getComputedStyle(a,null))?g[b]:null;return g==="auto"?null:g},getViewportOffset:function(a){var e=0,g=0,c=a,d=f.body,h=f.documentElement,i;do{e+=c.offsetTop||
0;g+=c.offsetLeft||0;e+=parseInt(b.DomUtil.getStyle(c,"borderTopWidth"),10)||0;g+=parseInt(b.DomUtil.getStyle(c,"borderLeftWidth"),10)||0;i=b.DomUtil.getStyle(c,"position");if(c.offsetParent===d&&i==="absolute")break;if(i==="fixed"){e+=d.scrollTop||h.scrollTop||0;g+=d.scrollLeft||h.scrollLeft||0;break}if(i==="relative"&&!c.offsetLeft){i=b.DomUtil.getStyle(c,"width");var p=b.DomUtil.getStyle(c,"max-width"),o=c.getBoundingClientRect();if(i!=="none"||p!=="none")g+=o.left+c.clientLeft;e+=o.top+(d.scrollTop||
h.scrollTop||0);break}c=c.offsetParent}while(c);c=a;do{if(c===d)break;e-=c.scrollTop||0;g-=c.scrollLeft||0;c=c.parentNode}while(c);return new b.Point(g,e)},documentIsLtr:function(){if(!b.DomUtil._docIsLtrCached)b.DomUtil._docIsLtrCached=!0,b.DomUtil._docIsLtr=b.DomUtil.getStyle(f.body,"direction")==="ltr";return b.DomUtil._docIsLtr},create:function(a,b,g){a=f.createElement(a);a.className=b;g&&g.appendChild(a);return a},hasClass:function(a,e){if(a.classList!==h)return a.classList.contains(e);var g=
b.DomUtil._getClass(a);return g.length>0&&RegExp("(^|\\s)"+e+"(\\s|$)").test(g)},addClass:function(a,e){if(a.classList!==h)for(var g=b.Util.splitWords(e),c=0,d=g.length;c<d;c++)a.classList.add(g[c]);else b.DomUtil.hasClass(a,e)||(g=b.DomUtil._getClass(a),b.DomUtil._setClass(a,(g?g+" ":"")+e))},removeClass:function(a,e){a.classList!==h?a.classList.remove(e):b.DomUtil._setClass(a,b.Util.trim((" "+b.DomUtil._getClass(a)+" ").replace(" "+e+" "," ")))},_setClass:function(a,b){a.className.baseVal===h?a.className=
b:a.className.baseVal=b},_getClass:function(a){return a.className.baseVal===h?a.className:a.className.baseVal},setOpacity:function(a,b){if("opacity"in a.style)a.style.opacity=b;else if("filter"in a.style){var g=!1;try{g=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(c){if(b===1)return}b=Math.round(b*100);g?(g.Enabled=b!==100,g.Opacity=b):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}},testProp:function(a){for(var b=f.documentElement.style,g=0;g<a.length;g++)if(a[g]in
b)return a[g];return!1},getTranslateString:function(a){var e=b.Browser.webkit3d;return"translate"+(e?"3d":"")+"("+a.x+"px,"+a.y+"px"+((e?",0":"")+")")},getScaleString:function(a,e){return b.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*a)))+(" scale("+a+") ")},setPosition:function(a,e,g){a._leaflet_pos=e;!g&&b.Browser.any3d?a.style[b.DomUtil.TRANSFORM]=b.DomUtil.getTranslateString(e):(a.style.left=e.x+"px",a.style.top=e.y+"px")},getPosition:function(a){return a._leaflet_pos}};b.DomUtil.TRANSFORM=
b.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);b.DomUtil.TRANSITION=b.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);b.DomUtil.TRANSITION_END=b.DomUtil.TRANSITION==="webkitTransition"||b.DomUtil.TRANSITION==="OTransition"?b.DomUtil.TRANSITION+"End":"transitionend";(function(){if("onselectstart"in f)b.extend(b.DomUtil,{disableTextSelection:function(){b.DomEvent.on(c,"selectstart",b.DomEvent.preventDefault)},
enableTextSelection:function(){b.DomEvent.off(c,"selectstart",b.DomEvent.preventDefault)}});else{var a=b.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);b.extend(b.DomUtil,{disableTextSelection:function(){if(a){var b=f.documentElement.style;this._userSelect=b[a];b[a]="none"}},enableTextSelection:function(){if(a)f.documentElement.style[a]=this._userSelect,delete this._userSelect}})}b.extend(b.DomUtil,{disableImageDrag:function(){b.DomEvent.on(c,"dragstart",
b.DomEvent.preventDefault)},enableImageDrag:function(){b.DomEvent.off(c,"dragstart",b.DomEvent.preventDefault)}})})();b.LatLng=function(a,b,g){a=parseFloat(a);b=parseFloat(b);if(isNaN(a)||isNaN(b))throw Error("Invalid LatLng object: ("+a+", "+b+")");this.lat=a;this.lng=b;if(g!==h)this.alt=parseFloat(g)};b.extend(b.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1.0E-9});b.LatLng.prototype={equals:function(a){if(!a)return!1;a=b.latLng(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-
a.lng))<=b.LatLng.MAX_MARGIN},toString:function(a){return"LatLng("+b.Util.formatNum(this.lat,a)+", "+b.Util.formatNum(this.lng,a)+")"},distanceTo:function(a){var a=b.latLng(a),e=b.LatLng.DEG_TO_RAD,g=Math.sin((a.lat-this.lat)*e/2),c=Math.sin((a.lng-this.lng)*e/2),a=g*g+c*c*Math.cos(this.lat*e)*Math.cos(a.lat*e);return 12756274*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))},wrap:function(a,e){var g=this.lng,a=a||-180,e=e||180;return new b.LatLng(this.lat,(g+e)%(e-a)+(g<a||g===e?e:a))}};b.latLng=function(a,
e){if(a instanceof b.LatLng)return a;if(b.Util.isArray(a))return typeof a[0]==="number"||typeof a[0]==="string"?new b.LatLng(a[0],a[1],a[2]):null;if(a===h||a===null)return a;if(typeof a==="object"&&"lat"in a)return new b.LatLng(a.lat,"lng"in a?a.lng:a.lon);if(e===h)return null;return new b.LatLng(a,e)};b.LatLngBounds=function(a,b){if(a)for(var g=b?[a,b]:a,c=0,d=g.length;c<d;c++)this.extend(g[c])};b.LatLngBounds.prototype={extend:function(a){if(!a)return this;var e=b.latLng(a),a=e!==null?e:b.latLngBounds(a);
a instanceof b.LatLng?!this._southWest&&!this._northEast?(this._southWest=new b.LatLng(a.lat,a.lng),this._northEast=new b.LatLng(a.lat,a.lng)):(this._southWest.lat=Math.min(a.lat,this._southWest.lat),this._southWest.lng=Math.min(a.lng,this._southWest.lng),this._northEast.lat=Math.max(a.lat,this._northEast.lat),this._northEast.lng=Math.max(a.lng,this._northEast.lng)):a instanceof b.LatLngBounds&&(this.extend(a._southWest),this.extend(a._northEast));return this},pad:function(a){var e=this._southWest,
g=this._northEast,c=Math.abs(e.lat-g.lat)*a;a*=Math.abs(e.lng-g.lng);return new b.LatLngBounds(new b.LatLng(e.lat-c,e.lng-a),new b.LatLng(g.lat+c,g.lng+a))},getCenter:function(){return new b.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new b.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new b.LatLng(this.getSouth(),
this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){var a=typeof a[0]==="number"||a instanceof b.LatLng?b.latLng(a):b.latLngBounds(a),e=this._southWest,g=this._northEast,c;a instanceof b.LatLngBounds?(c=a.getSouthWest(),a=a.getNorthEast()):c=a;return c.lat>=e.lat&&a.lat<=g.lat&&c.lng>=e.lng&&a.lng<=g.lng},intersects:function(a){var a=
b.latLngBounds(a),e=this._southWest,g=this._northEast,c=a.getSouthWest(),a=a.getNorthEast(),d=a.lng>=e.lng&&c.lng<=g.lng;return a.lat>=e.lat&&c.lat<=g.lat&&d},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a){if(!a)return!1;a=b.latLngBounds(a);return this._southWest.equals(a.getSouthWest())&&this._northEast.equals(a.getNorthEast())},isValid:function(){return!(!this._southWest||!this._northEast)}};b.latLngBounds=function(a,e){if(!a||
a instanceof b.LatLngBounds)return a;return new b.LatLngBounds(a,e)};b.Projection={};b.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(a){var e=b.LatLng.DEG_TO_RAD,g=this.MAX_LATITUDE,c=a.lng*e,a=Math.max(Math.min(g,a.lat),-g)*e,a=Math.log(Math.tan(Math.PI/4+a/2));return new b.Point(c,a)},unproject:function(a){var e=b.LatLng.RAD_TO_DEG;return new b.LatLng((2*Math.atan(Math.exp(a.y))-Math.PI/2)*e,a.x*e)}};b.Projection.LonLat={project:function(a){return new b.Point(a.lng,a.lat)},
unproject:function(a){return new b.LatLng(a.y,a.x)}};b.CRS={latLngToPoint:function(a,b){var g=this.projection.project(a),c=this.scale(b);return this.transformation._transform(g,c)},pointToLatLng:function(a,b){var g=this.scale(b);return this.projection.unproject(this.transformation.untransform(a,g))},project:function(a){return this.projection.project(a)},scale:function(a){return 256*Math.pow(2,a)},getSize:function(a){a=this.scale(a);return b.point(a,a)}};b.CRS.Simple=b.extend({},b.CRS,{projection:b.Projection.LonLat,
transformation:new b.Transformation(1,0,-1,0),scale:function(a){return Math.pow(2,a)}});b.CRS.EPSG3857=b.extend({},b.CRS,{code:"EPSG:3857",projection:b.Projection.SphericalMercator,transformation:new b.Transformation(0.5/Math.PI,0.5,-0.5/Math.PI,0.5),project:function(a){return this.projection.project(a).multiplyBy(6378137)}});b.CRS.EPSG900913=b.extend({},b.CRS.EPSG3857,{code:"EPSG:900913"});b.CRS.EPSG4326=b.extend({},b.CRS,{code:"EPSG:4326",projection:b.Projection.LonLat,transformation:new b.Transformation(1/
360,0.5,-1/360,0.5)});b.Map=b.Class.extend({includes:b.Mixin.Events,options:{crs:b.CRS.EPSG3857,fadeAnimation:b.DomUtil.TRANSITION&&!b.Browser.android23,trackResize:!0,markerZoomAnimation:b.DomUtil.TRANSITION&&b.Browser.any3d},initialize:function(a,e){e=b.setOptions(this,e);this._initContainer(a);this._initLayout();this._onResize=b.bind(this._onResize,this);this._initEvents();e.maxBounds&&this.setMaxBounds(e.maxBounds);e.center&&e.zoom!==h&&this.setView(b.latLng(e.center),e.zoom,{reset:!0});this._handlers=
[];this._layers={};this._zoomBoundLayers={};this._tileLayersNum=0;this.callInitHooks();this._addLayers(e.layers)},setView:function(a,e){e=e===h?this.getZoom():e;this._resetView(b.latLng(a),this._limitZoom(e));return this},setZoom:function(a,b){if(!this._loaded)return this._zoom=this._limitZoom(a),this;return this.setView(this.getCenter(),a,{zoom:b})},zoomIn:function(a,b){return this.setZoom(this._zoom+(a||1),b)},zoomOut:function(a,b){return this.setZoom(this._zoom-(a||1),b)},setZoomAround:function(a,
e,g){var c=this.getZoomScale(e),d=this.getSize().divideBy(2),a=(a instanceof b.Point?a:this.latLngToContainerPoint(a)).subtract(d).multiplyBy(1-1/c);return this.setView(this.containerPointToLatLng(d.add(a)),e,{zoom:g})},fitBounds:function(a,e){var e=e||{},a=a.getBounds?a.getBounds():b.latLngBounds(a),g=b.point(e.paddingTopLeft||e.padding||[0,0]),c=b.point(e.paddingBottomRight||e.padding||[0,0]),d=this.getBoundsZoom(a,!1,g.add(c)),g=c.subtract(g).divideBy(2),c=this.project(a.getSouthWest(),d),f=this.project(a.getNorthEast(),
d),g=this.unproject(c.add(f).divideBy(2).add(g),d),d=e&&e.maxZoom?Math.min(e.maxZoom,d):d;return this.setView(g,d,e)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,b){return this.setView(a,this._zoom,{pan:b})},panBy:function(a){this.fire("movestart");this._rawPanBy(b.point(a));this.fire("move");return this.fire("moveend")},setMaxBounds:function(a){a=b.latLngBounds(a);this.options.maxBounds=a;if(!a)return this.off("moveend",this._panInsideMaxBounds,this);this._loaded&&
this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(a,b){var g=this.getCenter(),c=this._limitCenter(g,this._zoom,a);if(g.equals(c))return this;return this.panTo(c,b)},addLayer:function(a){var e=b.stamp(a);if(this._layers[e])return this;this._layers[e]=a;if(a.options&&(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom)))this._zoomBoundLayers[e]=a,this._updateZoomLevels();this.options.zoomAnimation&&b.TileLayer&&a instanceof b.TileLayer&&(this._tileLayersNum++,
this._tileLayersToLoad++,a.on("load",this._onTileLayerLoad,this));this._loaded&&this._layerAdd(a);return this},removeLayer:function(a){var e=b.stamp(a);if(!this._layers[e])return this;if(this._loaded)a.onRemove(this);delete this._layers[e];this._loaded&&this.fire("layerremove",{layer:a});this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels());this.options.zoomAnimation&&b.TileLayer&&a instanceof b.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,a.off("load",
this._onTileLayerLoad,this));return this},hasLayer:function(a){if(!a)return!1;return b.stamp(a)in this._layers},eachLayer:function(a,b){for(var g in this._layers)a.call(b,this._layers[g]);return this},invalidateSize:function(a){if(!this._loaded)return this;var a=b.extend({animate:!1,pan:!0},a===!0?{animate:!0}:a),e=this.getSize();this._sizeChanged=!0;this._initialCenter=null;var g=this.getSize(),c=e.divideBy(2).round(),d=g.divideBy(2).round(),c=c.subtract(d);if(!c.x&&!c.y)return this;a.animate&&a.pan?
this.panBy(c):(a.pan&&this._rawPanBy(c),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(b.bind(this.fire,this,"moveend"),200)):this.fire("moveend"));return this.fire("resize",{oldSize:e,newSize:g})},addHandler:function(a,b){if(!b)return this;var g=this[a]=new b(this);this._handlers.push(g);this.options[a]&&g.enable();return this},remove:function(){this._loaded&&this.fire("unload");this._initEvents("off");try{delete this._container._leaflet}catch(a){this._container._leaflet=
h}this._clearPanes();this._clearControlPos&&this._clearControlPos();this._clearHandlers();return this},getCenter:function(){this._checkIfLoaded();if(this._initialCenter&&!this._moved())return this._initialCenter;return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),e=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new b.LatLngBounds(e,a)},getMinZoom:function(){return this.options.minZoom===
h?this._layersMinZoom===h?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===h?this._layersMaxZoom===h?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,e,g){var a=b.latLngBounds(a),c=this.getMinZoom()-(e?1:0),d=this.getMaxZoom(),f=this.getSize(),h=a.getNorthWest(),a=a.getSouthEast(),i=!0,g=b.point(g||[0,0]);do c++,i=this.project(a,c).subtract(this.project(h,c)).add(g),i=!e?f.contains(i):i.x<f.x||i.y<f.y;while(i&&c<=d);if(i&&e)return null;
return e?c:c-1},getSize:function(){if(!this._size||this._sizeChanged)this._size=new b.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(){var a=this._getTopLeftPoint();return new b.Bounds(a,a.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a){var b=
this.options.crs;return b.scale(a)/b.scale(this._zoom)},getScaleZoom:function(a){return this._zoom+Math.log(a)/Math.LN2},project:function(a,e){e=e===h?this._zoom:e;return this.options.crs.latLngToPoint(b.latLng(a),e)},unproject:function(a,e){e=e===h?this._zoom:e;return this.options.crs.pointToLatLng(b.point(a),e)},layerPointToLatLng:function(a){return this.unproject(b.point(a).add(this.getPixelOrigin()))},latLngToLayerPoint:function(a){return this.project(b.latLng(a))._round()._subtract(this.getPixelOrigin())},
containerPointToLayerPoint:function(a){return b.point(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return b.point(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){return this.layerPointToLatLng(this.containerPointToLayerPoint(b.point(a)))},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(b.latLng(a)))},mouseEventToContainerPoint:function(a){return b.DomEvent.getMousePosition(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},
mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){if(a=this._container=b.DomUtil.get(a)){if(a._leaflet)throw Error("Map container is already initialized.");}else throw Error("Map container not found.");a._leaflet=!0},_initLayout:function(){var a=this._container;b.DomUtil.addClass(a,"leaflet-container"+(b.Browser.touch?" leaflet-touch":"")+(b.Browser.retina?" leaflet-retina":"")+(b.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?
" leaflet-fade-anim":""));var e=b.DomUtil.getStyle(a,"position");if(e!=="absolute"&&e!=="relative"&&e!=="fixed")a.style.position="relative";this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._mapPane=a.mapPane=this._createPane("leaflet-map-pane",this._container);this._tilePane=a.tilePane=this._createPane("leaflet-tile-pane",this._mapPane);a.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane);a.shadowPane=this._createPane("leaflet-shadow-pane");
a.overlayPane=this._createPane("leaflet-overlay-pane");a.markerPane=this._createPane("leaflet-marker-pane");a.popupPane=this._createPane("leaflet-popup-pane");this.options.markerZoomAnimation||(b.DomUtil.addClass(a.markerPane," leaflet-zoom-hide"),b.DomUtil.addClass(a.shadowPane," leaflet-zoom-hide"),b.DomUtil.addClass(a.popupPane," leaflet-zoom-hide"))},_createPane:function(a,e){return b.DomUtil.create("div",a,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},
_addLayers:function(a){for(var a=a?b.Util.isArray(a)?a:[a]:[],e=0,g=a.length;e<g;e++)this.addLayer(a[e])},_resetView:function(a,e,g,c){var d=this._zoom!==e;c||(this.fire("movestart"),d&&this.fire("zoomstart"));this._zoom=e;this._initialCenter=a;this._initialTopLeftPoint=this._getNewTopLeftPoint(a);g?this._initialTopLeftPoint._add(this._getMapPanePos()):b.DomUtil.setPosition(this._mapPane,new b.Point(0,0));this._tileLayersToLoad=this._tileLayersNum;a=!this._loaded;this._loaded=!0;a&&(this.fire("load"),
this.eachLayer(this._layerAdd,this));this.fire("viewreset",{hard:!g});this.fire("move");(d||c)&&this.fire("zoomend");this.fire("moveend",{hard:!g})},_rawPanBy:function(a){b.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var a,b=Infinity,g=-Infinity,c=this._getZoomSpan();for(a in this._zoomBoundLayers){var d=this._zoomBoundLayers[a];isNaN(d.options.minZoom)||(b=Math.min(b,d.options.minZoom));
isNaN(d.options.maxZoom)||(g=Math.max(g,d.options.maxZoom))}a===h?this._layersMaxZoom=this._layersMinZoom=h:(this._layersMaxZoom=g,this._layersMinZoom=b);c!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");},_initEvents:function(a){if(b.DomEvent){a=a||"on";b.DomEvent[a](this._container,"click",this._onMouseClick,this);var e=["dblclick",
"mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"],g,d;g=0;for(d=e.length;g<d;g++)b.DomEvent[a](this._container,e[g],this._fireMouseEvent,this);if(this.options.trackResize)b.DomEvent[a](c,"resize",this._onResize,this)}},_onResize:function(){b.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=b.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(a){if(this._loaded&&!(!a._simulated&&(this.dragging&&
this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||b.DomEvent._skipped(a)))this.fire("preclick"),this._fireMouseEvent(a)},_fireMouseEvent:function(a){if(this._loaded&&!b.DomEvent._skipped(a)){var e=a.type,e=e==="mouseenter"?"mouseover":e==="mouseleave"?"mouseout":e;if(this.hasEventListeners(e)){e==="contextmenu"&&b.DomEvent.preventDefault(a);var g=this.mouseEventToContainerPoint(a),c=this.containerPointToLayerPoint(g),d=this.layerPointToLatLng(c);this.fire(e,{latlng:d,layerPoint:c,containerPoint:g,
originalEvent:a})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--;this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var a=0,b=this._handlers.length;a<b;a++)this._handlers[a].disable()},whenReady:function(a,b){if(this._loaded)a.call(b||this,this);else this.on("load",a,b);return this},_layerAdd:function(a){a.onAdd(this);this.fire("layeradd",{layer:a})},_getMapPanePos:function(){return b.DomUtil.getPosition(this._mapPane)},_moved:function(){var a=
this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(a,b){var g=this.getSize()._divideBy(2);return this.project(a,b)._subtract(g)._round()},_latLngToNewLayerPoint:function(a,b,g){g=this._getNewTopLeftPoint(g,b).add(this._getMapPanePos());return this.project(a,b)._subtract(g)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},
_limitCenter:function(a,e,g){if(!g)return a;var a=this.project(a,e),c=this.getSize().divideBy(2),g=this._getBoundsOffset(new b.Bounds(a.subtract(c),a.add(c)),g,e);return this.unproject(a.add(g),e)},_limitOffset:function(a,e){if(!e)return a;var g=this.getPixelBounds(),g=new b.Bounds(g.min.add(a),g.max.add(a));return a.add(this._getBoundsOffset(g,e))},_getBoundsOffset:function(a,e,g){var c=this.project(e.getNorthWest(),g).subtract(a.min),e=this.project(e.getSouthEast(),g).subtract(a.max),a=this._rebound(c.x,
-e.x),c=this._rebound(c.y,-e.y);return new b.Point(a,c)},_rebound:function(a,b){return a+b>0?Math.round(a-b)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(b))},_limitZoom:function(a){var b=this.getMinZoom(),g=this.getMaxZoom();return Math.max(b,Math.min(g,a))}});b.map=function(a,e){return new b.Map(a,e)};b.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(a){var e=b.LatLng.DEG_TO_RAD,g=this.MAX_LATITUDE,c=this.R_MAJOR,d=a.lng*e*c,a=Math.max(Math.min(g,
a.lat),-g)*e,e=this.R_MINOR/c,e=Math.sqrt(1-e*e),g=e*Math.sin(a),g=Math.pow((1-g)/(1+g),e*0.5),a=-c*Math.log(Math.tan(0.5*(Math.PI*0.5-a))/g);return new b.Point(d,a)},unproject:function(a){for(var e=b.LatLng.RAD_TO_DEG,g=this.R_MAJOR,c=a.x*e/g,d=this.R_MINOR/g,d=Math.sqrt(1-d*d),a=Math.exp(-a.y/g),g=Math.PI/2-2*Math.atan(a),f=15,h=0.1;Math.abs(h)>1.0E-7&&--f>0;)h=d*Math.sin(g),h=Math.PI/2-2*Math.atan(a*Math.pow((1-h)/(1+h),0.5*d))-g,g+=h;return new b.LatLng(g*e,c)}};b.CRS.EPSG3395=b.extend({},b.CRS,
{code:"EPSG:3395",projection:b.Projection.Mercator,transformation:function(){var a=0.5/(Math.PI*b.Projection.Mercator.R_MAJOR);return new b.Transformation(a,0.5,-a,0.5)}()});b.TileLayer=b.Class.extend({includes:b.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:b.Browser.mobile,updateWhenIdle:b.Browser.mobile},initialize:function(a,e){e=b.setOptions(this,e);if(e.detectRetina&&b.Browser.retina&&e.maxZoom>
0)e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--;if(e.bounds)e.bounds=b.latLngBounds(e.bounds);this._url=a;var g=this.options.subdomains;if(typeof g==="string")this.options.subdomains=g.split("")},onAdd:function(a){this._map=a;this._animated=a._zoomAnimated;this._initContainer();a.on({viewreset:this._reset,moveend:this._update},this);if(this._animated)a.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);if(!this.options.updateWhenIdle)this._limitedUpdate=
b.Util.limitExecByInterval(this._update,150,this),a.on("move",this._limitedUpdate,this);this._reset();this._update()},addTo:function(a){a.addLayer(this);return this},onRemove:function(a){this._container.parentNode.removeChild(this._container);a.off({viewreset:this._reset,moveend:this._update},this);this._animated&&a.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this);this.options.updateWhenIdle||a.off("move",this._limitedUpdate,this);this._map=this._container=null},bringToFront:function(){var a=
this._map._panes.tilePane;this._container&&(a.appendChild(this._container),this._setAutoZIndex(a,Math.max));return this},bringToBack:function(){var a=this._map._panes.tilePane;this._container&&(a.insertBefore(this._container,a.firstChild),this._setAutoZIndex(a,Math.min));return this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(a){this.options.opacity=a;this._map&&this._updateOpacity();return this},setZIndex:function(a){this.options.zIndex=
a;this._updateZIndex();return this},setUrl:function(a,b){this._url=a;b||this.redraw();return this},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());return this},_updateZIndex:function(){if(this._container&&this.options.zIndex!==h)this._container.style.zIndex=this.options.zIndex},_setAutoZIndex:function(a,b){var g=a.children,c=-b(Infinity,-Infinity),d,f,h;f=0;for(h=g.length;f<h;f++)g[f]!==this._container&&(d=parseInt(g[f].style.zIndex,10),isNaN(d)||(c=b(c,d)));this.options.zIndex=
this._container.style.zIndex=(isFinite(c)?c:0)+b(1,-1)},_updateOpacity:function(){var a,e=this._tiles;if(b.Browser.ielt9)for(a in e)b.DomUtil.setOpacity(e[a],this.options.opacity);else b.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var a=this._map._panes.tilePane;if(!this._container)this._container=b.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated?(this._bgBuffer=b.DomUtil.create("div","leaflet-tile-container",this._container),this._tileContainer=
b.DomUtil.create("div","leaflet-tile-container",this._container)):this._tileContainer=this._container,a.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()},_reset:function(a){for(var b in this._tiles)this.fire("tileunload",{tile:this._tiles[b]});this._tiles={};this._tilesToLoad=0;if(this.options.reuseTiles)this._unusedTiles=[];this._tileContainer.innerHTML="";this._animated&&a&&a.hard&&this._clearBgBuffer();this._initContainer()},_getTileSize:function(){var a=this._map,b=a.getZoom()+
this.options.zoomOffset,c=this.options.maxNativeZoom,d=this.options.tileSize;c&&b>c&&(d=Math.round(a.getZoomScale(b)/a.getZoomScale(c)*d));return d},_update:function(){if(this._map){var a=this._map,e=a.getPixelBounds(),a=a.getZoom(),c=this._getTileSize();a>this.options.maxZoom||a<this.options.minZoom||(e=b.bounds(e.min.divideBy(c)._floor(),e.max.divideBy(c)._floor()),this._addTilesFromCenterOut(e),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(e))}},_addTilesFromCenterOut:function(a){var e=
[],c=a.getCenter(),d,h,i;for(d=a.min.y;d<=a.max.y;d++)for(h=a.min.x;h<=a.max.x;h++)i=new b.Point(h,d),this._tileShouldBeLoaded(i)&&e.push(i);a=e.length;if(a!==0){e.sort(function(a,b){return a.distanceTo(c)-b.distanceTo(c)});d=f.createDocumentFragment();this._tilesToLoad||this.fire("loading");this._tilesToLoad+=a;for(h=0;h<a;h++)this._addTile(e[h],d);this._tileContainer.appendChild(d)}},_tileShouldBeLoaded:function(a){if(a.x+":"+a.y in this._tiles)return!1;var b=this.options;if(!b.continuousWorld){var c=
this._getWrapTileNum();if(b.noWrap&&(a.x<0||a.x>=c.x)||a.y<0||a.y>=c.y)return!1}if(b.bounds&&(c=b.tileSize,a=a.multiplyBy(c),c=a.add([c,c]),a=this._map.unproject(a),c=this._map.unproject(c),!b.continuousWorld&&!b.noWrap&&(a=a.wrap(),c=c.wrap()),!b.bounds.intersects([a,c])))return!1;return!0},_removeOtherTiles:function(a){var b,c,d;for(d in this._tiles)b=d.split(":"),c=parseInt(b[0],10),b=parseInt(b[1],10),(c<a.min.x||c>a.max.x||b<a.min.y||b>a.max.y)&&this._removeTile(d)},_removeTile:function(a){var e=
this._tiles[a];this.fire("tileunload",{tile:e,url:e.src});this.options.reuseTiles?(b.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e);if(!b.Browser.android)e.onload=null,e.src=b.Util.emptyImageUrl;delete this._tiles[a]},_addTile:function(a,e){var c=this._getTilePos(a),d=this._getTile();b.DomUtil.setPosition(d,c,b.Browser.chrome);this._tiles[a.x+":"+a.y]=d;this._loadTile(d,a);d.parentNode!==this._tileContainer&&
e.appendChild(d)},_getZoomForUrl:function(){var a=this.options,b=this._map.getZoom();a.zoomReverse&&(b=a.maxZoom-b);b+=a.zoomOffset;return a.maxNativeZoom?Math.min(b,a.maxNativeZoom):b},_getTilePos:function(a){var b=this._map.getPixelOrigin(),c=this._getTileSize();return a.multiplyBy(c).subtract(b)},getTileUrl:function(a){return b.Util.template(this._url,b.extend({s:this._getSubdomain(a),z:a.z,x:a.x,y:a.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},
_adjustTilePoint:function(a){var b=this._getWrapTileNum();if(!this.options.continuousWorld&&!this.options.noWrap)a.x=(a.x%b.x+b.x)%b.x;if(this.options.tms)a.y=b.y-a.y-1;a.z=this._getZoomForUrl()},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var a=this._unusedTiles.pop();this._resetTile(a);return a}return this._createTile()},_resetTile:function(){},_createTile:function(){var a=
b.DomUtil.create("img","leaflet-tile");a.style.width=a.style.height=this._getTileSize()+"px";a.galleryimg="no";a.onselectstart=a.onmousemove=b.Util.falseFn;b.Browser.ielt9&&this.options.opacity!==h&&b.DomUtil.setOpacity(a,this.options.opacity);if(b.Browser.mobileWebkit3d)a.style.WebkitBackfaceVisibility="hidden";return a},_loadTile:function(a,b){a._layer=this;a.onload=this._tileOnLoad;a.onerror=this._tileOnError;this._adjustTilePoint(b);a.src=this.getTileUrl(b);this.fire("tileloadstart",{tile:a,url:a.src})},
_tileLoaded:function(){this._tilesToLoad--;this._animated&&b.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated");if(!this._tilesToLoad&&(this.fire("load"),this._animated))clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(b.bind(this._clearBgBuffer,this),500)},_tileOnLoad:function(){var a=this._layer;this.src!==b.Util.emptyImageUrl&&(b.DomUtil.addClass(this,"leaflet-tile-loaded"),a.fire("tileload",{tile:this,url:this.src}));a._tileLoaded()},_tileOnError:function(){var a=
this._layer;a.fire("tileerror",{tile:this,url:this.src});var b=a.options.errorTileUrl;if(b)this.src=b;a._tileLoaded()}});b.tileLayer=function(a,e){return new b.TileLayer(a,e)};b.TileLayer.WMS=b.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(a,e){this._url=a;var c=b.extend({},this.defaultWmsParams),d=e.tileSize||this.options.tileSize;c.width=e.detectRetina&&b.Browser.retina?c.height=d*2:
c.height=d;for(var f in e)!this.options.hasOwnProperty(f)&&f!=="crs"&&(c[f]=e[f]);this.wmsParams=c;b.setOptions(this,e)},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code;b.TileLayer.prototype.onAdd.call(this,a)},getTileUrl:function(a){var e=this._map,c=this.options.tileSize,d=a.multiplyBy(c),c=d.add([c,c]),d=this._crs.project(e.unproject(d,a.z)),e=this._crs.project(e.unproject(c,
a.z)),e=this._wmsVersion>=1.3&&this._crs===b.CRS.EPSG4326?[e.y,d.x,d.y,e.x].join(","):[d.x,e.y,e.x,d.y].join(","),a=b.Util.template(this._url,{s:this._getSubdomain(a)});return a+b.Util.getParamString(this.wmsParams,a,!0)+"&BBOX="+e},setParams:function(a,e){b.extend(this.wmsParams,a);e||this.redraw();return this}});b.tileLayer.wms=function(a,e){return new b.TileLayer.WMS(a,e)};b.TileLayer.Canvas=b.TileLayer.extend({options:{async:!1},initialize:function(a){b.setOptions(this,a)},redraw:function(){this._map&&
(this._reset({hard:!0}),this._update());for(var a in this._tiles)this._redrawTile(this._tiles[a]);return this},_redrawTile:function(a){this.drawTile(a,a._tilePoint,this._map._zoom)},_createTile:function(){var a=b.DomUtil.create("canvas","leaflet-tile");a.width=a.height=this.options.tileSize;a.onselectstart=a.onmousemove=b.Util.falseFn;return a},_loadTile:function(a,b){a._layer=this;a._tilePoint=b;this._redrawTile(a);this.options.async||this.tileDrawn(a)},drawTile:function(){},tileDrawn:function(a){this._tileOnLoad.call(a)}});
b.tileLayer.canvas=function(a){return new b.TileLayer.Canvas(a)};b.ImageOverlay=b.Class.extend({includes:b.Mixin.Events,options:{opacity:1},initialize:function(a,e,c){this._url=a;this._bounds=b.latLngBounds(e);b.setOptions(this,c)},onAdd:function(a){this._map=a;this._image||this._initImage();a._panes.overlayPane.appendChild(this._image);a.on("viewreset",this._reset,this);if(a.options.zoomAnimation&&b.Browser.any3d)a.on("zoomanim",this._animateZoom,this);this._reset()},onRemove:function(a){a.getPanes().overlayPane.removeChild(this._image);
a.off("viewreset",this._reset,this);a.options.zoomAnimation&&a.off("zoomanim",this._animateZoom,this)},addTo:function(a){a.addLayer(this);return this},setOpacity:function(a){this.options.opacity=a;this._updateOpacity();return this},bringToFront:function(){this._image&&this._map._panes.overlayPane.appendChild(this._image);return this},bringToBack:function(){var a=this._map._panes.overlayPane;this._image&&a.insertBefore(this._image,a.firstChild);return this},setUrl:function(a){this._url=a;this._image.src=
this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=b.DomUtil.create("img","leaflet-image-layer");this._map.options.zoomAnimation&&b.Browser.any3d?b.DomUtil.addClass(this._image,"leaflet-zoom-animated"):b.DomUtil.addClass(this._image,"leaflet-zoom-hide");this._updateOpacity();b.extend(this._image,{galleryimg:"no",onselectstart:b.Util.falseFn,onmousemove:b.Util.falseFn,onload:b.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(a){var e=
this._map,c=this._image,d=e.getZoomScale(a.zoom),f=this._bounds.getNorthWest(),h=this._bounds.getSouthEast(),f=e._latLngToNewLayerPoint(f,a.zoom,a.center),a=e._latLngToNewLayerPoint(h,a.zoom,a.center)._subtract(f),a=f._add(a._multiplyBy(0.5*(1-1/d)));c.style[b.DomUtil.TRANSFORM]=b.DomUtil.getTranslateString(a)+" scale("+d+") "},_reset:function(){var a=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),c=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);b.DomUtil.setPosition(a,
e);a.style.width=c.x+"px";a.style.height=c.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){b.DomUtil.setOpacity(this._image,this.options.opacity)}});b.imageOverlay=function(a,e,c){return new b.ImageOverlay(a,e,c)};b.Icon=b.Class.extend({options:{className:""},initialize:function(a){b.setOptions(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,b){var c=this._getIconUrl(a);
if(!c){if(a==="icon")throw Error("iconUrl not set in Icon options (see the docs).");return null}c=!b||b.tagName!=="IMG"?this._createImg(c):this._createImg(c,b);this._setIconStyles(c,a);return c},_setIconStyles:function(a,e){var c=this.options,d=b.point(c[e+"Size"]),f;f=e==="shadow"?b.point(c.shadowAnchor||c.iconAnchor):b.point(c.iconAnchor);!f&&d&&(f=d.divideBy(2,!0));a.className="leaflet-marker-"+e+" "+c.className;if(f)a.style.marginLeft=-f.x+"px",a.style.marginTop=-f.y+"px";if(d)a.style.width=d.x+
"px",a.style.height=d.y+"px"},_createImg:function(a,b){b=b||f.createElement("img");b.src=a;return b},_getIconUrl:function(a){if(b.Browser.retina&&this.options[a+"RetinaUrl"])return this.options[a+"RetinaUrl"];return this.options[a+"Url"]}});b.icon=function(a){return new b.Icon(a)};b.Icon.Default=b.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(a){var e=a+"Url";if(this.options[e])return this.options[e];b.Browser.retina&&a==="icon"&&
(a+="-2x");e=b.Icon.Default.imagePath;if(!e)throw Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return e+"/marker-"+a+".png"}});b.Icon.Default.imagePath=function(){var a=f.getElementsByTagName("script"),b=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/,c,d,h,i;c=0;for(d=a.length;c<d;c++)if(h=a[c].src,i=h.match(b))return a=h.split(b)[0],(a?a+"/":"")+"images"}();b.Marker=b.Class.extend({includes:b.Mixin.Events,options:{icon:new b.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,
keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(a,e){b.setOptions(this,e);this._latlng=b.latLng(a)},onAdd:function(a){this._map=a;a.on("viewreset",this.update,this);this._initIcon();this.update();this.fire("add");if(a.options.zoomAnimation&&a.options.markerZoomAnimation)a.on("zoomanim",this._animateZoom,this)},addTo:function(a){a.addLayer(this);return this},onRemove:function(a){this.dragging&&this.dragging.disable();this._removeIcon();this._removeShadow();this.fire("remove");
a.off({viewreset:this.update,zoomanim:this._animateZoom},this);this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=b.latLng(a);this.update();return this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(a){this.options.zIndexOffset=a;this.update();return this},setIcon:function(a){this.options.icon=a;this._map&&(this._initIcon(),this.update());this._popup&&this.bindPopup(this._popup);return this},update:function(){this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round());
return this},_initIcon:function(){var a=this.options,e=this._map,c=e.options.zoomAnimation&&e.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",d=a.icon.createIcon(this._icon),e=!1;if(d!==this._icon){this._icon&&this._removeIcon();e=!0;if(a.title)d.title=a.title;if(a.alt)d.alt=a.alt}b.DomUtil.addClass(d,c);if(a.keyboard)d.tabIndex="0";this._icon=d;this._initInteraction();if(a.riseOnHover)b.DomEvent.on(d,"mouseover",this._bringToFront,this).on(d,"mouseout",this._resetZIndex,this);
var d=a.icon.createShadow(this._shadow),f=!1;d!==this._shadow&&(this._removeShadow(),f=!0);d&&b.DomUtil.addClass(d,c);this._shadow=d;a.opacity<1&&this._updateOpacity();a=this._map._panes;e&&a.markerPane.appendChild(this._icon);d&&f&&a.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&b.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex);this._map._panes.markerPane.removeChild(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&
this._map._panes.shadowPane.removeChild(this._shadow);this._shadow=null},_setPos:function(a){b.DomUtil.setPosition(this._icon,a);this._shadow&&b.DomUtil.setPosition(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){this._setPos(this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round())},_initInteraction:function(){if(this.options.clickable){var a=this._icon,e=["dblclick",
"mousedown","mouseover","mouseout","contextmenu"];b.DomUtil.addClass(a,"leaflet-clickable");b.DomEvent.on(a,"click",this._onMouseClick,this);b.DomEvent.on(a,"keypress",this._onKeyPress,this);for(var c=0;c<e.length;c++)b.DomEvent.on(a,e[c],this._fireMouseEvent,this);if(b.Handler.MarkerDrag)this.dragging=new b.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable()}},_onMouseClick:function(a){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(a.type)||e)&&b.DomEvent.stopPropagation(a);
e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(a.type,{originalEvent:a,latlng:this._latlng})},_onKeyPress:function(a){a.keyCode===13&&this.fire("click",{originalEvent:a,latlng:this._latlng})},_fireMouseEvent:function(a){this.fire(a.type,{originalEvent:a,latlng:this._latlng});a.type==="contextmenu"&&this.hasEventListeners(a.type)&&b.DomEvent.preventDefault(a);a.type!=="mousedown"?b.DomEvent.stopPropagation(a):b.DomEvent.preventDefault(a)},setOpacity:function(a){this.options.opacity=
a;this._map&&this._updateOpacity();return this},_updateOpacity:function(){b.DomUtil.setOpacity(this._icon,this.options.opacity);this._shadow&&b.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}});b.marker=function(a,e){return new b.Marker(a,e)};b.DivIcon=b.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(a){var a=a&&a.tagName==="DIV"?
a:f.createElement("div"),b=this.options;a.innerHTML=b.html!==!1?b.html:"";if(b.bgPos)a.style.backgroundPosition=-b.bgPos.x+"px "+-b.bgPos.y+"px";this._setIconStyles(a,"icon");return a},createShadow:function(){return null}});b.divIcon=function(a){return new b.DivIcon(a)};b.Map.mergeOptions({closePopupOnClick:!0});b.Popup=b.Class.extend({includes:b.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},
initialize:function(a,e){b.setOptions(this,a);this._source=e;this._animated=b.Browser.any3d&&this.options.zoomAnimation;this._isOpen=!1},onAdd:function(a){this._map=a;this._container||this._initLayout();var e=a.options.fadeAnimation;e&&b.DomUtil.setOpacity(this._container,0);a._panes.popupPane.appendChild(this._container);a.on(this._getEvents(),this);this.update();e&&b.DomUtil.setOpacity(this._container,1);this.fire("open");a.fire("popupopen",{popup:this});this._source&&this._source.fire("popupopen",
{popup:this})},addTo:function(a){a.addLayer(this);return this},openOn:function(a){a.openPopup(this);return this},onRemove:function(a){a._panes.popupPane.removeChild(this._container);b.Util.falseFn(this._container.offsetWidth);a.off(this._getEvents(),this);a.options.fadeAnimation&&b.DomUtil.setOpacity(this._container,0);this._map=null;this.fire("close");a.fire("popupclose",{popup:this});this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=
b.latLng(a);this._map&&(this._updatePosition(),this._adjustPan());return this},getContent:function(){return this._content},setContent:function(a){this._content=a;this.update();return this},update:function(){if(this._map)this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_getEvents:function(){var a={viewreset:this._updatePosition};if(this._animated)a.zoomanim=this._zoomAnimation;if("closeOnClick"in
this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)a.preclick=this._close;if(this.options.keepInView)a.moveend=this._adjustPan;return a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=b.DomUtil.create("div","leaflet-popup "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide")),e;if(this.options.closeButton)e=this._closeButton=b.DomUtil.create("a","leaflet-popup-close-button",a),e.href="#close",e.innerHTML=
"&#215;",b.DomEvent.disableClickPropagation(e),b.DomEvent.on(e,"click",this._onCloseButtonClick,this);e=this._wrapper=b.DomUtil.create("div","leaflet-popup-content-wrapper",a);b.DomEvent.disableClickPropagation(e);this._contentNode=b.DomUtil.create("div","leaflet-popup-content",e);b.DomEvent.disableScrollPropagation(this._contentNode);b.DomEvent.on(e,"contextmenu",b.DomEvent.stopPropagation);this._tipContainer=b.DomUtil.create("div","leaflet-popup-tip-container",a);this._tip=b.DomUtil.create("div",
"leaflet-popup-tip",this._tipContainer)},_updateContent:function(){if(this._content){if(typeof this._content==="string")this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var a=this._contentNode,e=a.style;e.width="";e.whiteSpace="nowrap";var c=a.offsetWidth,c=Math.min(c,this.options.maxWidth),c=Math.max(c,
this.options.minWidth);e.width=c+1+"px";e.whiteSpace="";e.height="";var c=a.offsetHeight,d=this.options.maxHeight;d&&c>d?(e.height=d+"px",b.DomUtil.addClass(a,"leaflet-popup-scrolled")):b.DomUtil.removeClass(a,"leaflet-popup-scrolled");this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),e=this._animated,c=b.point(this.options.offset);e&&b.DomUtil.setPosition(this._container,a);this._containerBottom=-c.y-(e?0:a.y);
this._containerLeft=-Math.round(this._containerWidth/2)+c.x+(e?0:a.x);this._container.style.bottom=this._containerBottom+"px";this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(a){a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);b.DomUtil.setPosition(this._container,a)},_adjustPan:function(){if(this.options.autoPan){var a=this._map,e=this._container.offsetHeight,c=this._containerWidth,d=new b.Point(this._containerLeft,-e-this._containerBottom);this._animated&&
d._add(b.DomUtil.getPosition(this._container));var d=a.layerPointToContainerPoint(d),f=b.point(this.options.autoPanPadding),h=b.point(this.options.autoPanPaddingTopLeft||f),f=b.point(this.options.autoPanPaddingBottomRight||f),i=a.getSize(),p=0,o=0;d.x+c+f.x>i.x&&(p=d.x+c-i.x+f.x);d.x-p-h.x<0&&(p=d.x-h.x);d.y+e+f.y>i.y&&(o=d.y+e-i.y+f.y);d.y-o-h.y<0&&(o=d.y-h.y);(p||o)&&a.fire("autopanstart").panBy([p,o])}},_onCloseButtonClick:function(a){this._close();b.DomEvent.stop(a)}});b.popup=function(a,e){return new b.Popup(a,
e)};b.Map.include({openPopup:function(a,e,c){this.closePopup();a instanceof b.Popup||(a=(new b.Popup(c)).setLatLng(e).setContent(a));a._isOpen=!0;this._popup=a;return this.addLayer(a)},closePopup:function(a){if(!a||a===this._popup)a=this._popup,this._popup=null;if(a)this.removeLayer(a),a._isOpen=!1;return this}});b.Marker.include({openPopup:function(){this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup));return this},closePopup:function(){this._popup&&
this._popup._close();return this},togglePopup:function(){this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup());return this},bindPopup:function(a,e){var c=b.point(this.options.icon.options.popupAnchor||[0,0]),c=c.add(b.Popup.prototype.options.offset);e&&e.offset&&(c=c.add(e.offset));e=b.extend({offset:c},e);if(!this._popupHandlersAdded)this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0;a instanceof b.Popup?
(b.setOptions(a,e),this._popup=a):this._popup=(new b.Popup(e,this)).setContent(a);return this},setPopupContent:function(a){this._popup&&this._popup.setContent(a);return this},unbindPopup:function(){if(this._popup)this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1;return this},getPopup:function(){return this._popup},_movePopup:function(a){this._popup.setLatLng(a.latlng)}});b.LayerGroup=b.Class.extend({initialize:function(a){this._layers=
{};var b,c;if(a){b=0;for(c=a.length;b<c;b++)this.addLayer(a[b])}},addLayer:function(a){this._layers[this.getLayerId(a)]=a;this._map&&this._map.addLayer(a);return this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]);delete this._layers[a];return this},hasLayer:function(a){if(!a)return!1;return a in this._layers||this.getLayerId(a)in this._layers},clearLayers:function(){this.eachLayer(this.removeLayer,this);return this},
invoke:function(a){var b=Array.prototype.slice.call(arguments,1),c,d;for(c in this._layers)d=this._layers[c],d[a]&&d[a].apply(d,b);return this},onAdd:function(a){this._map=a;this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a);this._map=null},addTo:function(a){a.addLayer(this);return this},eachLayer:function(a,b){for(var c in this._layers)a.call(b,this._layers[c]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[],b;for(b in this._layers)a.push(this._layers[b]);
return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return b.stamp(a)}});b.layerGroup=function(a){return new b.LayerGroup(a)};b.FeatureGroup=b.LayerGroup.extend({includes:b.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(a){if(this.hasLayer(a))return this;if("on"in a)a.on(b.FeatureGroup.EVENTS,this._propagateEvent,this);b.LayerGroup.prototype.addLayer.call(this,a);this._popupContent&&
a.bindPopup&&a.bindPopup(this._popupContent,this._popupOptions);return this.fire("layeradd",{layer:a})},removeLayer:function(a){if(!this.hasLayer(a))return this;a in this._layers&&(a=this._layers[a]);a.off(b.FeatureGroup.EVENTS,this._propagateEvent,this);b.LayerGroup.prototype.removeLayer.call(this,a);this._popupContent&&this.invoke("unbindPopup");return this.fire("layerremove",{layer:a})},bindPopup:function(a,b){this._popupContent=a;this._popupOptions=b;return this.invoke("bindPopup",a,b)},openPopup:function(a){for(var b in this._layers){this._layers[b].openPopup(a);
break}return this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new b.LatLngBounds;this.eachLayer(function(e){a.extend(e instanceof b.Marker?e.getLatLng():e.getBounds())});return a},_propagateEvent:function(a){a=b.extend({layer:a.target,target:this},a);this.fire(a.type,a)}});b.featureGroup=function(a){return new b.FeatureGroup(a)};b.Path=b.Class.extend({includes:[b.Mixin.Events],
statics:{CLIP_PADDING:Math.max(0,Math.min(0.5,((b.Browser.mobile?1280:2E3)/Math.max(c.outerWidth,c.outerHeight)-1)/2))},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:0.5,fill:!1,fillColor:null,fillOpacity:0.2,clickable:!0},initialize:function(a){b.setOptions(this,a)},onAdd:function(a){this._map=a;this._container||(this._initElements(),this._initEvents());this.projectLatlngs();this._updatePath();this._container&&this._map._pathRoot.appendChild(this._container);
this.fire("add");a.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(a){a.addLayer(this);return this},onRemove:function(a){a._pathRoot.removeChild(this._container);this.fire("remove");this._map=null;if(b.Browser.vml)this._fill=this._stroke=this._container=null;a.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(a){b.setOptions(this,a);this._container&&this._updateStyle();return this},redraw:function(){this._map&&
(this.projectLatlngs(),this._updatePath());return this}});b.Map.include({_updatePathViewport:function(){var a=b.Path.CLIP_PADDING,e=this.getSize(),c=b.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(e.multiplyBy(a)._round()),a=c.add(e.multiplyBy(1+a*2)._round());this._pathViewport=new b.Bounds(c,a)}});b.Path.SVG_NS="http://www.w3.org/2000/svg";b.Browser.svg=!(!f.createElementNS||!f.createElementNS(b.Path.SVG_NS,"svg").createSVGRect);b.Path=b.Path.extend({statics:{SVG:b.Browser.svg},bringToFront:function(){var a=
this._map._pathRoot,b=this._container;b&&a.lastChild!==b&&a.appendChild(b);return this},bringToBack:function(){var a=this._map._pathRoot,b=this._container,c=a.firstChild;b&&c!==b&&a.insertBefore(b,c);return this},getPathString:function(){},_createElement:function(a){return f.createElementNS(b.Path.SVG_NS,a)},_initElements:function(){this._map._initPathRoot();this._initPath();this._initStyle()},_initPath:function(){this._container=this._createElement("g");this._path=this._createElement("path");this.options.className&&
b.DomUtil.addClass(this._path,this.options.className);this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round"));this.options.fill&&this._path.setAttribute("fill-rule","evenodd");this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents);!this.options.clickable&&!this.options.pointerEvents&&this._path.setAttribute("pointer-events","none");
this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",
this.options.lineJoin)):this._path.setAttribute("stroke","none");this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var a=this.getPathString();a||(a="M0 0");this._path.setAttribute("d",a)},_initEvents:function(){if(this.options.clickable){(b.Browser.svg||!b.Browser.vml)&&b.DomUtil.addClass(this._path,"leaflet-clickable");b.DomEvent.on(this._container,
"click",this._onMouseClick,this);for(var a=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<a.length;e++)b.DomEvent.on(this._container,a[e],this._fireMouseEvent,this)}},_onMouseClick:function(a){(!this._map.dragging||!this._map.dragging.moved())&&this._fireMouseEvent(a)},_fireMouseEvent:function(a){if(this.hasEventListeners(a.type)){var e=this._map,c=e.mouseEventToContainerPoint(a),d=e.containerPointToLayerPoint(c),e=e.layerPointToLatLng(d);this.fire(a.type,{latlng:e,
layerPoint:d,containerPoint:c,originalEvent:a});a.type==="contextmenu"&&b.DomEvent.preventDefault(a);a.type!=="mousemove"&&b.DomEvent.stopPropagation(a)}}});b.Map.include({_initPathRoot:function(){if(!this._pathRoot)this._pathRoot=b.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&b.Browser.any3d?(b.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):b.DomUtil.addClass(this._pathRoot,
"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport()},_animatePathZoom:function(a){var e=this.getZoomScale(a.zoom),a=this._getCenterOffset(a.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[b.DomUtil.TRANSFORM]=b.DomUtil.getTranslateString(a)+" scale("+e+") ";this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,e=a.min,
c=a.max,a=c.x-e.x,c=c.y-e.y,d=this._pathRoot,f=this._panes.overlayPane;b.Browser.mobileWebkit&&f.removeChild(d);b.DomUtil.setPosition(d,e);d.setAttribute("width",a);d.setAttribute("height",c);d.setAttribute("viewBox",[e.x,e.y,a,c].join(" "));b.Browser.mobileWebkit&&f.appendChild(d)}}});b.Path.include({bindPopup:function(a,e){if(a instanceof b.Popup)this._popup=a;else{if(!this._popup||e)this._popup=new b.Popup(e,this);this._popup.setContent(a)}if(!this._popupHandlersAdded)this.on("click",this._openPopup,
this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0;return this},unbindPopup:function(){if(this._popup)this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1;return this},openPopup:function(a){this._popup&&(a=a||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:a}));return this},closePopup:function(){this._popup&&this._popup._close();return this},_openPopup:function(a){this._popup.setLatLng(a.latlng);
this._map.openPopup(this._popup)}});b.Browser.vml=!b.Browser.svg&&function(){try{var a=f.createElement("div");a.innerHTML='<v:shape adj="1"/>';var b=a.firstChild;b.style.behavior="url(#default#VML)";return b&&typeof b.adj==="object"}catch(c){return!1}}();b.Path=b.Browser.svg||!b.Browser.vml?b.Path:b.Path.extend({statics:{VML:!0,CLIP_PADDING:0.02},_createElement:function(){try{return f.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return f.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return f.createElement("<"+
a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var a=this._container=this._createElement("shape");b.DomUtil.addClass(a,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:""));this.options.clickable&&b.DomUtil.addClass(a,"leaflet-clickable");a.coordsize="1 1";this._path=this._createElement("path");a.appendChild(this._path);this._map._pathRoot.appendChild(a)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var a=this._stroke,
e=this._fill,c=this.options,d=this._container;d.stroked=c.stroke;d.filled=c.fill;if(c.stroke){if(!a)a=this._stroke=this._createElement("stroke"),a.endcap="round",d.appendChild(a);a.weight=c.weight+"px";a.color=c.color;a.opacity=c.opacity;a.dashStyle=c.dashArray?b.Util.isArray(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):"";if(c.lineCap)a.endcap=c.lineCap.replace("butt","flat");if(c.lineJoin)a.joinstyle=c.lineJoin}else if(a)d.removeChild(a),this._stroke=null;if(c.fill){if(!e)e=
this._fill=this._createElement("fill"),d.appendChild(e);e.color=c.fillColor||c.color;e.opacity=c.fillOpacity}else if(e)d.removeChild(e),this._fill=null},_updatePath:function(){var a=this._container.style;a.display="none";this._path.v=this.getPathString()+" ";a.display=""}});b.Map.include(b.Browser.svg||!b.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var a=this._pathRoot=f.createElement("div");a.className="leaflet-vml-container";this._panes.overlayPane.appendChild(a);this.on("moveend",
this._updatePathViewport);this._updatePathViewport()}}});b.Browser.canvas=!!f.createElement("canvas").getContext;b.Path=b.Path.SVG&&!c.L_PREFER_CANVAS||!b.Browser.canvas?b.Path:b.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){this._map&&(this.projectLatlngs(),this._requestUpdate());return this},setStyle:function(a){b.setOptions(this,a);this._map&&(this._updateStyle(),this._requestUpdate());return this},onRemove:function(a){a.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,
this);this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this));this._requestUpdate();this._map=null},_requestUpdate:function(){if(this._map&&!b.Path._updateRequest)b.Path._updateRequest=b.Util.requestAnimFrame(this._fireMapMoveEnd,this._map)},_fireMapMoveEnd:function(){b.Path._updateRequest=null;this.fire("moveend")},_initElements:function(){this._map._initPathRoot();this._ctx=this._map._canvasCtx},_updateStyle:function(){var a=this.options;
if(a.stroke)this._ctx.lineWidth=a.weight,this._ctx.strokeStyle=a.color;if(a.fill)this._ctx.fillStyle=a.fillColor||a.color},_drawPath:function(){var a,e,c,d,f,h;this._ctx.beginPath();a=0;for(c=this._parts.length;a<c;a++){e=0;for(d=this._parts[a].length;e<d;e++)f=this._parts[a][e],h=(e===0?"move":"line")+"To",this._ctx[h](f.x,f.y);this instanceof b.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var a=this._ctx,b=
this.options;this._drawPath();a.save();this._updateStyle();if(b.fill)a.globalAlpha=b.fillOpacity,a.fill();if(b.stroke)a.globalAlpha=b.opacity,a.stroke();a.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(a){this._containsPoint(a.layerPoint)&&this.fire("click",a)},_onMouseMove:function(a){if(this._map&&!this._map._animatingZoom)if(this._containsPoint(a.layerPoint))this._ctx.canvas.style.cursor=
"pointer",this._mouseInside=!0,this.fire("mouseover",a);else if(this._mouseInside)this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",a)}});b.Map.include(b.Path.SVG&&!c.L_PREFER_CANVAS||!b.Browser.canvas?{}:{_initPathRoot:function(){var a=this._pathRoot,b;if(!a){a=this._pathRoot=f.createElement("canvas");a.style.position="absolute";b=this._canvasCtx=a.getContext("2d");b.lineCap="round";b.lineJoin="round";this._panes.overlayPane.appendChild(a);if(this.options.zoomAnimation)this._pathRoot.className=
"leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom);this.on("moveend",this._updateCanvasViewport);this._updateCanvasViewport()}},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var a=this._pathViewport,e=a.min,a=a.max.subtract(e),c=this._pathRoot;b.DomUtil.setPosition(c,e);c.width=a.x;c.height=a.y;c.getContext("2d").translate(-e.x,-e.y)}}});b.LineUtil={simplify:function(a,b){if(!b||!a.length)return a.slice();var c=
b*b,a=this._reducePoints(a,c);return a=this._simplifyDP(a,c)},pointToSegmentDistance:function(a,b,c){return Math.sqrt(this._sqClosestPointOnSegment(a,b,c,!0))},closestPointOnSegment:function(a,b,c){return this._sqClosestPointOnSegment(a,b,c)},_simplifyDP:function(a,b){var c=a.length,d=new (typeof Uint8Array!==h+""?Uint8Array:Array)(c);d[0]=d[c-1]=1;this._simplifyDPStep(a,d,b,0,c-1);var f,i=[];for(f=0;f<c;f++)d[f]&&i.push(a[f]);return i},_simplifyDPStep:function(a,b,c,d,f){var h=0,i,p,o;for(p=d+1;p<=
f-1;p++)o=this._sqClosestPointOnSegment(a[p],a[d],a[f],!0),o>h&&(i=p,h=o);h>c&&(b[i]=1,this._simplifyDPStep(a,b,c,d,i),this._simplifyDPStep(a,b,c,i,f))},_reducePoints:function(a,b){for(var c=[a[0]],d=1,f=0,h=a.length;d<h;d++)this._sqDist(a[d],a[f])>b&&(c.push(a[d]),f=d);f<h-1&&c.push(a[h-1]);return c},clipSegment:function(a,b,c,d){var d=d?this._lastCode:this._getBitCode(a,c),f=this._getBitCode(b,c),h,i,p;for(this._lastCode=f;;)if(d|f)if(d&f)return!1;else h=d||f,i=this._getEdgeIntersection(a,b,h,c),
p=this._getBitCode(i,c),h===d?(a=i,d=p):(b=i,f=p);else return[a,b]},_getEdgeIntersection:function(a,e,c,d){var f=e.x-a.x,e=e.y-a.y,h=d.min,d=d.max;if(c&8)return new b.Point(a.x+f*(d.y-a.y)/e,d.y);else if(c&4)return new b.Point(a.x+f*(h.y-a.y)/e,h.y);else if(c&2)return new b.Point(d.x,a.y+e*(d.x-a.x)/f);else if(c&1)return new b.Point(h.x,a.y+e*(h.x-a.x)/f)},_getBitCode:function(a,b){var c=0;a.x<b.min.x?c|=1:a.x>b.max.x&&(c|=2);a.y<b.min.y?c|=4:a.y>b.max.y&&(c|=8);return c},_sqDist:function(a,b){var c=
b.x-a.x,d=b.y-a.y;return c*c+d*d},_sqClosestPointOnSegment:function(a,e,c,d){var f=e.x,e=e.y,h=c.x-f,i=c.y-e,p=h*h+i*i;if(p>0)p=((a.x-f)*h+(a.y-e)*i)/p,p>1?(f=c.x,e=c.y):p>0&&(f+=h*p,e+=i*p);h=a.x-f;i=a.y-e;return d?h*h+i*i:new b.Point(f,e)}};b.Polyline=b.Path.extend({initialize:function(a,e){b.Path.prototype.initialize.call(this,e);this._latlngs=this._convertLatLngs(a)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var a=0,b=this._latlngs.length;a<b;a++)this._originalPoints[a]=
this._map.latLngToLayerPoint(this._latlngs[a])},getPathString:function(){for(var a=0,b=this._parts.length,c="";a<b;a++)c+=this._getPathPartStr(this._parts[a]);return c},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){this._latlngs=this._convertLatLngs(a);return this.redraw()},addLatLng:function(a){this._latlngs.push(b.latLng(a));return this.redraw()},spliceLatLngs:function(){var a=[].splice.apply(this._latlngs,arguments);this._convertLatLngs(this._latlngs,!0);this.redraw();return a},
closestLayerPoint:function(a){for(var e=Infinity,c=this._parts,d,f,h=null,i=0,p=c.length;i<p;i++)for(var o=c[i],n=1,r=o.length;n<r;n++){d=o[n-1];f=o[n];var s=b.LineUtil._sqClosestPointOnSegment(a,d,f,!0);s<e&&(e=s,h=b.LineUtil._sqClosestPointOnSegment(a,d,f))}if(h)h.distance=Math.sqrt(e);return h},getBounds:function(){return new b.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(a,e){var c,d,f=e?a:[];c=0;for(d=a.length;c<d;c++){if(b.Util.isArray(a[c])&&typeof a[c][0]!=="number")return;f[c]=
b.latLng(a[c])}return f},_initEvents:function(){b.Path.prototype._initEvents.call(this)},_getPathPartStr:function(a){for(var e=b.Path.VML,c=0,d=a.length,f="",h;c<d;c++)h=a[c],e&&h._round(),f+=(c?"L":"M")+h.x+" "+h.y;return f},_clipPoints:function(){var a=this._originalPoints,c=a.length,g,d,f;if(this.options.noClip)this._parts=[a];else{var h=this._parts=[],i=this._map._pathViewport,p=b.LineUtil;for(d=g=0;g<c-1;g++)if(f=p.clipSegment(a[g],a[g+1],i,g))if(h[d]=h[d]||[],h[d].push(f[0]),f[1]!==a[g+1]||
g===c-2)h[d].push(f[1]),d++}},_simplifyPoints:function(){for(var a=this._parts,c=b.LineUtil,g=0,d=a.length;g<d;g++)a[g]=c.simplify(a[g],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),b.Path.prototype._updatePath.call(this))}});b.polyline=function(a,c){return new b.Polyline(a,c)};b.PolyUtil={};b.PolyUtil.clipPolygon=function(a,c){var g,d=[1,4,2,8],f,h,i,p,o,n,r=b.LineUtil;f=0;for(o=a.length;f<o;f++)a[f]._code=r._getBitCode(a[f],c);for(i=0;i<
4;i++){n=d[i];g=[];f=0;o=a.length;for(h=o-1;f<o;h=f++)if(p=a[f],h=a[h],p._code&n){if(!(h._code&n))h=r._getEdgeIntersection(h,p,n,c),h._code=r._getBitCode(h,c),g.push(h)}else{if(h._code&n)h=r._getEdgeIntersection(h,p,n,c),h._code=r._getBitCode(h,c),g.push(h);g.push(p)}a=g}return a};b.Polygon=b.Polyline.extend({options:{fill:!0},initialize:function(a,c){b.Polyline.prototype.initialize.call(this,a,c);this._initWithHoles(a)},_initWithHoles:function(a){var c,g;if(a&&b.Util.isArray(a[0])&&typeof a[0][0]!==
"number"){this._latlngs=this._convertLatLngs(a[0]);this._holes=a.slice(1);a=0;for(c=this._holes.length;a<c;a++)g=this._holes[a]=this._convertLatLngs(this._holes[a]),g[0].equals(g[g.length-1])&&g.pop()}a=this._latlngs;a.length>=2&&a[0].equals(a[a.length-1])&&a.pop()},projectLatlngs:function(){b.Polyline.prototype.projectLatlngs.call(this);this._holePoints=[];if(this._holes){var a,c,g,d;a=0;for(g=this._holes.length;a<g;a++){this._holePoints[a]=[];c=0;for(d=this._holes[a].length;c<d;c++)this._holePoints[a][c]=
this._map.latLngToLayerPoint(this._holes[a][c])}}},setLatLngs:function(a){return a&&b.Util.isArray(a[0])&&typeof a[0][0]!=="number"?(this._initWithHoles(a),this.redraw()):b.Polyline.prototype.setLatLngs.call(this,a)},_clipPoints:function(){var a=[];this._parts=[this._originalPoints].concat(this._holePoints);if(!this.options.noClip){for(var c=0,g=this._parts.length;c<g;c++){var d=b.PolyUtil.clipPolygon(this._parts[c],this._map._pathViewport);d.length&&a.push(d)}this._parts=a}},_getPathPartStr:function(a){return b.Polyline.prototype._getPathPartStr.call(this,
a)+(b.Browser.svg?"z":"x")}});b.polygon=function(a,c){return new b.Polygon(a,c)};(function(){function a(a){return b.FeatureGroup.extend({initialize:function(a,b){this._layers={};this._options=b;this.setLatLngs(a)},setLatLngs:function(b){var c=0,d=b.length;for(this.eachLayer(function(a){c<d?a.setLatLngs(b[c++]):this.removeLayer(a)},this);c<d;)this.addLayer(new a(b[c++],this._options));return this},getLatLngs:function(){var a=[];this.eachLayer(function(b){a.push(b.getLatLngs())});return a}})}b.MultiPolyline=
a(b.Polyline);b.MultiPolygon=a(b.Polygon);b.multiPolyline=function(a,c){return new b.MultiPolyline(a,c)};b.multiPolygon=function(a,c){return new b.MultiPolygon(a,c)}})();b.Rectangle=b.Polygon.extend({initialize:function(a,c){b.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(a),c)},setBounds:function(a){this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){a=b.latLngBounds(a);return[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});b.rectangle=function(a,
c){return new b.Rectangle(a,c)};b.Circle=b.Path.extend({initialize:function(a,c,g){b.Path.prototype.initialize.call(this,g);this._latlng=b.latLng(a);this._mRadius=c},options:{fill:!0},setLatLng:function(a){this._latlng=b.latLng(a);return this.redraw()},setRadius:function(a){this._mRadius=a;return this.redraw()},projectLatlngs:function(){var a=this._getLngRadius(),b=this._latlng,a=this._map.latLngToLayerPoint([b.lat,b.lng-a]);this._point=this._map.latLngToLayerPoint(b);this._radius=Math.max(this._point.x-
a.x,1)},getBounds:function(){var a=this._getLngRadius(),c=this._mRadius/40075017*360,g=this._latlng;return new b.LatLngBounds([g.lat-c,g.lng-a],[g.lat+c,g.lng+a])},getLatLng:function(){return this._latlng},getPathString:function(){var a=this._point,c=this._radius;if(this._checkIfEmpty())return"";return b.Browser.svg?"M"+a.x+","+(a.y-c)+"A"+c+","+c+",0,1,1,"+(a.x-0.1)+","+(a.y-c)+" z":(a._round(),c=Math.round(c),"AL "+a.x+","+a.y+" "+c+","+c+" 0,23592600")},getRadius:function(){return this._mRadius},
_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(b.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var a=this._map._pathViewport,b=this._radius,c=this._point;return c.x-b>a.max.x||c.y-b>a.max.y||c.x+b<a.min.x||c.y+b<a.min.y}});b.circle=function(a,c,g){return new b.Circle(a,c,g)};b.CircleMarker=b.Circle.extend({options:{radius:10,weight:2},initialize:function(a,c){b.Circle.prototype.initialize.call(this,
a,null,c);this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){b.Circle.prototype._updateStyle.call(this);this.setRadius(this.options.radius)},setLatLng:function(a){b.Circle.prototype.setLatLng.call(this,a);this._popup&&this._popup._isOpen&&this._popup.setLatLng(a);return this},setRadius:function(a){this.options.radius=this._radius=a;return this.redraw()},getRadius:function(){return this._radius}});b.circleMarker=
function(a,c){return new b.CircleMarker(a,c)};b.Polyline.include(!b.Path.CANVAS?{}:{_containsPoint:function(a,c){var g,d,f,h,i,p,o=this.options.weight/2;b.Browser.touch&&(o+=10);g=0;for(h=this._parts.length;g<h;g++){p=this._parts[g];d=0;i=p.length;for(f=i-1;d<i;f=d++)if(c||d!==0)if(f=b.LineUtil.pointToSegmentDistance(a,p[f],p[d]),f<=o)return!0}return!1}});b.Polygon.include(!b.Path.CANVAS?{}:{_containsPoint:function(a){var c=!1,g,d,f,h,i,p,o;if(b.Polyline.prototype._containsPoint.call(this,a,!0))return!0;
h=0;for(p=this._parts.length;h<p;h++){g=this._parts[h];i=0;o=g.length;for(f=o-1;i<o;f=i++)d=g[i],f=g[f],d.y>a.y!==f.y>a.y&&a.x<(f.x-d.x)*(a.y-d.y)/(f.y-d.y)+d.x&&(c=!c)}return c}});b.Circle.include(!b.Path.CANVAS?{}:{_drawPath:function(){var a=this._point;this._ctx.beginPath();this._ctx.arc(a.x,a.y,this._radius,0,Math.PI*2,!1)},_containsPoint:function(a){var b=this.options.stroke?this.options.weight/2:0;return a.distanceTo(this._point)<=this._radius+b}});b.CircleMarker.include(!b.Path.CANVAS?{}:{_updateStyle:function(){b.Path.prototype._updateStyle.call(this)}});
b.GeoJSON=b.FeatureGroup.extend({initialize:function(a,c){b.setOptions(this,c);this._layers={};a&&this.addData(a)},addData:function(a){var c=b.Util.isArray(a)?a:a.features,g,d;if(c){a=0;for(g=c.length;a<g;a++)d=c[a],(d.geometries||d.geometry||d.features||d.coordinates)&&this.addData(c[a]);return this}c=this.options;if(!c.filter||c.filter(a)){g=b.GeoJSON.geometryToLayer(a,c.pointToLayer,c.coordsToLatLng,c);g.feature=b.GeoJSON.asFeature(a);g.defaultOptions=g.options;this.resetStyle(g);if(c.onEachFeature)c.onEachFeature(a,
g);return this.addLayer(g)}},resetStyle:function(a){var c=this.options.style;c&&(b.Util.extend(a.options,a.defaultOptions),this._setLayerStyle(a,c))},setStyle:function(a){this.eachLayer(function(b){this._setLayerStyle(b,a)},this)},_setLayerStyle:function(a,b){typeof b==="function"&&(b=b(a.feature));a.setStyle&&a.setStyle(b)}});b.extend(b.GeoJSON,{geometryToLayer:function(a,c,g,d){var f=a.type==="Feature"?a.geometry:a,h=f.coordinates,i=[],p,o,g=g||this.coordsToLatLng;switch(f.type){case "Point":return d=
g(h),c?c(a,d):new b.Marker(d);case "MultiPoint":p=0;for(o=h.length;p<o;p++)d=g(h[p]),i.push(c?c(a,d):new b.Marker(d));return new b.FeatureGroup(i);case "LineString":return a=this.coordsToLatLngs(h,0,g),new b.Polyline(a,d);case "Polygon":if(h.length===2&&!h[1].length)throw Error("Invalid GeoJSON object.");a=this.coordsToLatLngs(h,1,g);return new b.Polygon(a,d);case "MultiLineString":return a=this.coordsToLatLngs(h,1,g),new b.MultiPolyline(a,d);case "MultiPolygon":return a=this.coordsToLatLngs(h,2,
g),new b.MultiPolygon(a,d);case "GeometryCollection":p=0;for(o=f.geometries.length;p<o;p++)i.push(this.geometryToLayer({geometry:f.geometries[p],type:"Feature",properties:a.properties},c,g,d));return new b.FeatureGroup(i);default:throw Error("Invalid GeoJSON object.");}},coordsToLatLng:function(a){return new b.LatLng(a[1],a[0],a[2])},coordsToLatLngs:function(a,b,c){var d,f,h,i=[];f=0;for(h=a.length;f<h;f++)d=b?this.coordsToLatLngs(a[f],b-1,c):(c||this.coordsToLatLng)(a[f]),i.push(d);return i},latLngToCoords:function(a){var b=
[a.lng,a.lat];a.alt!==h&&b.push(a.alt);return b},latLngsToCoords:function(a){for(var c=[],g=0,d=a.length;g<d;g++)c.push(b.GeoJSON.latLngToCoords(a[g]));return c},getFeature:function(a,c){return a.feature?b.extend({},a.feature,{geometry:c}):b.GeoJSON.asFeature(c)},asFeature:function(a){if(a.type==="Feature")return a;return{type:"Feature",properties:{},geometry:a}}});var d={toGeoJSON:function(){return b.GeoJSON.getFeature(this,{type:"Point",coordinates:b.GeoJSON.latLngToCoords(this.getLatLng())})}};
b.Marker.include(d);b.Circle.include(d);b.CircleMarker.include(d);b.Polyline.include({toGeoJSON:function(){return b.GeoJSON.getFeature(this,{type:"LineString",coordinates:b.GeoJSON.latLngsToCoords(this.getLatLngs())})}});b.Polygon.include({toGeoJSON:function(){var a=[b.GeoJSON.latLngsToCoords(this.getLatLngs())],c,g,d;a[0].push(a[0][0]);if(this._holes){c=0;for(g=this._holes.length;c<g;c++)d=b.GeoJSON.latLngsToCoords(this._holes[c]),d.push(d[0]),a.push(d)}return b.GeoJSON.getFeature(this,{type:"Polygon",
coordinates:a})}});(function(){function a(a){return function(){var c=[];this.eachLayer(function(a){c.push(a.toGeoJSON().geometry.coordinates)});return b.GeoJSON.getFeature(this,{type:a,coordinates:c})}}b.MultiPolyline.include({toGeoJSON:a("MultiLineString")});b.MultiPolygon.include({toGeoJSON:a("MultiPolygon")});b.LayerGroup.include({toGeoJSON:function(){var c=this.feature&&this.feature.geometry,g=[],d;if(c&&c.type==="MultiPoint")return a("MultiPoint").call(this);var f=c&&c.type==="GeometryCollection";
this.eachLayer(function(a){a.toGeoJSON&&(d=a.toGeoJSON(),g.push(f?d.geometry:b.GeoJSON.asFeature(d)))});if(f)return b.GeoJSON.getFeature(this,{geometries:g,type:"GeometryCollection"});return{type:"FeatureCollection",features:g}}})})();b.geoJson=function(a,c){return new b.GeoJSON(a,c)};b.DomEvent={addListener:function(a,c,g,d){var f=b.stamp(g),h="_leaflet_"+c+f,i,p;if(a[h])return this;i=function(c){return g.call(d||a,c||b.DomEvent._getEvent())};if(b.Browser.pointer&&c.indexOf("touch")===0)return this.addPointerListener(a,
c,i,f);b.Browser.touch&&c==="dblclick"&&this.addDoubleTapListener&&this.addDoubleTapListener(a,i,f);"addEventListener"in a?c==="mousewheel"?(a.addEventListener("DOMMouseScroll",i,!1),a.addEventListener(c,i,!1)):c==="mouseenter"||c==="mouseleave"?(p=i,i=function(c){if(b.DomEvent._checkMouse(a,c))return p(c)},a.addEventListener(c==="mouseenter"?"mouseover":"mouseout",i,!1)):(c==="click"&&b.Browser.android&&(p=i,i=function(a){return b.DomEvent._filterClick(a,p)}),a.addEventListener(c,i,!1)):"attachEvent"in
a&&a.attachEvent("on"+c,i);a[h]=i;return this},removeListener:function(a,c,g){var g=b.stamp(g),d="_leaflet_"+c+g,f=a[d];if(!f)return this;b.Browser.pointer&&c.indexOf("touch")===0?this.removePointerListener(a,c,g):b.Browser.touch&&c==="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(a,g):"removeEventListener"in a?c==="mousewheel"?(a.removeEventListener("DOMMouseScroll",f,!1),a.removeEventListener(c,f,!1)):c==="mouseenter"||c==="mouseleave"?a.removeEventListener(c==="mouseenter"?
"mouseover":"mouseout",f,!1):a.removeEventListener(c,f,!1):"detachEvent"in a&&a.detachEvent("on"+c,f);a[d]=null;return this},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;b.DomEvent._skipped(a);return this},disableScrollPropagation:function(a){var c=b.DomEvent.stopPropagation;return b.DomEvent.on(a,"mousewheel",c).on(a,"MozMousePixelScroll",c)},disableClickPropagation:function(a){for(var c=b.DomEvent.stopPropagation,g=b.Draggable.START.length-1;g>=0;g--)b.DomEvent.on(a,
b.Draggable.START[g],c);return b.DomEvent.on(a,"click",b.DomEvent._fakeStop).on(a,"dblclick",c)},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this},stop:function(a){return b.DomEvent.preventDefault(a).stopPropagation(a)},getMousePosition:function(a,c){if(!c)return new b.Point(a.clientX,a.clientY);var g=c.getBoundingClientRect();return new b.Point(a.clientX-g.left-c.clientLeft,a.clientY-g.top-c.clientTop)},getWheelDelta:function(a){var b=0;a.wheelDelta&&(b=
a.wheelDelta/120);a.detail&&(b=-a.detail/3);return b},_skipEvents:{},_fakeStop:function(a){b.DomEvent._skipEvents[a.type]=!0},_skipped:function(a){var b=this._skipEvents[a.type];this._skipEvents[a.type]=!1;return b},_checkMouse:function(a,b){var c=b.relatedTarget;if(!c)return!0;try{for(;c&&c!==a;)c=c.parentNode}catch(d){return!1}return c!==a},_getEvent:function(){var a=c.event;if(!a)for(var b=arguments.callee.caller;b;){if((a=b.arguments[0])&&c.Event===a.constructor)break;b=b.caller}return a},_filterClick:function(a,
c){var g=a.timeStamp||a.originalEvent.timeStamp,d=b.DomEvent._lastClick&&g-b.DomEvent._lastClick;if(d&&d>100&&d<1E3||a.target._simulatedClick&&!a._simulated)b.DomEvent.stop(a);else return b.DomEvent._lastClick=g,c(a)}};b.DomEvent.on=b.DomEvent.addListener;b.DomEvent.off=b.DomEvent.removeListener;b.Draggable=b.Class.extend({includes:b.Mixin.Events,statics:{START:b.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},
MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(a,b){this._element=a;this._dragStartTarget=b||a},enable:function(){if(!this._enabled){for(var a=b.Draggable.START.length-1;a>=0;a--)b.DomEvent.on(this._dragStartTarget,b.Draggable.START[a],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var a=b.Draggable.START.length-1;a>=0;a--)b.DomEvent.off(this._dragStartTarget,b.Draggable.START[a],this._onDown,
this);this._moved=this._enabled=!1}},_onDown:function(a){this._moved=!1;if(!(a.shiftKey||a.which!==1&&a.button!==1&&!a.touches))if(b.DomEvent.stopPropagation(a),!b.Draggable._disabled&&(b.DomUtil.disableImageDrag(),b.DomUtil.disableTextSelection(),!this._moving)){var c=a.touches?a.touches[0]:a;this._startPoint=new b.Point(c.clientX,c.clientY);this._startPos=this._newPos=b.DomUtil.getPosition(this._element);b.DomEvent.on(f,b.Draggable.MOVE[a.type],this._onMove,this).on(f,b.Draggable.END[a.type],this._onUp,
this)}},_onMove:function(a){if(a.touches&&a.touches.length>1)this._moved=!0;else{var c=a.touches&&a.touches.length===1?a.touches[0]:a,c=(new b.Point(c.clientX,c.clientY)).subtract(this._startPoint);if(c.x||c.y){b.DomEvent.preventDefault(a);if(!this._moved)this.fire("dragstart"),this._moved=!0,this._startPos=b.DomUtil.getPosition(this._element).subtract(c),b.DomUtil.addClass(f.body,"leaflet-dragging"),b.DomUtil.addClass(a.target||a.srcElement,"leaflet-drag-target");this._newPos=this._startPos.add(c);
this._moving=!0;b.Util.cancelAnimFrame(this._animRequest);this._animRequest=b.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)}}},_updatePosition:function(){this.fire("predrag");b.DomUtil.setPosition(this._element,this._newPos);this.fire("drag")},_onUp:function(a){b.DomUtil.removeClass(f.body,"leaflet-dragging");b.DomUtil.removeClass(a.target||a.srcElement,"leaflet-drag-target");for(var c in b.Draggable.MOVE)b.DomEvent.off(f,b.Draggable.MOVE[c],this._onMove).off(f,b.Draggable.END[c],
this._onUp);b.DomUtil.enableImageDrag();b.DomUtil.enableTextSelection();this._moved&&this._moving&&(b.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1}});b.Handler=b.Class.extend({initialize:function(a){this._map=a},enable:function(){if(!this._enabled)this._enabled=!0,this.addHooks()},disable:function(){if(this._enabled)this._enabled=!1,this.removeHooks()},enabled:function(){return!!this._enabled}});b.Map.mergeOptions({dragging:!0,
inertia:!b.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,inertiaThreshold:b.Browser.touch?32:18,easeLinearity:0.25,worldCopyJump:!1});b.Map.Drag=b.Handler.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new b.Draggable(a._mapPane,a._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),a.on("viewreset",this._onViewReset,
this),a.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var a=this._map;a._panAnim&&a._panAnim.stop();a.fire("movestart").fire("dragstart");if(a.options.inertia)this._positions=[],this._times=[]},_onDrag:function(){if(this._map.options.inertia){var a=this._lastTime=+new Date;this._positions.push(this._lastPos=this._draggable._newPos);this._times.push(a);
a-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var a=this._map.getSize()._divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var a=this._worldWidth,b=Math.round(a/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,f=(d-b+c)%a+b-c,a=(d+b+c)%a-b-c;this._draggable._newPos.x=Math.abs(f+c)<Math.abs(a+c)?f:a},_onDragEnd:function(a){var c=
this._map,g=c.options,d=+new Date-this._lastTime,f=!g.inertia||d>g.inertiaThreshold||!this._positions[0];c.fire("dragend",a);if(f)c.fire("moveend");else{var a=this._lastPos.subtract(this._positions[0]),h=g.easeLinearity,a=a.multiplyBy(h/((this._lastTime+d-this._times[0])/1E3)),f=a.distanceTo([0,0]),d=Math.min(g.inertiaMaxSpeed,f),a=a.multiplyBy(d/f),i=d/(g.inertiaDeceleration*h),p=a.multiplyBy(-i/2).round();!p.x||!p.y?c.fire("moveend"):(p=c._limitOffset(p,c.options.maxBounds),b.Util.requestAnimFrame(function(){c.panBy(p,
{duration:i,easeLinearity:h,noMoveStart:!0})}))}}});b.Map.addInitHook("addHandler","dragging",b.Map.Drag);b.Map.mergeOptions({doubleClickZoom:!0});b.Map.DoubleClickZoom=b.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var b=this._map,c=b.getZoom()+(a.originalEvent.shiftKey?-1:1);b.options.doubleClickZoom==="center"?b.setZoom(c):b.setZoomAround(a.containerPoint,
c)}});b.Map.addInitHook("addHandler","doubleClickZoom",b.Map.DoubleClickZoom);b.Map.mergeOptions({scrollWheelZoom:!0});b.Map.ScrollWheelZoom=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this);b.DomEvent.on(this._map._container,"MozMousePixelScroll",b.DomEvent.preventDefault);this._delta=0},removeHooks:function(){b.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll);b.DomEvent.off(this._map._container,"MozMousePixelScroll",
b.DomEvent.preventDefault)},_onWheelScroll:function(a){this._delta+=b.DomEvent.getWheelDelta(a);this._lastMousePos=this._map.mouseEventToContainerPoint(a);if(!this._startTime)this._startTime=+new Date;var c=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(b.bind(this._performZoom,this),c);b.DomEvent.preventDefault(a);b.DomEvent.stopPropagation(a)},_performZoom:function(){var a=this._map,b=this._delta,c=a.getZoom(),b=b>0?Math.ceil(b):Math.floor(b),b=Math.max(Math.min(b,
4),-4),b=a._limitZoom(c+b)-c;this._delta=0;this._startTime=null;b&&(a.options.scrollWheelZoom==="center"?a.setZoom(c+b):a.setZoomAround(this._lastMousePos,c+b))}});b.Map.addInitHook("addHandler","scrollWheelZoom",b.Map.ScrollWheelZoom);b.extend(b.DomEvent,{_touchstart:b.Browser.msPointer?"MSPointerDown":b.Browser.pointer?"pointerdown":"touchstart",_touchend:b.Browser.msPointer?"MSPointerUp":b.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(a,c,g){function d(a){var c;b.Browser.pointer?
(s.push(a.pointerId),c=s.length):c=a.touches.length;if(!(c>1)){c=Date.now();var e=c-(i||c);o=a.touches?a.touches[0]:a;k=e>0&&e<=p;i=c}}function h(a){if(b.Browser.pointer){a=s.indexOf(a.pointerId);if(a===-1)return;s.splice(a,1)}if(k){if(b.Browser.pointer){var a={},g,d;for(d in o)g=o[d],a[d]=typeof g==="function"?g.bind(o):g;o=a}o.type="dblclick";c(o);i=null}}var i,k=!1,p=250,o,n=this._touchstart,r=this._touchend,s=[];a["_leaflet_"+n+g]=d;a["_leaflet_"+r+g]=h;g=b.Browser.pointer?f.documentElement:a;
a.addEventListener(n,d,!1);g.addEventListener(r,h,!1);b.Browser.pointer&&g.addEventListener(b.DomEvent.POINTER_CANCEL,h,!1);return this},removeDoubleTapListener:function(a,c){a.removeEventListener(this._touchstart,a["_leaflet_"+this._touchstart+c],!1);(b.Browser.pointer?f.documentElement:a).removeEventListener(this._touchend,a["_leaflet_"+this._touchend+c],!1);b.Browser.pointer&&f.documentElement.removeEventListener(b.DomEvent.POINTER_CANCEL,a["_leaflet_"+this._touchend+c],!1);return this}});b.extend(b.DomEvent,
{POINTER_DOWN:b.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:b.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:b.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:b.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(a,b,c,d){switch(b){case "touchstart":return this.addPointerListenerStart(a,b,c,d);case "touchend":return this.addPointerListenerEnd(a,b,c,d);case "touchmove":return this.addPointerListenerMove(a,
b,c,d);default:throw"Unknown touch event type";}},addPointerListenerStart:function(a,c,g,d){var h=this._pointers,c=function(a){b.DomEvent.preventDefault(a);for(var c=!1,e=0;e<h.length;e++)if(h[e].pointerId===a.pointerId){c=!0;break}c||h.push(a);a.touches=h.slice();a.changedTouches=[a];g(a)};a["_leaflet_touchstart"+d]=c;a.addEventListener(this.POINTER_DOWN,c,!1);if(!this._pointerDocumentListener)a=function(a){for(var b=0;b<h.length;b++)if(h[b].pointerId===a.pointerId){h.splice(b,1);break}},f.documentElement.addEventListener(this.POINTER_UP,
a,!1),f.documentElement.addEventListener(this.POINTER_CANCEL,a,!1),this._pointerDocumentListener=!0;return this},addPointerListenerMove:function(a,b,c,d){function f(a){if(!((a.pointerType===a.MSPOINTER_TYPE_MOUSE||a.pointerType==="mouse")&&a.buttons===0)){for(var b=0;b<h.length;b++)if(h[b].pointerId===a.pointerId){h[b]=a;break}a.touches=h.slice();a.changedTouches=[a];c(a)}}var h=this._pointers;a["_leaflet_touchmove"+d]=f;a.addEventListener(this.POINTER_MOVE,f,!1);return this},addPointerListenerEnd:function(a,
b,c,d){var f=this._pointers,b=function(a){for(var b=0;b<f.length;b++)if(f[b].pointerId===a.pointerId){f.splice(b,1);break}a.touches=f.slice();a.changedTouches=[a];c(a)};a["_leaflet_touchend"+d]=b;a.addEventListener(this.POINTER_UP,b,!1);a.addEventListener(this.POINTER_CANCEL,b,!1);return this},removePointerListener:function(a,b,c){c=a["_leaflet_"+b+c];switch(b){case "touchstart":a.removeEventListener(this.POINTER_DOWN,c,!1);break;case "touchmove":a.removeEventListener(this.POINTER_MOVE,c,!1);break;
case "touchend":a.removeEventListener(this.POINTER_UP,c,!1),a.removeEventListener(this.POINTER_CANCEL,c,!1)}return this}});b.Map.mergeOptions({touchZoom:b.Browser.touch&&!b.Browser.android23,bounceAtZoomLimits:!0});b.Map.TouchZoom=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){b.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(a.touches&&!(a.touches.length!==
2||c._animatingZoom||this._zooming)){var g=c.mouseEventToLayerPoint(a.touches[0]),d=c.mouseEventToLayerPoint(a.touches[1]),h=c._getCenterLayerPoint();this._startCenter=g.add(d)._divideBy(2);this._startDist=g.distanceTo(d);this._moved=!1;this._zooming=!0;this._centerOffset=h.subtract(this._startCenter);c._panAnim&&c._panAnim.stop();b.DomEvent.on(f,"touchmove",this._onTouchMove,this).on(f,"touchend",this._onTouchEnd,this);b.DomEvent.preventDefault(a)}},_onTouchMove:function(a){var c=this._map;if(a.touches&&
a.touches.length===2&&this._zooming){var g=c.mouseEventToLayerPoint(a.touches[0]),d=c.mouseEventToLayerPoint(a.touches[1]);this._scale=g.distanceTo(d)/this._startDist;this._delta=g._add(d)._divideBy(2)._subtract(this._startCenter);if(this._scale!==1&&(c.options.bounceAtZoomLimits||!(c.getZoom()===c.getMinZoom()&&this._scale<1||c.getZoom()===c.getMaxZoom()&&this._scale>1))){if(!this._moved)b.DomUtil.addClass(c._mapPane,"leaflet-touching"),c.fire("movestart").fire("zoomstart"),this._moved=!0;b.Util.cancelAnimFrame(this._animRequest);
this._animRequest=b.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container);b.DomEvent.preventDefault(a)}}},_updateOnMove:function(){var a=this._map,b=this._getScaleOrigin(),b=a.layerPointToLatLng(b),c=a.getScaleZoom(this._scale);a._animateZoom(b,c,this._startCenter,this._scale,this._delta)},_onTouchEnd:function(){if(!this._moved||!this._zooming)this._zooming=!1;else{var a=this._map;this._zooming=!1;b.DomUtil.removeClass(a._mapPane,"leaflet-touching");b.Util.cancelAnimFrame(this._animRequest);
b.DomEvent.off(f,"touchmove",this._onTouchMove).off(f,"touchend",this._onTouchEnd);var c=this._getScaleOrigin(),g=a.layerPointToLatLng(c),d=a.getZoom(),h=a.getScaleZoom(this._scale)-d,d=a._limitZoom(d+(h>0?Math.ceil(h):Math.floor(h))),h=a.getZoomScale(d)/this._scale;a._animateZoom(g,d,c,h)}},_getScaleOrigin:function(){return this._startCenter.add(this._centerOffset.subtract(this._delta).divideBy(this._scale))}});b.Map.addInitHook("addHandler","touchZoom",b.Map.TouchZoom);b.Map.mergeOptions({tap:!0,
tapTolerance:15});b.Map.Tap=b.Handler.extend({addHooks:function(){b.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){b.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches)if(b.DomEvent.preventDefault(a),this._fireClick=!0,a.touches.length>1)this._fireClick=!1,clearTimeout(this._holdTimeout);else{var c=a.touches[0],a=c.target;this._startPos=this._newPos=new b.Point(c.clientX,c.clientY);a.tagName&&a.tagName.toLowerCase()===
"a"&&b.DomUtil.addClass(a,"leaflet-active");this._holdTimeout=setTimeout(b.bind(function(){if(this._isTapValid())this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",c)},this),1E3);b.DomEvent.on(f,"touchmove",this._onMove,this).on(f,"touchend",this._onUp,this)}},_onUp:function(a){clearTimeout(this._holdTimeout);b.DomEvent.off(f,"touchmove",this._onMove,this).off(f,"touchend",this._onUp,this);if(this._fireClick&&a&&a.changedTouches){var a=a.changedTouches[0],c=a.target;c&&c.tagName&&c.tagName.toLowerCase()===
"a"&&b.DomUtil.removeClass(c,"leaflet-active");this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new b.Point(a.clientX,a.clientY)},_simulateEvent:function(a,b){var d=f.createEvent("MouseEvents");d._simulated=!0;b.target._simulatedClick=!0;d.initMouseEvent(a,!0,!0,c,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null);b.target.dispatchEvent(d)}});
b.Browser.touch&&!b.Browser.pointer&&b.Map.addInitHook("addHandler","tap",b.Map.Tap);b.Map.mergeOptions({boxZoom:!0});b.Map.BoxZoom=b.Handler.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane;this._moved=!1},addHooks:function(){b.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){b.DomEvent.off(this._container,"mousedown",this._onMouseDown);this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(a){this._moved=
!1;if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;b.DomUtil.disableTextSelection();b.DomUtil.disableImageDrag();this._startLayerPoint=this._map.mouseEventToLayerPoint(a);b.DomEvent.on(f,"mousemove",this._onMouseMove,this).on(f,"mouseup",this._onMouseUp,this).on(f,"keydown",this._onKeyDown,this)},_onMouseMove:function(a){if(!this._moved)this._box=b.DomUtil.create("div","leaflet-zoom-box",this._pane),b.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",
this._map.fire("boxzoomstart");var c=this._startLayerPoint,d=this._box,f=this._map.mouseEventToLayerPoint(a),a=f.subtract(c),c=new b.Point(Math.min(f.x,c.x),Math.min(f.y,c.y));b.DomUtil.setPosition(d,c);this._moved=!0;d.style.width=Math.max(0,Math.abs(a.x)-4)+"px";d.style.height=Math.max(0,Math.abs(a.y)-4)+"px"},_finish:function(){if(this._moved)this._pane.removeChild(this._box),this._container.style.cursor="";b.DomUtil.enableTextSelection();b.DomUtil.enableImageDrag();b.DomEvent.off(f,"mousemove",
this._onMouseMove).off(f,"mouseup",this._onMouseUp).off(f,"keydown",this._onKeyDown)},_onMouseUp:function(a){this._finish();var c=this._map,a=c.mouseEventToLayerPoint(a);this._startLayerPoint.equals(a)||(a=new b.LatLngBounds(c.layerPointToLatLng(this._startLayerPoint),c.layerPointToLatLng(a)),c.fitBounds(a),c.fire("boxzoomend",{boxZoomBounds:a}))},_onKeyDown:function(a){a.keyCode===27&&this._finish()}});b.Map.addInitHook("addHandler","boxZoom",b.Map.BoxZoom);b.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,
keyboardZoomOffset:1});b.Map.Keyboard=b.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(a){this._map=a;this._setPanOffset(a.options.keyboardPanOffset);this._setZoomOffset(a.options.keyboardZoomOffset)},addHooks:function(){var a=this._map._container;if(a.tabIndex===-1)a.tabIndex="0";b.DomEvent.on(a,"focus",this._onFocus,this).on(a,"blur",this._onBlur,this).on(a,"mousedown",this._onMouseDown,this);this._map.on("focus",
this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var a=this._map._container;b.DomEvent.off(a,"focus",this._onFocus,this).off(a,"blur",this._onBlur,this).off(a,"mousedown",this._onMouseDown,this);this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var a=f.body,b=f.documentElement,d=a.scrollTop||b.scrollTop,a=a.scrollLeft||b.scrollLeft;this._map._container.focus();c.scrollTo(a,d)}},
_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanOffset:function(a){var b=this._panKeys={},c=this.keyCodes,d,f;d=0;for(f=c.left.length;d<f;d++)b[c.left[d]]=[-1*a,0];d=0;for(f=c.right.length;d<f;d++)b[c.right[d]]=[a,0];d=0;for(f=c.down.length;d<f;d++)b[c.down[d]]=[0,a];d=0;for(f=c.up.length;d<f;d++)b[c.up[d]]=[0,-1*a]},_setZoomOffset:function(a){var b=this._zoomKeys={},c=this.keyCodes,d,f;d=0;for(f=c.zoomIn.length;d<f;d++)b[c.zoomIn[d]]=
a;d=0;for(f=c.zoomOut.length;d<f;d++)b[c.zoomOut[d]]=-a},_addHooks:function(){b.DomEvent.on(f,"keydown",this._onKeyDown,this)},_removeHooks:function(){b.DomEvent.off(f,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){var c=a.keyCode,d=this._map;if(c in this._panKeys){if(d._panAnim&&d._panAnim._inProgress)return;d.panBy(this._panKeys[c]);d.options.maxBounds&&d.panInsideBounds(d.options.maxBounds)}else if(c in this._zoomKeys)d.setZoom(d.getZoom()+this._zoomKeys[c]);else return;b.DomEvent.stop(a)}});
b.Map.addInitHook("addHandler","keyboard",b.Map.Keyboard);b.Handler.MarkerDrag=b.Handler.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;if(!this._draggable)this._draggable=new b.Draggable(a,a);this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this);this._draggable.enable();b.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",
this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this);this._draggable.disable();b.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var a=this._marker,c=a._shadow,d=b.DomUtil.getPosition(a._icon),f=a._map.layerPointToLatLng(d);c&&b.DomUtil.setPosition(c,d);a._latlng=f;a.fire("move",
{latlng:f}).fire("drag")},_onDragEnd:function(a){this._marker.fire("moveend").fire("dragend",a)}});b.Control=b.Class.extend({options:{position:"topright"},initialize:function(a){b.setOptions(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var b=this._map;b&&b.removeControl(this);this.options.position=a;b&&b.addControl(this);return this},getContainer:function(){return this._container},addTo:function(a){this._map=a;var c=this._container=this.onAdd(a),d=this.getPosition(),
a=a._controlCorners[d];b.DomUtil.addClass(c,"leaflet-control");d.indexOf("bottom")!==-1?a.insertBefore(c,a.firstChild):a.appendChild(c);return this},removeFrom:function(a){var b=this.getPosition();a._controlCorners[b].removeChild(this._container);this._map=null;if(this.onRemove)this.onRemove(a);return this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}});b.control=function(a){return new b.Control(a)};b.Map.include({addControl:function(a){a.addTo(this);return this},removeControl:function(a){a.removeFrom(this);
return this},_initControlPos:function(){function a(a,h){c[a+h]=b.DomUtil.create("div",d+a+" "+d+h,f)}var c=this._controlCorners={},d="leaflet-",f=this._controlContainer=b.DomUtil.create("div",d+"control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}});b.Control.Zoom=b.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",
zoomOutTitle:"Zoom out"},onAdd:function(a){var c=b.DomUtil.create("div","leaflet-control-zoom leaflet-bar");this._map=a;this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,"leaflet-control-zoom-in",c,this._zoomIn,this);this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,"leaflet-control-zoom-out",c,this._zoomOut,this);this._updateDisabled();a.on("zoomend zoomlevelschange",this._updateDisabled,this);return c},onRemove:function(a){a.off("zoomend zoomlevelschange",
this._updateDisabled,this)},_zoomIn:function(a){this._map.zoomIn(a.shiftKey?3:1)},_zoomOut:function(a){this._map.zoomOut(a.shiftKey?3:1)},_createButton:function(a,c,d,f,h,i){d=b.DomUtil.create("a",d,f);d.innerHTML=a;d.href="#";d.title=c;a=b.DomEvent.stopPropagation;b.DomEvent.on(d,"click",a).on(d,"mousedown",a).on(d,"dblclick",a).on(d,"click",b.DomEvent.preventDefault).on(d,"click",h,i).on(d,"click",this._refocusOnMap,i);return d},_updateDisabled:function(){var a=this._map;b.DomUtil.removeClass(this._zoomInButton,
"leaflet-disabled");b.DomUtil.removeClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMinZoom()&&b.DomUtil.addClass(this._zoomOutButton,"leaflet-disabled");a._zoom===a.getMaxZoom()&&b.DomUtil.addClass(this._zoomInButton,"leaflet-disabled")}});b.Map.mergeOptions({zoomControl:!0});b.Map.addInitHook(function(){if(this.options.zoomControl)this.zoomControl=new b.Control.Zoom,this.addControl(this.zoomControl)});b.control.zoom=function(a){return new b.Control.Zoom(a)};b.Control.Attribution=b.Control.extend({options:{position:"bottomright",
prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(a){b.setOptions(this,a);this._attributions={}},onAdd:function(a){this._container=b.DomUtil.create("div","leaflet-control-attribution");b.DomEvent.disableClickPropagation(this._container);for(var c in a._layers)a._layers[c].getAttribution&&this.addAttribution(a._layers[c].getAttribution());a.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this);this._update();
return this._container},onRemove:function(a){a.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(a){this.options.prefix=a;this._update();return this},addAttribution:function(a){if(a)return this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this},removeAttribution:function(a){if(a)return this._attributions[a]&&(this._attributions[a]--,this._update()),this},_update:function(){if(this._map){var a=[],b;for(b in this._attributions)this._attributions[b]&&
a.push(b);b=[];this.options.prefix&&b.push(this.options.prefix);a.length&&b.push(a.join(", "));this._container.innerHTML=b.join(" | ")}},_onLayerAdd:function(a){a.layer.getAttribution&&this.addAttribution(a.layer.getAttribution())},_onLayerRemove:function(a){a.layer.getAttribution&&this.removeAttribution(a.layer.getAttribution())}});b.Map.mergeOptions({attributionControl:!0});b.Map.addInitHook(function(){if(this.options.attributionControl)this.attributionControl=(new b.Control.Attribution).addTo(this)});
b.control.attribution=function(a){return new b.Control.Attribution(a)};b.Control.Scale=b.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(a){this._map=a;var c=b.DomUtil.create("div","leaflet-control-scale"),d=this.options;this._addScales(d,"leaflet-control-scale",c);a.on(d.updateWhenIdle?"moveend":"move",this._update,this);a.whenReady(this._update,this);return c},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",
this._update,this)},_addScales:function(a,c,d){if(a.metric)this._mScale=b.DomUtil.create("div",c+"-line",d);if(a.imperial)this._iScale=b.DomUtil.create("div",c+"-line",d)},_update:function(){var a=this._map.getBounds(),b=a.getCenter().lat,a=6378137*Math.PI*Math.cos(b*Math.PI/180)*(a.getNorthEast().lng-a.getSouthWest().lng)/180,b=this._map.getSize(),c=this.options,d=0;b.x>0&&(d=a*(c.maxWidth/b.x));this._updateScales(c,d)},_updateScales:function(a,b){a.metric&&b&&this._updateMetric(b);a.imperial&&b&&
this._updateImperial(b)},_updateMetric:function(a){var b=this._getRoundNum(a);this._mScale.style.width=this._getScaleWidth(b/a)+"px";this._mScale.innerHTML=b<1E3?b+" m":b/1E3+" km"},_updateImperial:function(a){var b=a*3.2808399,a=this._iScale,c;b>5280?(b/=5280,c=this._getRoundNum(b),a.style.width=this._getScaleWidth(c/b)+"px",a.innerHTML=c+" mi"):(c=this._getRoundNum(b),a.style.width=this._getScaleWidth(c/b)+"px",a.innerHTML=c+" ft")},_getScaleWidth:function(a){return Math.round(this.options.maxWidth*
a)-10},_getRoundNum:function(a){var b=Math.pow(10,(Math.floor(a)+"").length-1);a/=b;return b*(a>=10?10:a>=5?5:a>=3?3:a>=2?2:1)}});b.control.scale=function(a){return new b.Control.Scale(a)};b.Control.Layers=b.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(a,c,d){b.setOptions(this,d);this._layers={};this._lastZIndex=0;this._handlingClick=!1;for(var f in a)this._addLayer(a[f],f);for(f in c)this._addLayer(c[f],f,!0)},onAdd:function(a){this._initLayout();this._update();
a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this);return this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(a,b){this._addLayer(a,b);this._update();return this},addOverlay:function(a,b){this._addLayer(a,b,!0);this._update();return this},removeLayer:function(a){delete this._layers[b.stamp(a)];this._update();return this},_initLayout:function(){var a=this._container=b.DomUtil.create("div",
"leaflet-control-layers");a.setAttribute("aria-haspopup",!0);if(b.Browser.touch)b.DomEvent.on(a,"click",b.DomEvent.stopPropagation);else b.DomEvent.disableClickPropagation(a).disableScrollPropagation(a);var c=this._form=b.DomUtil.create("form","leaflet-control-layers-list");if(this.options.collapsed){if(!b.Browser.android)b.DomEvent.on(a,"mouseover",this._expand,this).on(a,"mouseout",this._collapse,this);var d=this._layersLink=b.DomUtil.create("a","leaflet-control-layers-toggle",a);d.href="#";d.title=
"Layers";if(b.Browser.touch)b.DomEvent.on(d,"click",b.DomEvent.stop).on(d,"click",this._expand,this);else b.DomEvent.on(d,"focus",this._expand,this);b.DomEvent.on(c,"click",function(){setTimeout(b.bind(this._onInputClick,this),0)},this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=b.DomUtil.create("div","leaflet-control-layers-base",c);this._separator=b.DomUtil.create("div","leaflet-control-layers-separator",c);this._overlaysList=b.DomUtil.create("div","leaflet-control-layers-overlays",
c);a.appendChild(c)},_addLayer:function(a,c,d){this._layers[b.stamp(a)]={layer:a,name:c,overlay:d};this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";var a=!1,b=!1,c,d;for(c in this._layers)d=this._layers[c],this._addItem(d),b=b||d.overlay,a=a||!d.overlay;this._separator.style.display=b&&a?"":"none"}},_onLayerChange:function(a){var c=this._layers[b.stamp(a.layer)];
c&&(this._handlingClick||this._update(),(a=c.overlay?a.type==="layeradd"?"overlayadd":"overlayremove":a.type==="layeradd"?"baselayerchange":null)&&this._map.fire(a,c))},_createRadioElement:function(a,b){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"';b&&(c+=' checked="checked"');c+="/>";var d=f.createElement("div");d.innerHTML=c;return d.firstChild},_addItem:function(a){var c=f.createElement("label"),d,h=this._map.hasLayer(a.layer);a.overlay?(d=f.createElement("input"),
d.type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=h):d=this._createRadioElement("leaflet-base-layers",h);d.layerId=b.stamp(a.layer);b.DomEvent.on(d,"click",this._onInputClick,this);h=f.createElement("span");h.innerHTML=" "+a.name;c.appendChild(d);c.appendChild(h);(a.overlay?this._overlaysList:this._baseLayersList).appendChild(c);return c},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),f=d.length;this._handlingClick=!0;for(a=0;a<f;a++)b=
d[a],c=this._layers[b.layerId],b.checked&&!this._map.hasLayer(c.layer)?this._map.addLayer(c.layer):!b.checked&&this._map.hasLayer(c.layer)&&this._map.removeLayer(c.layer);this._handlingClick=!1;this._refocusOnMap()},_expand:function(){b.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}});b.control.layers=function(a,c,d){return new b.Control.Layers(a,c,d)};b.PosAnimation=
b.Class.extend({includes:b.Mixin.Events,run:function(a,c,d,f){this.stop();this._el=a;this._inProgress=!0;this._newPos=c;this.fire("start");a.style[b.DomUtil.TRANSITION]="all "+(d||0.25)+"s cubic-bezier(0,0,"+(f||0.5)+",1)";b.DomEvent.on(a,b.DomUtil.TRANSITION_END,this._onTransitionEnd,this);b.DomUtil.setPosition(a,c);b.Util.falseFn(a.offsetWidth);this._stepTimer=setInterval(b.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(b.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),
b.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var a=this._getPos();a?(this._el._leaflet_pos=a,this.fire("step")):this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var a,d;d=c.getComputedStyle(this._el);if(b.Browser.any3d){d=d[b.DomUtil.TRANSFORM].match(this._transformRe);if(!d)return;a=parseFloat(d[1]);d=parseFloat(d[2])}else a=parseFloat(d.left),d=parseFloat(d.top);return new b.Point(a,d,!0)},_onTransitionEnd:function(){b.DomEvent.off(this._el,
b.DomUtil.TRANSITION_END,this._onTransitionEnd,this);if(this._inProgress)this._inProgress=!1,this._el.style[b.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end")}});b.Map.include({setView:function(a,c,d){c=c===h?this._zoom:this._limitZoom(c);a=this._limitCenter(b.latLng(a),c,this.options.maxBounds);d=d||{};this._panAnim&&this._panAnim.stop();if(this._loaded&&!d.reset&&d!==!0){if(d.animate!==h)d.zoom=b.extend({animate:d.animate},d.zoom),
d.pan=b.extend({animate:d.animate},d.pan);if(this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,c,d.zoom):this._tryAnimatedPan(a,d.pan))return clearTimeout(this._sizeTimer),this}this._resetView(a,c);return this},panBy:function(a,c){a=b.point(a).round();c=c||{};if(!a.x&&!a.y)return this;if(!this._panAnim)this._panAnim=new b.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this);c.noMoveStart||this.fire("movestart");c.animate!==!1?(b.DomUtil.addClass(this._mapPane,
"leaflet-pan-anim"),this._panAnim.run(this._mapPane,this._getMapPanePos().subtract(a),c.duration||0.25,c.easeLinearity)):(this._rawPanBy(a),this.fire("move").fire("moveend"));return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){b.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,b){var c=this._getCenterOffset(a)._floor();if((b&&b.animate)!==!0&&!this.getSize().contains(c))return!1;this.panBy(c,b);return!0}});
b.PosAnimation=b.DomUtil.TRANSITION?b.PosAnimation:b.PosAnimation.extend({run:function(a,c,d,f){this.stop();this._el=a;this._inProgress=!0;this._duration=d||0.25;this._easeOutPower=1/Math.max(f||0.5,0.2);this._startPos=b.DomUtil.getPosition(a);this._offset=c.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=b.Util.requestAnimFrame(this._animate,this);this._step()},
_step:function(){var a=+new Date-this._startTime,b=this._duration*1E3;a<b?this._runFrame(this._easeOut(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){a=this._startPos.add(this._offset.multiplyBy(a));b.DomUtil.setPosition(this._el,a);this.fire("step")},_complete:function(){b.Util.cancelAnimFrame(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}});b.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});b.DomUtil.TRANSITION&&
b.Map.addInitHook(function(){if(this._zoomAnimated=this.options.zoomAnimation&&b.DomUtil.TRANSITION&&b.Browser.any3d&&!b.Browser.android23&&!b.Browser.mobileOpera)b.DomEvent.on(this._mapPane,b.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)});b.Map.include(!b.DomUtil.TRANSITION?{}:{_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},
_tryAnimatedZoom:function(a,b,c){if(this._animatingZoom)return!0;c=c||{};if(!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(b-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(b),f=this._getCenterOffset(a)._divideBy(1-1/d),h=this._getCenterLayerPoint()._add(f);if(c.animate!==!0&&!this.getSize().contains(f))return!1;this.fire("movestart").fire("zoomstart");this._animateZoom(a,b,h,d,null,!0);return!0},_animateZoom:function(a,c,d,f,h,i){this._animatingZoom=
!0;b.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim");this._animateToCenter=a;this._animateToZoom=c;if(b.Draggable)b.Draggable._disabled=!0;this.fire("zoomanim",{center:a,zoom:c,origin:d,scale:f,delta:h,backwards:i})},_onZoomTransitionEnd:function(){this._animatingZoom=!1;b.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim");this._resetView(this._animateToCenter,this._animateToZoom,!0,!0);if(b.Draggable)b.Draggable._disabled=!1}});b.TileLayer.include({_animateZoom:function(a){if(!this._animating)this._animating=
!0,this._prepareBgBuffer();var c=this._bgBuffer,d=b.DomUtil.TRANSFORM,f=a.delta?b.DomUtil.getTranslateString(a.delta):c.style[d],h=b.DomUtil.getScaleString(a.scale,a.origin);c.style[d]=a.backwards?h+" "+f:f+" "+h},_endZoomAnim:function(){var a=this._tileContainer,c=this._bgBuffer;a.style.visibility="";a.parentNode.appendChild(a);b.Util.falseFn(c.offsetWidth);this._animating=!1},_clearBgBuffer:function(){var a=this._map;if(a&&!a._animatingZoom&&!a.touchZoom._zooming)this._bgBuffer.innerHTML="",this._bgBuffer.style[b.DomUtil.TRANSFORM]=
""},_prepareBgBuffer:function(){var a=this._tileContainer,c=this._bgBuffer,d=this._getLoadedTilesPercentage(c),f=this._getLoadedTilesPercentage(a);c&&d>0.5&&f<0.5?(a.style.visibility="hidden",this._stopLoadingImages(a)):(c.style.visibility="hidden",c.style[b.DomUtil.TRANSFORM]="",this._tileContainer=c,c=this._bgBuffer=a,this._stopLoadingImages(c),clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(a){var a=a.getElementsByTagName("img"),b,c,d=0;b=0;for(c=a.length;b<c;b++)a[b].complete&&
d++;return d/c},_stopLoadingImages:function(a){var a=Array.prototype.slice.call(a.getElementsByTagName("img")),c,d,f;c=0;for(d=a.length;c<d;c++)if(f=a[c],!f.complete)f.onload=b.Util.falseFn,f.onerror=b.Util.falseFn,f.src=b.Util.emptyImageUrl,f.parentNode.removeChild(f)}});b.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:Infinity,timeout:1E4,maximumAge:0,enableHighAccuracy:!1},locate:function(a){a=this._locateOptions=b.extend(this._defaultLocateOptions,a);if(!navigator.geolocation)return this._handleGeolocationError({code:0,
message:"Geolocation not supported."}),this;var c=b.bind(this._handleGeolocationResponse,this),d=b.bind(this._handleGeolocationError,this);a.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,d,a):navigator.geolocation.getCurrentPosition(c,d,a);return this},stopLocate:function(){navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId);if(this._locateOptions)this._locateOptions.setView=!1;return this},_handleGeolocationError:function(a){var b=a.code,a=a.message||
(b===1?"permission denied":b===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:b,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var c=a.coords.latitude,d=a.coords.longitude,f=new b.LatLng(c,d),h=180*a.coords.accuracy/40075017,i=h/Math.cos(b.LatLng.DEG_TO_RAD*c),c=b.latLngBounds([c-h,d-i],[c+h,d+i]),d=this._locateOptions;d.setView&&(d=Math.min(this.getBoundsZoom(c),d.maxZoom),this.setView(f,
d));var f={latlng:f,bounds:c,timestamp:a.timestamp},k;for(k in a.coords)typeof a.coords[k]==="number"&&(f[k]=a.coords[k]);this.fire("locationfound",f)}})})(window,document);function delay(c,f,h){for(var i=[],b=3;b<arguments.length;b++)i.push(arguments[b]);return document.all?setTimeout(function(){h.apply(f,i)},c):setTimeout(function(b,a,c){b.apply(a,c)},c,h,f,i)}
(function(){L.Marker.include({_setPos:function(c){this._icon._leaflet_pos=c;if(L.Browser.any3d){if(this._icon.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(c),L.Browser.mobileWebkit3d)this._icon.style.WebkitBackfaceVisibility="hidden"}else this._icon.style.left=c.x+"px",this._icon.style.top=c.y+"px",L.DomUtil.TRANSFORM&&(this._icon.style[L.DomUtil.TRANSFORM]="");if(L.DomUtil.TRANSFORM&&this.options.iconAngle){var f=this.options.icon.options.iconAnchor,f=L.point(this.options.icon.options.iconSize).divideBy(2)._subtract(L.point(f)),
b="";if(f.x!=0||f.y!=0)b+=" translate("+-f.x+"px, "+-f.y+"px)";b+=" rotate("+this.options.iconAngle+"deg)";if(f.x!=0||f.y!=0)b+=" translate("+f.x+"px, "+f.y+"px)";this._icon.style[L.DomUtil.TRANSFORM]+=b}this._shadow&&L.DomUtil.setPosition(this._shadow,c);this._icon.style.zIndex=c.y+this.options.zIndexOffset},setIconAngle:function(c){this.options.iconAngle=c;this._map&&this.update()}});L.LayerGroup.include({getBounds:function(){var c=new L.LatLngBounds;this.eachLayer(function(f){c.extend(f instanceof
L.Marker?f.getLatLng():f.getBounds())},this);return c},getCenter:function(){return this.getBounds().getCenter()}});L.Map.include({_initContainer:function(c){c=this._container=L.DomUtil.get(c);if(c._leaflet)throw Error("Map container is already initialized.");c._leaflet=!0;c.jMap=this},openPopup:function(c){if(this._popup&&this._popup==c)return this;this.closePopup();this._popup=c;return this.addLayer(c).fire("popupopen",{popup:this._popup})},clearFilter:function(){},filterVesselsByIDs:function(c){this.vesselLayer&&
this.vesselLayer.eachLayer(function(f){if($.inArray(f.vessel.id,c)!=-1){if(f._icon.style.display==""||f._icon.style.display=="none")f._icon.style.display="block",f.openLabel()}else if(f._icon.style.display==""||f._icon.style.display=="block")f._icon.style.display="none",f.closeLabel()})},zoomVesselExtent:function(){}});L.Control.LatLng=L.Control.extend({options:{position:"topright",editable:!0},_initialized:!1,onAdd:function(c){var f=L.DomUtil.create("div","leaflet-control-latlng");this._lng=this._lat=
null;this._init("leaflet-control-latlng",f,c);this._initialized=!0;return f},getValue:function(){return this._lat.value!=""&&this._lng.value!=""?new L.LatLng(this._lat.value,this._lng.value):this._map instanceof L.Map?this._map.getCenter():new L.LatLng(0,0)},_updateControl:function(){if(this._map instanceof L.Map){var c=this._map.getCenter();this._lat.value=L.Util.formatNum(c.lat,6).toFixed(6);this._lng.value=L.Util.formatNum(c.lng,6).toFixed(6)}},_inputChange:function(){this._map instanceof L.Map&&
this._map.setView(this.getValue())},_init:function(c,f,b){this._lat=L.DomUtil.create("input",c+"-lat",f);this._lat.setAttribute("maxlength",9);this._lat.setAttribute("size",9);this._lat.setAttribute("step",1.0E-6);this._lat.setAttribute("min",-85);this._lat.setAttribute("max",85);this._lat.setAttribute("type","number");this._lng=L.DomUtil.create("input",c+"-lng",f);this._lng.setAttribute("maxlength",10);this._lng.setAttribute("size",10);this._lng.setAttribute("step",1.0E-6);this._lng.setAttribute("min",
-450);this._lng.setAttribute("max",450);this._lng.setAttribute("type","number");L.DomEvent.addListener(b,"load",this._updateControl,this);L.DomEvent.addListener(f,L.Draggable.START,L.DomEvent.stopPropagation).addListener(f,"click",L.DomEvent.stopPropagation).addListener(f,"click",L.DomEvent.preventDefault).addListener(f,"dblclick",L.DomEvent.stopPropagation).addListener(f,"dblclick",L.DomEvent.preventDefault);L.DomEvent.addListener(this._lat,"change",this._inputChange,this).addListener(this._lng,
"change",this._inputChange,this);L.DomEvent.addListener(b,"moveend",this._updateControl,this).addListener(b,"drag",this._updateControl,this);if(!this.options.editable)this._lat.disabled="disabled",this._lng.disabled="disabled"}});L.Control.MouseLatLngDisplay=L.Control.extend({options:{position:"bottomleft"},_initialized:!1,onAdd:function(c){var f=L.DomUtil.create("div","leaflet-control-mouselatlng");this._mdisplay=null;this._init("leaflet-control-mouselatlng",f,c);this._initialized=!0;return f},_init:function(c,
f,b){this._mdisplay=L.DomUtil.create("div",c+"-mouse",f);this._mdisplay.style.textAlign="right";this._mdisplay.innerHTML="Lat: ?, Lng: ?";b.on("mousemove",this._updateMouseDisplay,this)},_updateMouseDisplay:function(c){this._mdisplay.innerHTML="Lat: "+L.Util.formatNum(c.latlng.lat,6).toFixed(6)+", Lng: "+L.Util.formatNum(c.latlng.lng,6).toFixed(6)}});var c=window.location.protocol;L.TileLayer.Common=L.TileLayer.extend({is_overlay:!1,initialize:function(c){L.TileLayer.prototype.initialize.call(this,
this.url,c)}});var f=c+"//tile{s}.fleetmon.com/cm/{z}/{x}/{y}.png";L.TileLayer.CloudMade=L.TileLayer.Common.extend({url:window.devicePixelRatio>=2?f:f,label:"Fleetmon",options:{attribution:'&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, \u00a9 <a href="http://cloudmade.com">CloudMade</a>',subdomains:[1,2,3,4],maxZoom:18}});L.TileLayer.OpenStreetMap={};L.TileLayer.OpenStreetMap.MAP_ATTR='&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA</a>';
L.TileLayer.OpenStreetMap.DATA_ATTR="Map data "+L.TileLayer.OpenStreetMap.MAP_ATTR;L.TileLayer.OpenStreetMap.FMProxy=L.TileLayer.Common.extend({url:c+"//tile{s}.fleetmon.com/osm/{z}/{x}/{y}.png",label:"OpenStreetMap",options:{subdomains:"1234",attribution:L.TileLayer.OpenStreetMap.MAP_ATTR}});L.TileLayer.FMCoverageLayer=L.TileLayer.Common.extend({url:c+"//tile{s}.fleetmon.com/cov/{z}_{x}_{y}.png",name:"Coverage",options:{subdomains:[1,2,3,4]}});L.TileLayer.InlandENC=L.TileLayer.Common.extend({url:c+
"//chart.fleetmon.com/nlnd/31/{z}/{x}/{y}",name:"InlandENC",options:{}});L.TileLayer.Bing=L.TileLayer.extend({label:"Bing",options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:""},initialize:function(c){L.Util.setOptions(this,c);this._key="AqTGBsziZHIJYYxgivLBf0hVdrAk9mWO5cQcb8Yux8sW5M8c8opEC2lZqKR1ZZXf";this._url=null;this.meta={};this.loadMetadata()},tile2quad:function(c,f,b){for(var d="";b>0;b--){var a=0,e=1<<b-1;(c&e)!=0&&(a+=1);(f&e)!=0&&(a+=2);d+=a}return d},getTileUrl:function(c,
f){f=this._getZoomForUrl();return this._url.replace("{subdomain}",this.options.subdomains[Math.abs((c.x+c.y)%this.options.subdomains.length)]).replace("{quadkey}",this.tile2quad(c.x,c.y,f)).replace("{culture}",this.options.culture)},loadMetadata:function(){var f=this,i="_bing_metadata_"+L.Util.stamp(this);window[i]=function(a){f.meta=a;window[i]=void 0;var b=document.getElementById(i);b.parentNode.removeChild(b);a.errorDetails?alert("Got metadata"+a.errorDetails):f.initMetadata()};var b=c+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+
this.options.type+"?include=ImageryProviders&jsonp="+i+"&key="+this._key,d=document.createElement("script");d.type="text/javascript";d.src=b;d.id=i;document.getElementsByTagName("head")[0].appendChild(d)},initMetadata:function(){var f=this.meta.resourceSets[0].resources[0];this.options.subdomains=f.imageUrlSubdomains;this._url=f.imageUrl;if(!this._url.match(RegExp("^"+c+"//")))this._url=this._url.replace(/^[^\/]*\/\//,c+"//");this._providers=[];for(var i=0;i<f.imageryProviders.length;i++)for(var b=
f.imageryProviders[i],d=0;d<b.coverageAreas.length;d++){var a=b.coverageAreas[d],e={zoomMin:a.zoomMin,zoomMax:a.zoomMax,active:!1},a=new L.LatLngBounds(new L.LatLng(a.bbox[0]+0.01,a.bbox[1]+0.01),new L.LatLng(a.bbox[2]-0.01,a.bbox[3]-0.01));e.bounds=a;e.attrib=b.attribution;this._providers.push(e)}this._update()},_update:function(){this._url!=null&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var c=this._map.getBounds(),f=
this._map.getZoom(),b=0;b<this._providers.length;b++){var d=this._providers[b];f<=d.zoomMax&&f>=d.zoomMin&&c.intersects(d.bounds)?(!d.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(d.attrib),d.active=!0):(d.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(d.attrib),d.active=!1)}},onRemove:function(c){for(var f=0;f<this._providers.length;f++){var b=this._providers[f];if(b.active)this._map.attributionControl&&this._map.attributionControl.removeAttribution(b.attrib),
b.active=!1}L.TileLayer.prototype.onRemove.apply(this,[c])}})})();
(function(){L.Control.JCSLayers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(c,f,h){L.setOptions(this,h);this._layers={};this._lastZIndex=0;this._handlingClick=!1;for(var i in c)this._addLayer(c[i],i);for(i in f)this._addLayer(f[i],i,!0)},onAdd:function(c){this._initLayout();this._update();c.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this);return this._container},onRemove:function(c){c.off("layeradd",this._onLayerChange).off("layerremove",
this._onLayerChange)},addBaseLayer:function(c,f){this._addLayer(c,f);this._update();return this},addOverlay:function(c,f){this._addLayer(c,f,!0);this._update();return this},removeLayer:function(c){delete this._layers[L.stamp(c)];this._update();return this},_initLayout:function(){var c=this._container=L.DomUtil.create("div","leaflet-control-layers");c.setAttribute("aria-haspopup",!0);if(L.Browser.touch)L.DomEvent.on(c,"click",L.DomEvent.stopPropagation);else L.DomEvent.disableClickPropagation(c).disableScrollPropagation(c);
var f=this._form=L.DomUtil.create("div","leaflet-control-layers-list");if(this.options.collapsed){if(!L.Browser.android)L.DomEvent.on(c,"mouseover",this._expand,this).on(c,"mouseout",this._collapse,this);var h=this._layersLink=L.DomUtil.create("a","leaflet-control-layers-toggle",c);h.href="#";h.title="Layers";if(L.Browser.touch)L.DomEvent.on(h,"click",L.DomEvent.stop).on(h,"click",this._expand,this);else L.DomEvent.on(h,"focus",this._expand,this);L.DomEvent.on(f,"click",function(){setTimeout(L.bind(this._onInputClick,
this),0)},this);this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div","leaflet-control-layers-base",f);this._separator=L.DomUtil.create("div","leaflet-control-layers-separator",f);this._overlaysList=L.DomUtil.create("div","leaflet-control-layers-overlays",f);c.appendChild(f)},_addLayer:function(c,f,h){this._layers[L.stamp(c)]={layer:c,name:f,overlay:h};this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML=
"";this._overlaysList.innerHTML="";var c=!1,f=!1,h,i;for(h in this._layers)i=this._layers[h],this._addItem(i),f=f||i.overlay,c=c||!i.overlay;this._separator.style.display=f&&c?"":"none"}},_onLayerChange:function(c){var f=this._layers[L.stamp(c.layer)];f&&(this._handlingClick||this._update(),(c=f.overlay?c.type==="layeradd"?"overlayadd":"overlayremove":c.type==="layeradd"?"baselayerchange":null)&&this._map.fire(c,f))},_createRadioElement:function(c,f){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+
c+'"';f&&(h+=' checked="checked"');h+="/>";var i=document.createElement("div");i.innerHTML=h;return i.firstChild},_addItem:function(c){var f=document.createElement("div"),h,i=this._map.hasLayer(c.layer);c.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=i):h=this._createRadioElement("leaflet-base-layers",i);h.layerId=L.stamp(c.layer);L.DomEvent.on(h,"click",this._onInputClick,this);i=document.createElement("span");i.innerHTML=
" "+c.name;f.appendChild(h);f.appendChild(i);(c.overlay?this._overlaysList:this._baseLayersList).appendChild(f);return f},_onInputClick:function(){var c,f,h,i=this._form.getElementsByTagName("input"),b=i.length;this._handlingClick=!0;for(c=0;c<b;c++)f=i[c],h=this._layers[f.layerId],f.checked&&!this._map.hasLayer(h.layer)?this._map.addLayer(h.layer):!f.checked&&this._map.hasLayer(h.layer)&&this._map.removeLayer(h.layer);this._handlingClick=!1;this._refocusOnMap()},_expand:function(){L.DomUtil.addClass(this._container,
"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}});L.Label=L.Class.extend({includes:L.Mixin.Events,options:{minWidth:20,maxWidth:300,maxHeight:null,offset:new L.Point(0,0),className:"",zoomAnimation:!0},initialize:function(c,f){L.Util.setOptions(this,c);this._source=f;this._animated=L.Browser.any3d&&this.options.zoomAnimation},onAdd:function(c){this._map=c;this._container||this._initLayout();
this._updateContent();var f=c.options.fadeAnimation;f&&L.DomUtil.setOpacity(this._container,0);c._panes.popupPane.appendChild(this._container);c.on("viewreset",this._updatePosition,this);if(this._animated)c.on("zoomanim",this._zoomAnimation,this);this._update();f&&L.DomUtil.setOpacity(this._container,1)},addTo:function(c){c.addLayer(this);return this},onRemove:function(c){c._panes.popupPane.removeChild(this._container);L.Util.falseFn(this._container.offsetWidth);c.off({viewreset:this._updatePosition,
zoomanim:this._zoomAnimation},this);c.options.fadeAnimation&&L.DomUtil.setOpacity(this._container,0);this._map=null},setLatLng:function(c){this._latlng=L.latLng(c);this._update();return this},setContent:function(c){this._content=c;this._update();return this},labelhighligth:function(c){c?$(this._container).addClass("highlight"):$(this._container).removeClass("highlight");return this},_close:function(){var c=this._map;c&&c.removeLayer(this)},_initLayout:function(){var c=this._container=L.DomUtil.create("div",
"leaflet-label "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide")),f=this._wrapper=L.DomUtil.create("div","leaflet-label-content-wrapper",c);L.DomEvent.disableClickPropagation(f);this._contentNode=L.DomUtil.create("div","leaflet-label-content",f);this._tipContainer=L.DomUtil.create("div","leaflet-label-tip-container",c);this._tip=L.DomUtil.create("div","leaflet-label-tip",this._tipContainer)},_update:function(){if(this._map)this._container.style.visibility="hidden",this._updateContent(),
this._updateLayout(),this._updatePosition(),this._container.style.visibility=""},_updateContent:function(){if(this._content){if(typeof this._content==="string")this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var c=this._contentNode,f=c.style;f.width="";f.whiteSpace="nowrap";var h=c.offsetWidth,h=Math.min(h,
this.options.maxWidth),h=Math.max(h,this.options.minWidth);f.width=h+1+"px";f.whiteSpace="";f.height="";var h=c.offsetHeight,i=this.options.maxHeight;i&&h>i?(f.height=i+"px",L.DomUtil.addClass(c,"leaflet-label-scrolled")):L.DomUtil.removeClass(c,"leaflet-label-scrolled");this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),f=this._animated,h=this.options.offset;f&&L.DomUtil.setPosition(this._container,c);this._containerBottom=
-h.y-(f?0:c.y);this._containerLeft=-Math.round(this._containerWidth/2)+h.x+(f?0:c.x);this._container.style.bottom=this._containerBottom+"px";this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(c){c=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);L.DomUtil.setPosition(this._container,c)}});L.Vessel=L.Marker.extend({initialize:function(c,f){var h=STATIC_URL+"images/vmap_icon/"+c.icon;h+=c.is_moving?"_m":"_s";var i=[c.latitude,c.longitude],b=L.Util.extend({label_zoomlevel:12},
f);b.icon=new L.Icon({iconUrl:h+".png",iconSize:[20,20],iconAnchor:[10,10],popupAnchor:[0,-10],className:"vessel-icon "+(c.icon||"unknown")});b.iconAngle=Math.round(c.orientation);b.hoverable="hoverable"in b?!!b.hoverable:!0;b.selectable="selectable"in b?!!b.selectable:b.hoverable;"live"in c&&(c.live==2?b.opacity=0.6:c.live==3&&(b.opacity=0.3));L.Marker.prototype.initialize.call(this,i,b);this.vessel=L.Util.extend({},c);this._baseIconUrl=h;this.selected=this.highlighted=!1;this._label_open=this._hoverpopup_open=
this._popup_open=null},updateVessel:function(c){var f=!1,h=!1;if(c.icon!=this.vessel.icon||c.is_moving!=this.vessel.is_moving)f=STATIC_URL+"images/vmap_icon/"+c.icon,f+=c.is_moving?"_m":"_s",this._baseIconUrl=f,this._icon.src=this.selected?f+"a.png":this.highlighted?f+"h.png":f+".png",f=!0;if(c.latitude!=this.vessel.latitude||c.longitude!=this.vessel.longitude)this._latlng=new L.LatLng(c.latitude,c.longitude),h=f=!0;if(c.orientation!=this.vessel.orientation)this.options.iconAngle=Math.round(c.orientation),
f=!0;if(f)this.vessel=L.Util.extend({},c),this.update(),h&&(this._popup&&this._popup_open?this._popup.setLatLng(this._latlng):this._hoverpopup&&this._hoverpopup_open?this._hoverpopup.setLatLng(this._latlng):this._label&&this._label_open&&this._label.setLatLng(this._latlng));return this},onAdd:function(c){L.Marker.prototype.onAdd.call(this,c);this.options.hoverable&&(this.on("mouseover",this.highlight,this),this.on("mouseout",this.unhighlight,this));this.options.selectable&&(this.on("click",this.select,
this),c.on("click",this.unselect,this));c.on("moveend",this.checkLabelVisibility,this);c.on("popupopen",this._onPopupOpen,this);c.on("popupclose",this._onPopupClose,this)},onRemove:function(c){c.off("click",this.unselect,this);c.off("moveend",this.checkLabelVisibility,this);c.off("popupopen",this._onPopupOpen,this);c.off("popupclose",this._onPopupClose,this);L.Marker.prototype.onRemove.call(this,c);this.closeHoverPopup();this.closeLabel();this.off({mouseover:this.highlight,mouseout:this.unhighlight,
click:this.select},this)},update:function(){this._icon&&(this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this.checkLabelVisibility());return this},checkLabelVisibility:function(){this._label&&this.options.label_zoomlevel>=0&&(this._map.getBounds().contains(this._latlng)&&this._map.getZoom()>=this.options.label_zoomlevel?this.openLabel():this.closeLabel())},highlight:function(){if(this._map&&!this.highlighted){this.highlighted=!0;if(!this.selected)this._icon.src=this._baseIconUrl+
"h.png",this._bringToFront();this.fireEvent("highlight")}return this},unhighlight:function(){if(this._map&&this.highlighted)this.selected?this._icon.src=this._baseIconUrl+"a.png":(this._icon.src=this._baseIconUrl+".png",this._resetZIndex()),this.highlighted=!1,this.fireEvent("unhighlight");return this},select:function(){if(this.options.selectable&&this._map&&!this.selected)this.selected=!0,this._icon.src=this._baseIconUrl+"a.png",this._map.selectedVessel&&this._map.selectedVessel!=this&&this._map.selectedVessel.unselect(),
this._bringToFront(),this._map.selectedVessel=this,this.fireEvent("select");return this},unselect:function(){if(this.options.selectable&&this._map&&this.selected){this.highlighted?this._icon.src=this._baseIconUrl+"h.png":(this._icon.src=this._baseIconUrl+".png",this._resetZIndex());this.selected=!1;if(this._map.selectedVessel==this)this._map.selectedVessel=null;this.fireEvent("unselect")}return this},indicate:function(c,f,h,i){var f=typeof f!="number"?200:f,b=function(c,a){a?(L.DomUtil.setOpacity(this._icon,
1),c>1?delay(f+50,this,b,c-1,!a):typeof h=="function"&&h.call(i||this,this)):(L.DomUtil.setOpacity(this._icon,0.666),delay(f,this,b,c,!a))};b.call(this,typeof c!="number"?3:c)},present:function(c,f,h){var c=typeof c!="number"?3E3:c,i=this.options.label_zoomlevel;this.options.label_zoomlevel=0;this.fadeInLabel(function(){this.highlight();this.indicate()});delay(c,this,this.fadeOutLabel,function(){this.options.label_zoomlevel=i;this.unhighlight();typeof f=="function"&&f.call(h||this,this)})},_onPopupOpen:function(c){var f=
!1;if(this._popup&&c.popup==this._popup)f=this._popup_open=!0;else if(this._hoverpopup&&c.popup==this._hoverpopup)f=this._hoverpopup_open=!0;f&&this._label&&this.closeLabel()},_onPopupClose:function(c){var f=!1;if(this._popup&&c.popup==this._popup)this._popup_open=!1,f=!0;else if(this._hoverpopup&&c.popup==this._hoverpopup)this._hoverpopup_open=!1,f=!0;f&&this._label&&this.options.label_zoomlevel>=0&&this.openLabel()},openPopup:function(){if(this._popup&&this._map&&!this._popup_open)this._popup_open=
!0,this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup);return this},closePopup:function(){if(this._popup&&this._popup_open)this._popup_open=!1,this._popup._close();return this},_movePopup:function(c){this._popup.setLatLng(c.latlng)},bindPopup:function(c,f){var h=L.point(this.options.icon.options.popupAnchor)||new L.Point(0,0),h=h.add(L.Popup.prototype.options.offset);f&&f.offset&&(h=h.add(f.offset));f=L.Util.extend({offset:h},f);if(!this._popup)this.on("click",this.openPopup,this).on("remove",
this.closePopup,this).on("move",this._movePopup,this),this._popup_open=!1;this._popup=(new L.Popup(f,this)).setContent(c);return this},unbindPopup:function(){if(this._popup)this._popup=this._popup_open=null,this.off("click",this.openPopup).off("remove",this.closePopup).off("move",this._movePopup);return this},openHoverPopup:function(){if(this._hoverpopup&&this._map&&!this._popup_open&&this.options.hoverable&&!this._map._popup)this._hoverpopup.setLatLng(this._latlng),this._hoverpopup_open=!0,this._map.openPopup(this._hoverpopup);
return this},closeHoverPopup:function(){if(this._hoverpopup&&this._hoverpopup_open)this._hoverpopup_open=!1,this._hoverpopup._close();return this},bindHoverPopup:function(c,f){var h=L.point(this.options.icon.options.popupAnchor)||new L.Point(0,0),h=h.add(L.Popup.prototype.options.offset);f&&f.offset&&(h=h.add(f.offset));f=L.Util.extend({offset:h,closeButton:!1,autoPan:!1},f);this._hoverpopup_open=!1;this._hoverpopup||(this.on("mouseover",this.openHoverPopup,this),this.on("mouseout",this.closeHoverPopup,
this));this._hoverpopup=(new L.Popup(f,this)).setContent(c);return this},unbindHoverPopup:function(){if(this._hoverpopup)this._hoverpopup=null,this.off("mouseover",this.openHoverPopup,this),this.off("mouseout",this.closeHoverPopup,this),this._hoverpopup_open=null;return this},openLabel:function(){var c=this._icon.style.display!="none";if(this._label&&this._map&&!this._popup_open&&!this._hoverpopup_open&&!this._label_open&&this._map.getZoom()>=this.options.label_zoomlevel&&c)this._label.setLatLng(this._latlng),
this._label_open=!0,this._map.addLayer(this._label);return this},closeLabel:function(){if(this._label&&this._label_open)this._label_open=!1,this._label._close();return this},fadeInLabel:function(c,f){if(this._label&&this._map&&!this._popup_open&&!this._hoverpopup_open&&!this._label_open&&this._map.getZoom()>=this.options.label_zoomlevel)this._label.setLatLng(this._latlng),this._label_open=!0,this._map.addLayer(this._label),function(h){this._label_open&&(h=Math.min(h,1),L.DomUtil.setOpacity(this._label._container,
h),h<1?(h+=0.4,delay(200,this,arguments.callee,h)):typeof c=="function"&&c.call(f||this,this))}.call(this,0);return this},fadeOutLabel:function(c,f){this._label&&this._label_open&&function(h){if(this._label_open)h=Math.max(h,0),L.DomUtil.setOpacity(this._label._container,h),h>0?(h-=0.4,delay(200,this,arguments.callee,h)):(this._label_open=!1,this._label._close(),typeof c=="function"&&c.call(f||this,this))}.call(this,1);return this},bindLabel:function(c,f){var h=L.point(this.options.icon.options.popupAnchor)||
new L.Point(0,0),h=h.add(L.Label.prototype.options.offset);f&&f.offset&&(h=h.add(f.offset));f=L.Util.extend({offset:h},f);this._label_open=!1;this._label=(new L.Label(f,this)).setContent(c);return this},unbindLabel:function(){if(this._label)this._label_open=this._label=null;return this},setBigIcon:function(){var c=STATIC_URL+"images/vmap_iconbig/"+this.vessel.icon;c+=this.vessel.is_moving?"_m":"_s";var f=new L.Icon({iconUrl:c+".png",iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20],className:"vessel-iconbig "+
(this.vessel.icon||"unknown")});this._baseIconUrl=c;this.options.icon=f;this._map&&(this._initIcon(),this.update())},setStandardIcon:function(){var c=STATIC_URL+"images/vmap_icon/"+this.vessel.icon;c+=this.vessel.is_moving?"_m":"_s";var f=new L.Icon({iconUrl:c+".png",iconSize:[20,20],iconAnchor:[10,10],popupAnchor:[0,-10],className:"vessel-icon "+(this.vessel.icon||"unknown")});this._baseIconUrl=c;this.options.icon=f;this._map&&(this._initIcon(),this.update())}});L.VesselBig=L.Vessel.extend({initialize:function(c,
f){var h=STATIC_URL+"images/vmap_iconbig/"+c.icon;h+=c.is_moving?"_m":"_s";var i=[c.latitude,c.longitude],b=L.Util.extend({label_zoomlevel:12},f);b.icon=new L.Icon({iconUrl:h+".png",iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20],className:"vessel-iconbig "+(c.icon||"unknown")});b.iconAngle=Math.round(c.orientation);b.hoverable="hoverable"in b?!!b.hoverable:!0;b.selectable="selectable"in b?!!b.selectable:b.hoverable;L.Marker.prototype.initialize.call(this,i,b);this.vessel=L.Util.extend({},
c);this._baseIconUrl=h;this.selected=this.highlighted=!1;this._label_open=this._hoverpopup_open=this._popup_open=null}});L.VesselWaypoint=L.CircleMarker.extend({statics:{STYLE:{stroke:!1,color:"#ff0000",weight:1,opacity:0.67,fill:!0,fillColor:"#ff0000",fillOpacity:0.8,radius:6,dashArray:null},EVENT_COLORS:["#ff0000","#ff0000","#0000ff","#0000ff","#007f00","#00ff00","#AF00AF","#4F004F","#CE2323","#DB4343","#3FFF00","#CC1C57","#CC4196"]},initialize:function(c){var f=L.Util.extend({},L.VesselWaypoint.STYLE);
if("event_type"in c&&(f.fillColor=c.event_type>0&&c.event_type<L.VesselWaypoint.EVENT_COLORS.length?L.VesselWaypoint.EVENT_COLORS[c.event_type]:L.VesselWaypoint.EVENT_COLORS[0],c.event_type==1))f.radius=4;L.CircleMarker.prototype.initialize.call(this,[c.latitude,c.longitude],f);this.waypoint=L.Util.extend({},c);"description"in c&&this.bindHoverPopup(c.description)},openHoverPopup:function(){this.hovered=!0;this._hoverpopup&&this._map&&(this._hoverpopup.setLatLng(this._latlng),this._map.openPopup(this._hoverpopup));
return this},closeHoverPopup:function(){this.hovered=!1;this._hoverpopup&&this._hoverpopup._close();return this},bindHoverPopup:function(c,f){var h=new L.Point(0,-8),h=h.add(L.Popup.prototype.options.offset);f&&f.offset&&(h=h.add(f.offset));f=L.Util.extend({offset:h,closeButton:!1,autoPan:!1},f);this._hoverpopup||(this.on("mouseover",this.openHoverPopup,this),this.on("mouseout",this.closeHoverPopup,this));this._hoverpopup=(new L.Popup(f,this)).setContent(c);return this},unbindHoverPopup:function(){if(this._hoverpopup)this._hoverpopup=
null,this.off("mouseover",this.openHoverPopup,this),this.off("mouseout",this.closeHoverPopup,this);return this},indicate:function(){this.setStyle({fillOpacity:1});this.setRadius(this._radius+5);delay(1500,this,function(){try{this.setStyle({fillOpacity:L.VesselWaypoint.STYLE.fillOpacity}),this.setRadius(L.VesselWaypoint.STYLE.radius)}catch(c){}})}});L.VesselTrack=L.LayerGroup.extend({statics:{LINE_STYLE:{stroke:!0,color:"#ff0000",weight:1,opacity:0.8,fill:!1,fillColor:"#ff0000",fillOpacity:0.3,dashArray:"7,4",
clickable:!1}},initialize:function(c,f){if(f&&f.onClick)this._wp_click=f.onClick;var h=[],i;this.line=null;if(typeof c==="object"&&"length"in c){c.sort(function(a,b){if(typeof a.created=="string")a.created=new Date(a.created);if(typeof b.created=="string")b.created=new Date(b.created);return a.created<b.created?-1:a.created>b.created?1:0});var b=[];if(c.length){var d=Math.floor(c.length/10);for(i=0;i<c.length;i++)if(b.push([c[i].latitude,c[i].longitude]),h.push(new L.VesselWaypoint(c[i])),"courseoverground"in
c[i]){var a={latitude:c[i].latitude,longitude:c[i].longitude,orientation:c[i].courseoverground,is_moving:!0,icon:"tanker"};i%d==0&&(a=new L.Vessel(a,{selectable:!1}),"description"in c[i]&&a.bindHoverPopup(c[i].description),h.push(a))}}this.line=new L.Polyline(b,L.VesselTrack.LINE_STYLE)}L.LayerGroup.prototype.initialize.call(this,h)},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){this.line.bringToFront();return this.invoke("bringToFront")},bringToBack:function(){this.line.bringToBack();
return this.invoke("bringToBack")},getBounds:function(){var c=new L.LatLngBounds;this.eachLayer(function(f){c.extend(f instanceof L.Marker?f.getLatLng():f.getBounds())},this);return c},onAdd:function(c){this._map=c;c.addLayer(this.line);this.line.bringToBack();this.eachLayer(c.addLayer,c);this._wp_click&&this.eachLayer(this._bindWpClick,this)},onRemove:function(c){this._wp_click&&this.eachLayer(this._unbindWpClick,this);this.eachLayer(c.removeLayer,c);c.removeLayer(this.line);this._map=null},_bindWpClick:function(c){c.on("click",
this._wp_click,c)},_unbindWpClick:function(c){c.off("click",this._wp_click,c)},getWaypointAt:function(c){var c=L.latLng(c),f;for(f in this._layers)if(this._layers.hasOwnProperty(f)&&this._layers[f].getLatLng&&this._layers[f].getLatLng().equals(c))return this._layers[f];return null},getWaypoint:function(c){for(var f in this._layers)if(this._layers.hasOwnProperty(f)&&this._layers[f].waypoint&&this._layers[f].waypoint.id==c)return this._layers[f];return null}});L.Control.JakZoom=L.Control.Zoom.extend({_zoomLevelPort:14,
_zoomLevelSea:10,_zoomPort:function(){this._map.setView(this._map.zoomTarget?this._map.zoomTarget.getLatLng():this._map.getCenter(),this._zoomLevelPort)},_zoomSea:function(){this._map.setView(this._map.zoomTarget?this._map.zoomTarget.getLatLng():this._map.getCenter(),this._zoomLevelSea)},_zoomWorld:function(){this._map.fitWorld()},onAdd:function(c){var f=L.DomUtil.create("div","leaflet-control-zoom leaflet-bar");this._map=c;this._zoomInButton=this._createButton("","Zoom in","leaflet-control-zoom-in leaflet-bar-part leaflet-bar-part-top",
f,this._zoomIn,this);this._zoomPortButton=this._createButton("","Zoom port","leaflet-control-zoom-port leaflet-bar-part leaflet-bar-part-top",f,this._zoomPort,this);this._zoomSeaButton=this._createButton("","Zoom sea","leaflet-control-zoom-sea leaflet-bar-part leaflet-bar-part-top",f,this._zoomSea,this);this._zoomWorldButton=this._createButton("","Zoom world","leaflet-control-zoom-world leaflet-bar-part leaflet-bar-part-top",f,this._zoomWorld,this);this._zoomOutButton=this._createButton("","Zoom out",
"leaflet-control-zoom-out leaflet-bar-part leaflet-bar-part-bottom",f,this._zoomOut,this);c.on("zoomend",this._updateDisabled,this);return f}});L.Control.JakControl=L.Control.extend({options:{position:"topleft"},onAdd:function(c){var f=L.DomUtil.create("div","leaflet-control-functions");c.locatebutton&&this._createButton("","Locate","leaflet-control-functions-locate",f,c.locate,c);this._createButton("","Refresh","leaflet-control-functions-refreshdata",f,c.refreshdata,c);return f},_createButton:function(c,
f,h,i,b,d){h=L.DomUtil.create("a",h,i);h.innerHTML=c;h.href="#";h.title=f;c=L.DomEvent.stopPropagation;L.DomEvent.on(h,"click",c).on(h,"mousedown",c).on(h,"dblclick",c).on(h,"click",L.DomEvent.preventDefault).on(h,"click",b,d);return h}});L.Control.JakZoomMobile=L.Control.extend({options:{position:"topleft"},_zoomLevelPort:14,_zoomLevelSea:10,_zoomPort:function(){this._map.setView(this._map.zoomTarget?this._map.zoomTarget.getLatLng():this._map.getCenter(),this._zoomLevelPort)},_zoomSea:function(){this._map.setView(this._map.zoomTarget?
this._map.zoomTarget.getLatLng():this._map.getCenter(),this._zoomLevelSea)},_zoomWorld:function(){this._map.fitWorld()},_createButton:function(c,f,h,i,b,d){h=L.DomUtil.create("a",h,i);h.innerHTML=c;h.href="#";h.title=f;c=L.DomEvent.stopPropagation;L.DomEvent.on(h,"click",c).on(h,"mousedown",c).on(h,"dblclick",c).on(h,"click",L.DomEvent.preventDefault).on(h,"click",b,d);return h},onAdd:function(c){var f=L.DomUtil.create("div","leaflet-control-zoom leaflet-bar");this._map=c;this._zoomPortButton=this._createButton("",
"Zoom port","leaflet-control-zoom-port leaflet-bar-part leaflet-bar-part-top",f,this._zoomPort,this);this._zoomSeaButton=this._createButton("","Zoom sea","leaflet-control-zoom-sea leaflet-bar-part leaflet-bar-part-top",f,this._zoomSea,this);this._zoomWorldButton=this._createButton("","Zoom world","leaflet-control-zoom-world leaflet-bar-part leaflet-bar-part-top",f,this._zoomWorld,this);return f}});L.Control.JakInfo=L.Control.extend({initialize:function(c){L.Util.setOptions(this,c)},onAdd:function(){var c=
L.DomUtil.create("div","leaflet-control-info");if("content"in this.options)$(c).html(this.options.content);else if("content_ref"in this.options){var f=$(this.options.content_ref);f.detach();$(c).append(f);f.css("display","block")}return c},getContainer:function(){if(this.hasOwnProperty("_container"))return this._container;return null},setContent:function(c){this.hasOwnProperty("_container")&&$(this._container).html(c)},show:function(){this.hasOwnProperty("_container")&&(this._container.is(":visible")||
$(this._container).show())},hide:function(){this.hasOwnProperty("_container")&&$(this._container).is(":visible")&&$(this._container).show()},fadeIn:function(){this.hasOwnProperty("_container")&&($(this._container).is(":visible")||$(this._container).fadeIn("fast"))},fadeOut:function(){this.hasOwnProperty("_container")&&this._container.is(":visible")&&$(this._container).fadeOut("fast")}})})();
L.Ellipse=L.Path.extend({initialize:function(c,f,h,i){L.Path.prototype.initialize.call(this,i);this._latlng=L.latLng(c);this._tiltDeg=h?h:0;if(f)this._mRadiusX=f.x,this._mRadiusY=f.y},options:{fill:!0,startAngle:0,endAngle:359.9},setLatLng:function(c){this._latlng=L.latLng(c);return this.redraw()},setRadius:function(c){this._mRadiusX=c.x;this._mRadiusY=c.y;return this.redraw()},setTilt:function(c){this._tiltDeg=c;return this.redraw()},projectLatlngs:function(){var c=this._getLngRadius(),f=this._getLatRadius(),
h=this._latlng,c=this._map.latLngToLayerPoint([h.lat,h.lng-c]),f=this._map.latLngToLayerPoint([h.lat-f,h.lng]);this._point=this._map.latLngToLayerPoint(h);this._radiusX=Math.max(this._point.x-c.x,1);this._radiusY=Math.max(f.y-this._point.y,1);this._endPointParams=this._centerPointToEndPoint()},getBounds:function(){var c=this._getLngRadius(),f=this._getLatRadius(),h=this._latlng;return new L.LatLngBounds([h.lat-f,h.lng-c],[h.lat+f,h.lng+c])},getLatLng:function(){return this._latlng},getPathString:function(){var c=
this._point,f=this._radiusX,h=this._radiusY,i=this._tiltDeg,b=this._endPointParams;if(this._checkIfEmpty())return"";return L.Browser.svg?"M"+b.x0+","+b.y0+"A"+f+","+h+","+i+","+b.largeArc+","+b.sweep+","+b.x1+","+b.y1+" z":(c._round(),f=Math.round(f),h=Math.round(h),"AL "+c.x+","+c.y+" "+f+","+h+" "+i+",23592600")},getRadius:function(){return new L.Point(this._mRadiusX,this._mRadiusY)},_centerPointToEndPoint:function(){var c=this._point,f=this._radiusX,h=this._radiusY,i=(this.options.startAngle+this.options.endAngle)*
L.LatLng.DEG_TO_RAD,b=this.options.startAngle*L.LatLng.DEG_TO_RAD,d=this.options.endAngle,a=this._tiltDeg*L.LatLng.DEG_TO_RAD;return{x0:c.x+Math.cos(a)*f*Math.cos(b)+Math.sin(-a)*h*Math.sin(b),y0:c.y+Math.sin(a)*f*Math.cos(b)+Math.cos(a)*h*Math.sin(b),tilt:a,largeArc:d>180?1:0,sweep:d>0?1:0,x1:c.x+Math.cos(a)*f*Math.cos(i)+Math.sin(-a)*h*Math.sin(i),y1:c.y+Math.sin(a)*f*Math.cos(i)+Math.cos(a)*h*Math.sin(i)}},_getLatRadius:function(){return this._mRadiusY/40075017*360},_getLngRadius:function(){return this._mRadiusX/
40075017*360/Math.cos(L.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var c=this._map._pathViewport,f=this._radiusX,h=this._point;return h.x-f>c.max.x||h.y-f>c.max.y||h.x+f<c.min.x||h.y+f<c.min.y}});L.ellipse=function(c,f,h,i){return new L.Ellipse(c,f,h,i)};
(function(){L.calc={R_EARTH:6378137,rad:function(c){return c*L.LatLng.DEG_TO_RAD},deg:function(c){return c*L.LatLng.RAD_TO_DEG},roundFloat:function(c,f){parseInt(f)||(f=0);if(!parseFloat(c))return!1;return Math.round(c*Math.pow(10,f))/Math.pow(10,f)},degToMeter:function(c){return c*L.calc.R_EARTH*Math.PI/180},meterToDeg:function(c){return c*180/(L.calc.R_EARTH*Math.PI)},nextLatLng:function(c,f,h){var i=L.calc.rad(c.lat),c=L.calc.rad(c.lng),b=L.calc.rad(f),h=L.calc.rad(h),f=Math.sin(i),i=Math.cos(i),
d=Math.sin(b),a=Math.cos(b),b=Math.asin(f*a+i*d*Math.cos(h));c+=Math.atan2(Math.sin(h)*d*i,a-f*Math.sin(b));return new L.LatLng(L.calc.deg(b),L.calc.deg(c))},heading:function(c,f){var h=L.calc.rad(c.lat),i=L.calc.rad(f.lat),b=L.calc.rad(f.lng-c.lng);return(L.calc.deg(Math.atan2(Math.sin(b)*Math.cos(i),Math.cos(h)*Math.sin(i)-Math.sin(h)*Math.cos(i)*Math.cos(b)))+180)%360}};L.QuickHull={getDistant:function(c,f){return(f[0].lng-f[1].lng)*(c.lat-f[0].lat)+(f[1].lat-f[0].lat)*(c.lng-f[0].lng)},findMostDistantPointFromBaseLine:function(c,
f){var h=0,i=null,b=[],d,a,e;for(d=f.length-1;d>=0;d--)a=f[d],e=this.getDistant(a,c),e>0&&(b.push(a),e>h&&(h=e,i=a));return{maxPoint:i,newPoints:b}},buildConvexHull:function(c,f){var h=[],i=this.findMostDistantPointFromBaseLine(c,f);return i.maxPoint?(h=h.concat(this.buildConvexHull([c[0],i.maxPoint],i.newPoints)),h=h.concat(this.buildConvexHull([i.maxPoint,c[1]],i.newPoints))):[c[0]]},getConvexHull:function(c){var f=!1,h=!1,i=null,b=null,d;for(d=c.length-1;d>=0;d--){var a=c[d];if(f===!1||a.lat>f)i=
a,f=a.lat;if(h===!1||a.lat<h)b=a,h=a.lat}return[].concat(this.buildConvexHull([b,i],c),this.buildConvexHull([i,b],c))}};L.Polygon.prototype.contains=function(c){for(var f=!1,c=L.CRS.EPSG3857.project(c),h=L.CRS.EPSG3857.project(this._latlngs[this._latlngs.length-1]),i=0;i<this._latlngs.length;i++){var b=L.CRS.EPSG3857.project(this._latlngs[i]);b.y>c.y!=h.y>c.y&&c.x<(h.x-b.x)*(c.y-b.y)/(h.y-b.y)+b.x&&(f=!f);h=b}return f}})();$(document).ready(function(){$(".jThumbnailScroller_wrapper .showAll").bind("click",function(){$(".dataTables_processing").each(function(){var c=$(this).height()/2,h=$(this).width()/2;$(this).css("margin-left","-"+h+"px").css("margin-top","-"+c+"px")});if($(".jThumbnailScroller_wrapper.show").length)$(this).text(gettext("Show all photos")),$(".jThumbnailScroller_wrapper .showAll").addClass("collapsed").removeClass("expanded"),$(".jThumbnailScroller").animate({height:"200px"},700),$(".jThumbnailScroller_wrapper").removeClass("show");
else if($(".jThumbnailScroller_wrapper.loaded").length)$(".jTscrollerContainer .jTscroller").delay(200).queue(function(){var c=0,h=$(".jThumbnailScroller_wrapper .jTscroller").children("ul:has(li)"),c=$(".jThumbnailScroller_wrapper .jTscroller ul").height();h.length>0&&(c=h.first().height(),c*=h.length);$(".jThumbnailScroller_wrapper .jTscroller").css({left:"0"});$(".jThumbnailScroller_wrapper").addClass("show").addClass("loaded");$(".jThumbnailScroller").stop(!0,!0);$(".jThumbnailScroller").animate({height:c+
"px"},700);$(".jThumbnailScroller .loading").fadeOut("fast");$(this).clearQueue();$(this).dequeue()});else{var c=$(this).attr("data-url");$(this).text(gettext("Collapse"));$(".jThumbnailScroller_wrapper .showAll").addClass("expanded").removeClass("collapsed");$(".jThumbnailScroller .loading").fadeIn("fast");$.ajax({url:c,cache:!1}).done(function(c){$(".jTscrollerContainer > .jTscroller").append(c);$(".jTscrollerContainer > .jTscroller").delay(1E3).queue(function(){var c=0,f=$(".jThumbnailScroller_wrapper .jTscroller").children("ul:has(li)"),
c=$(".jThumbnailScroller_wrapper .jTscroller ul").height();f.length>0&&(c=f.first().height(),c*=f.length);$(".jThumbnailScroller_wrapper .jTscroller").css({left:"0"});$(".jThumbnailScroller_wrapper").addClass("show").addClass("loaded");$(".jThumbnailScroller").stop(!0,!0);thumbnail_fancybox();$(".jThumbnailScroller").animate({height:c+"px"},700);$(".vessel_thumb_photo .thumb_owner").hover(function(){$("> a:first-child",$(this)).css("display","none");$(".userInfoSnippet",$(this)).show()},function(){$(".userInfoSnippet",
$(this)).hide();$("> a:first-child",$(this)).css("display","table")});$(".jThumbnailScroller .loading").fadeOut("fast");$(this).clearQueue();$(this).dequeue()})})}});$(".jThumbnailScroller_wrapper ul li.box").length===0?($(".jThumbnailScroller_wrapper ul li.box:last-child").after("<li class='box empty'></li><li class='box empty'></li><li class='box empty'></li><li class='box empty last-element'></li>"),$(".jThumbnailScroller_wrapper ul li.box.empty").append("<div class='vessel_thumb_photo'></div>")):
$(".jThumbnailScroller_wrapper ul li.box").length===1?($(".jThumbnailScroller_wrapper ul li.box:last-child").after("<li class='box empty'></li><li class='box empty'></li><li class='box empty last-element'></li>"),$(".jThumbnailScroller_wrapper ul li.box.empty").append("<div class='vessel_thumb_photo'></div>")):$(".jThumbnailScroller_wrapper ul li.box").length===2?($(".jThumbnailScroller_wrapper ul li.box:last-child").after("<li class='box empty'></li><li class='box empty last-element'></li>"),$(".jThumbnailScroller_wrapper ul li.box.empty").append("<div class='vessel_thumb_photo'></div>")):
$(".jThumbnailScroller_wrapper ul li.box").length===3&&($(".jThumbnailScroller_wrapper ul li.box:last-child").after("<li class='box empty last-element'></li>"),$(".jThumbnailScroller_wrapper ul li.box.empty").append("<div class='vessel_thumb_photo'></div>"));$(".vessel_thumb_photo .thumb_owner").hover(function(){$("> a:first-child",$(this)).css("display","none");$(".userInfoSnippet",$(this)).show()},function(){$(".userInfoSnippet",$(this)).hide();$("> a:first-child",$(this)).css("display","table")})});/*
 http://www.apache.org/licenses/LICENSE-2.0

 modifiziert f?r unseren Gebrauch

*/
(function(c){c.fn.photo_gallery=function(){function f(){C!=0&&(C--,i())}function h(){C!=B-1&&(C++,i())}function i(){clearTimeout(w);j.animate({left:-(C*P)},500);B>1&&(C<=0?m.children("li:first").fadeOut():m.children("li:first").fadeIn(),C>=B-1?m.children("li:last").fadeOut():m.children("li:last").fadeIn());var a=C+1;a>=B&&(a=0);j.children('li[pos="'+a*o+'"]').length||d(a);q&&(C>=B-1?H=-1:C<=0&&(H=1),w=H>0?setTimeout(h,q):setTimeout(f,q))}function b(a){a.find('.js-imageview-group[fancy!="1"]').each(function(){var a=
'<div id="fancybox-title-over" class="strong">'+$(this).next().first().html()+"</div>";c(this).fancybox({transitionIn:"elastic",transitionOut:"elastic",speedIn:300,speedOut:300,titleShow:!0,titlePosition:"outside",titleFormat:function(){return a}});c(this).attr("fancy","1")})}function d(b){c.ajax({type:"GET",url:r,data:{page:b},success:function(d){var e=b*o-1,g=j.children("li").first();j.children("li").each(function(){var a=c(this);a.attr("pos")>g.attr("pos")&&a.attr("pos")<=e&&(g=a)});d=c(d).filter("li");
g.after(d);a(d,e+1)}})}function a(a,d){a.each(function(a){c(this).attr("pos",d+a)});a.children("a").children("img").css("width",k).css("height",p);a.css("width",k+"px");a.show();b(a)}var e=c(this),g=e.find("div.photo_gallery_mask"),j=e.find("div.photo_gallery_mask > ul:first"),m=e.find("ul.photo_gallery_nav");if(!e.length||!g.length||!m.length||!j.find("li").length)return e.append(gettext("Require content")),null;var q=e.attr("scroll_interval")?e.attr("scroll_interval"):"0",k=e.attr("images_width")?
e.attr("images_width"):"220",p=e.attr("images_height")?e.attr("images_height"):"140",o=e.attr("show_count")?e.attr("show_count"):"4",n=e.attr("total_count")?e.attr("total_count"):"0",r=String(e.attr("req_path")?e.attr("req_path"):""),s=e.attr("nav_width")?e.attr("nav_width"):"25",z=e.attr("nav_height")?e.attr("nav_height"):"200",v=e.attr("nav_space")?e.attr("nav_space"):"5",E=e.attr("hide_border")!==void 0?e.attr("hide_border"):"0",y=e.attr("auto_scroll")!==void 0?e.attr("auto_scroll"):"0",q=parseInt(q),
k=parseInt(k),p=parseInt(p),o=parseInt(o),n=parseInt(n),s=parseInt(s),z=parseInt(z),v=parseInt(v),E=parseInt(E),y=parseInt(y),w,H=1,C=0,P,y=j.children("li").length;n==0&&(n=y);var B=Math.ceil(n/o);B<2&&(q=0);j.children("li").children("a").children("img").css("width",k).css("height",p);if(B==1)m.children("li").css("display","none");else{var y=m.children("li:first"),O=m.children("li:last");m.children("li").css("width",s+"px");m.children("li").css("height",z+"px");m.children("li").css("background-image",
'url("'+ds.STATIC_URL+'images/arrow.gif")');O.css("background-position","right top");m.children("li").css("background-repeat","no-repeat");O.css("right",v+"px");y.css("left",v+"px")}j.children("li").each(function(a){c(this).attr("pos",a)});j.children("li").css("width",k+"px");y=j.children("li").outerWidth(!0)*n;j.children("li").hide();j.children("li").slice(0,o).show();P=j.outerWidth();n=e.find("div.photo_gallery_mask > ul:first > li:first").outerHeight();j.width(y);y=P;B>1?(g.css("margin-left",s+
2*v+"px"),g.css("margin-right",s+2*v+"px"),y+=2*s+4*v):E||(g.css("margin-left","0px"),g.css("margin-right","0px"),y+=20);e.width(y);e.height(n);g.width(P);g.height(n);j.children("li").show();e.css("position","relative");j.css("position","absolute");g.width(P);g.height(n);m.css("top",(n-z)/2+"px");m.width(y);E&&e.css("border","none");g=(e.parent().width()-e.outerWidth())/2;e.css("margin-left",g+"px");e.css("margin-right",g+"px");b(j.children("li"));i();m.children("li").hover(function(){$(this).parent().children().index($(this))==
0?$(this).css("background-position","left -"+z+"px"):$(this).parent().children().index($(this))==1&&$(this).css("background-position","right -"+z+"px")},function(){$(this).parent().children().index($(this))==0?$(this).css("background-position","left top"):$(this).parent().children().index($(this))==1&&$(this).css("background-position","right top")});m.children("li").click(function(){$(this).parent().children().index($(this))==0?f():$(this).parent().children().index($(this))==1&&h()})}})(jQuery);function _act_user_info_hover(){$.each($(".thumbnail .thumb_owner"),function(){$(this).hover(function(){$(this).find("a:first").css("display","none");$(this).find(".userInfoSnippet").show()},function(){$(this).find("a:first").css("display","table");$(this).find(".userInfoSnippet").hide()})})};$(document).ready(function(){$("a.nav-icon.favs-add").click(vessel_fav_handler);$("a.nav-icon.favs-del").click(vessel_fav_handler);$("div#tabs ul > li > a").click(function(c){c.preventDefault();$("div#tabs ul > li.ui-state-active").removeClass("ui-state-active");$(this).parent("li:first").addClass("ui-state-active");var c=$(this).attr("href"),f=$(c),c=c.replace("#tab_","");f.html().length?($("div#tabs .tab_content:not(.tab_hidden)").addClass("tab_hidden"),f.removeClass("tab_hidden"),$.ajax("?notify=1&tab="+
c)):($("div#loadmessage").show(),$.get("?tab="+c,function(b){f.contents().remove();f.append($(b));f.hasClass("tab_hidden")&&($("div#tabs .tab_content:not(.tab_hidden)").addClass("tab_hidden"),f.removeClass("tab_hidden"));$("div#loadmessage").hide();$(".tooltip-bs").tooltip();$(".tooltip-bs-html").tooltip({html:!0})}))});$("div#tab_vesseldata").on("click",'input[name="toggle-hidevessel"]',function(c){c.preventDefault();$.ajax({type:"POST",url:$("form#vesselreport-form").attr("action"),data:{h:$(this).data("param")},
context:this,success:function(c){"success"in c&&c.success&&($("#vesselhidden-display").html(gettext($(this).data("param"))),$(this).data("param",$(this).data("param")=="yes"?"no":"yes"),c=$(this).data("alt_value"),$(this).data("alt_value",$(this).val()),$(this).val(c))}})});var c=function(){$(".js-submit").css("visibility","hidden");$(".js-editSwitch").html(gettext("Edit Datasheet"))},f=function(){$(".chzn-select").chosen();$(".js-submit").css("visibility","visible");$(".js-editSwitch").html(gettext("Cancel"))};
$("div#tab_vesseldata").on("click","form#vesselreport-form .js-editSwitch",function(){$.ajax({type:"GET",url:$("form#vesselreport-form").attr("action"),data:{e:$("#extended_info").hasClass("display")?"yes":"no"},success:function(h){$("#extended_info").replaceWith(h);$("#extended_info").hasClass("display")?c():(f(),$("html, body").animate({scrollTop:$("#vessel-edit-info").offset().top-70},800))}})});$("div#tab_vesseldata").on("click","form#vesselreport-form .js-submit",function(){var h=$("#id_wiki").data("redactor");
h!=null&&(h.toggle(),h.toggle());$.ajax({type:"POST",url:$("form#vesselreport-form").attr("action"),data:$("form#vesselreport-form").serialize()+"&e=yes",success:function(h){$("#extended_info").replaceWith(h);$("#extended_info").hasClass("display")?c():f()}})})});
$(document).ready(function(){var c=new L.TileLayer.OpenStreetMap.FMProxy,f=new L.TileLayer.Bing({type:"AerialWithLabels"}),h=new L.TileLayer.Bing({type:"Road"});if($("#vesselpos_map").length){var i=L.map("vesselpos_map",{zoomControl:!1,attributionControl:!1,minZoom:1,maxBounds:new L.LatLngBounds([-82,-360],[82,360]),worldCopyJump:!0,layers:[c]});i.on("load",function(){(new L.Control.Layers({OpenStreetMap:c,"Bing - Aerial":f,"Bing - Road":h},null,{position:"bottomright"})).addTo(this);(new L.Control.JakZoom({position:"topright"})).addTo(this);
(new L.Control.Scale({position:"bottomleft"})).addTo(this);this.vesselMarker=null;var b=0,d=null,a,e=this;a=function(){$.ajax({cache:!1,type:"GET",data:{formap:"posmap"},dataType:"json",context:e,beforeSend:function(){d&&(clearTimeout(d),d=null)},error:function(){b++;b<100&&setTimeout(a,12E4)},success:function(c){e.vesselMarker?e.removeLayer(e.vesselMarker):e.setView([c.latitude,c.longitude],4);e.vesselMarker=(new L.Vessel(c,{selectable:!1})).addTo(e);e.zoomTarget=e.vesselMarker;b++;b<100&&setTimeout(a,
12E4)}})};a()});i.fitWorld()}});
var initVesselEventsMap=function(){var c=new L.TileLayer.OpenStreetMap.FMProxy,f=new L.TileLayer.Bing({type:"AerialWithLabels"}),h=new L.TileLayer.Bing({type:"Road"}),i=c;"vesselev_maplayer"in window&&(window.vesselev_maplayer=="BingRoad"?i=h:window.vesselev_maplayer=="BingAerial"&&(i=f));i=L.map("vesselev_map",{zoomControl:!1,attributionControl:!1,minZoom:1,maxBounds:new L.LatLngBounds([-82,-360],[82,360]),worldCopyJump:!1,layers:[i]});i.updateRequest=null;i.handleUpdate=function(b){this.vesselMarker?
(this.removeLayer(this.vesselMarker),this.removeLayer(this.vesselTrack)):(this.invalidateSize(),b.bounds?this.fitBounds([[b.bounds.min_lat,b.bounds.min_lon],[b.bounds.max_lat,b.bounds.max_lon]]):this.setView([b.vessel.latitude,b.vessel.longitude],4));this.vesselMarker=(new L.Vessel(b.vessel,{selectable:!1,opacity:0})).addTo(this);this.vesselTrack=(new L.VesselTrack(b.track)).addTo(this);this.zoomTarget=this.vesselMarker};i.doUpdate=function(){if(this.updateRequest){var b=this.updateRequest;this.updateRequest=
null;b.abort()}this.updateRequest=$.ajax({cache:!1,type:"GET",data:{formap:"evmap"},dataType:"json",context:this,error:function(b){if(b==this.updateRequest)this.updateRequest=null},success:function(b,a,c){if(this.updateRequest==c)this.updateRequest=null,this.handleUpdate(b)}})};i.gotoEvent=function(b){if(b=this.vesselTrack.getWaypoint(b))b.indicate(),this.panTo(b.getLatLng())};i.on("load",function(){(new L.Control.Layers({OpenStreetMap:c,"Bing - Aerial":f,"Bing - Road":h},null,{position:"bottomright"})).addTo(this);
(new L.Control.JakZoom({position:"topright"})).addTo(this);(new L.Control.Scale({position:"bottomleft"})).addTo(this);this.doUpdate()});i.on("baselayerchange",function(b){var c;b.layer instanceof L.TileLayer.OpenStreetMap.FMProxy?c="Osm":b.layer instanceof L.TileLayer.Bing&&(b.layer.options.type=="Road"?c="BingRoad":b.layer.options.type=="AerialWithLabels"&&(c="BingAerial"));c&&$.ajax({cache:!1,type:"POST",data:{formap:"evmap",layer:c}})});"ds"in window||(window.ds={});"widgets"in window.ds||(window.ds.widgets=
{});"maps"in window.ds.widgets||(window.ds.widgets.maps={});ds.widgets.maps.vesselevents=i;i.fitWorld()};
ds.initDetailTabPositionReports=function(){$(".map-container").on("click",".map-switch",function(c){c.preventDefault();c.stopPropagation();$(c.target).attr("href");c=$(c.target).attr("data-visible");$.ajax({cache:!1,type:"POST",data:{formap:"evmap",visible:c},context:$(".map-container"),success:function(c){this.empty();this.append($(c));$("#vesselev_map",this).length&&(initVesselEventsMap(),$("#vesselevents").on("click","tr",function(){var c=$(this).attr("id");ds.widgets.maps.vesselevents.gotoEvent(c)}))}})});
$("#vesselev_map").length&&(initVesselEventsMap(),$("#vesselevents").on("click","tr",function(){var c=$(this).attr("id");ds.widgets.maps.vesselevents.gotoEvent(c)}))};
ds.generate_vesselevents_chart=function(c,f,h){var i=[];i.push(["Time","Overall avg. speed","Overall max. speed","Speed in kn","Draught in m"]);if(c.length>0&&parseFloat(f)>0)for(var h=null,b=0;b<c.length;b++)f=[new Date(c[b].created)],ds.perm_avgmax?("speed_avg"in ds&&(b==0||b==c.length-1?f.push(ds.speed_avg):f.push(null)),"speed_max"in ds&&(b==0||b==c.length-1?f.push(ds.speed_max):f.push(null))):(f.push(-1),f.push(-1)),f.push(c[b].speedoverground),c[b].event_type==13?(h=c[b].event_numeric/10,f.push(h)):
h!==null?f.push(h):f.push(-1),i.push(f);else f=h?[h,0,0,0,0]:["no data",0,0,0,0],i.push(f);var i=google.visualization.arrayToDataTable(i),d=new google.visualization.LineChart(document.getElementById("chart_div"));google.visualization.events.addListener(d,"select",function(){var a=d.getSelection();if(a.length>0&&a[0].column!=null&&a[0].row!=null){var b=a[0].column,a=a[0].row;(b==3||b==4)&&c.length&&ds.widgets.maps.vesselevents.gotoEvent(c[a].event_id)}});d.draw(i,{series:{0:{color:"#ff9900",interpolateNulls:!0},
1:{color:"#dc3912"},2:{color:"#3366cc",pointSize:2},3:{color:"#FF75FF",pointSize:2,targetAxisIndex:1}},chartArea:{left:25,top:5,height:"80%",width:"95%"},legend:{position:"none"},vAxes:[{minValue:0,viewWindow:{min:0}},{minValue:0,viewWindow:{min:0}}],interpolateNulls:!0})};
ds.process_time_moving_and_time_absolute=function(){var c=parseFloat($("#time_moving").text()),f=parseFloat($("#time_absolute").text()),h=f==0?"0.0":(c/f*100).toFixed(2),c=Math.floor(c)+"h "+Math.floor((c-Math.floor(c))*60)+"m",f=Math.floor(f)+"h "+Math.floor((f-Math.floor(f))*60)+"m";$("#time_moving").text(c);$("#time_absolute").text(f);$("#time_moving_percent").text("("+h+"%)")};$(document).ready(function(){$(".tinyhovermap .center").hover(function(){$(".tinyhovermap_3").css("z-index","5").css("visibility","visible").animate({opacity:1},300)},function(){$(".tinyhovermap_3").animate({opacity:0},300,function(){$(this).css("z-index","1").css("visibility","hidden")})});$(".tinyhovermap").hover(function(){$(".tinyhovermap_2").css("z-index","4").css("visibility","visible").animate({opacity:1},300)},function(){$(".tinyhovermap_2").animate({opacity:0},300,function(){$(this).css("z-index",
"2").css("visibility","hidden")})})});(function(c){function f(b,c){var a;a=/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];if(!({name:a[1]||"",version:a[2]||"0"}.name==="msie"&&document.documentMode<=8))return new f.prototype.init(b,c)}var h=0,i=function(b){this[0]=b.startOffset;this[1]=b.endOffset;this.range=b;return this};i.prototype.equals=function(){return this[0]===this[1]};c.fn.redactor=function(b){var d=[],a=Array.prototype.slice.call(arguments,1);typeof b==="string"?this.each(function(){var e=c.data(this,"redactor");
if(typeof e!=="undefined"&&c.isFunction(e[b])){var g=e[b].apply(e,a);g!==void 0&&g!==e&&d.push(g)}else return c.error('No such method "'+b+'" for Redactor')}):this.each(function(){c.data(this,"redactor")||c.data(this,"redactor",f(this,b))});return d.length===0?this:d.length===1?d[0]:d};c.Redactor=f;c.Redactor.VERSION="9.0.1";c.Redactor.opts={initCallback:!1,changeCallback:!1,focusCallback:!1,blurCallback:!1,keydownCallback:!1,keyupCallback:!1,execCommandCallback:!1,pasteBeforeCallback:!1,pasteAfterCallback:!1,
autosaveCallback:!1,imageUploadCallback:!1,imageUploadErrorCallback:!1,imageDeleteCallback:!1,fileUploadCallback:!1,fileUploadErrorCallback:!1,rangy:!1,iframe:!1,fullpage:!1,css:!1,lang:"en",direction:"ltr",placeholder:!1,wym:!1,mobile:!0,cleanup:!0,visual:!0,focus:!1,tabindex:!1,autoresize:!0,minHeight:!1,shortcuts:!0,autosave:!1,autosaveInterval:60,plugins:!1,linkAnchor:!1,linkEmail:!1,linkProtocol:"http://",imageGetJson:!1,imageUpload:!1,fileUpload:!1,s3:!1,uploadFields:!1,observeImages:!0,modalOverlay:!0,
tabFocus:!0,air:!1,airButtons:["formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","fontcolor","backcolor"],toolbar:!0,toolbarFixed:!1,toolbarFixedTopOffset:0,toolbarFixedBox:!1,toolbarExternal:!1,buttonSource:!0,buttonSeparator:'<li class="redactor_separator"></li>',buttonsCustom:{},buttonsAdd:[],buttons:["html","|","formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","image","video","file","table","link",
"|","fontcolor","backcolor","|","alignment","|","horizontalrule"],colors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f",
"#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist","alignleft","aligncenter","alignright","justify","table"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",
u:"underline",tr:"table",td:"table",table:"table"},activeButtonsAdd:!1,formattingTags:["p","blockquote","pre","h1","h2","h3","h4"],linebreaks:!1,paragraphy:!0,convertDivs:!0,convertLinks:!0,formattingPre:!1,phpTags:!1,allowedTags:!1,deniedTags:["html","head","link","body","meta","script","style","applet"],boldTag:"strong",italicTag:"em",buffer:[],rebuffer:[],textareamode:!1,emptyHtml:"<p>&#x200b;</p>",invisibleSpace:"&#x200b;",alignmentTags:["H1","H2","H3","H4","H5","H6","P","TD","DIV","BLOCKQUOTE"],
ownLine:["area","body","head","hr","i?frame","link","meta","noscript","style","script","table","tbody","thead","tfoot"],contOwnLine:["li","dt","dt","h[1-6]","option","script"],newLevel:["blockquote","div","dl","fieldset","form","frameset","map","ol","p","pre","select","td","th","tr","ul"],blockLevelElements:["P","H1","H2","H3","H4","H5","H6","DD","DL","DT","DIV","LI","BLOCKQUOTE","OUTPUT","FIGCAPTION","PRE","ADDRESS","SECTION","HEADER","FOOTER","ASIDE","ARTICLE"],langs:{en:{html:"HTML",video:"Insert Video",
image:"Insert Image",table:"Table",link:"Link",link_insert:"Insert link",link_edit:"Edit link",unlink:"Unlink",formatting:"Formatting",paragraph:"Normal text",quote:"Quote",code:"Code",header1:"Header 1",header2:"Header 2",header3:"Header 3",header4:"Header 4",bold:"Bold",italic:"Italic",fontcolor:"Font Color",backcolor:"Back Color",unorderedlist:"Unordered List",orderedlist:"Ordered List",outdent:"Outdent",indent:"Indent",cancel:"Cancel",insert:"Insert",save:"Save",_delete:"Delete",insert_table:"Insert Table",
insert_row_above:"Add Row Above",insert_row_below:"Add Row Below",insert_column_left:"Add Column Left",insert_column_right:"Add Column Right",delete_column:"Delete Column",delete_row:"Delete Row",delete_table:"Delete Table",rows:"Rows",columns:"Columns",add_head:"Add Head",delete_head:"Delete Head",title:"Title",image_position:"Position",none:"None",left:"Left",right:"Right",image_web_link:"Image Web Link",text:"Text",mailto:"Email",web:"URL",video_html_code:"Video Embed Code",file:"Insert File",
upload:"Upload",download:"Download",choose:"Choose",or_choose:"Or choose",drop_file_here:"Drop file here",align_left:"Align text to the left",align_center:"Center text",align_right:"Align text to the right",align_justify:"Justify text",horizontalrule:"Insert Horizontal Rule",deleted:"Deleted",anchor:"Anchor",link_new_tab:"Open link in new tab",underline:"Underline",alignment:"Alignment",filename:"Name (optional)"}}};f.fn=c.Redactor.prototype={keyCode:{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,
TAB:9,CTRL:17,META:91,LEFT:37,LEFT_WIN:91},init:function(b,d){this.$element=this.$source=c(b);this.uuid=h++;this.opts=c.extend({},c.Redactor.opts,this.$element.data(),d);this.dropdowns=[];this.sourceHeight=this.$source.css("height");this.sourceWidth=this.$source.css("width");if(this.opts.fullpage)this.opts.iframe=!0;if(this.opts.linebreaks)this.opts.paragraphy=!1;if(this.opts.paragraphy)this.opts.linebreaks=!1;if(this.opts.toolbarFixedBox)this.opts.toolbarFixed=!0;this.document=document;this.window=
window;this.savedSel=!1;this.cleanlineBefore=RegExp("^<(/?"+this.opts.ownLine.join("|/?")+"|"+this.opts.contOwnLine.join("|")+")[ >]");this.cleanlineAfter=RegExp("^<(br|/?"+this.opts.ownLine.join("|/?")+"|/"+this.opts.contOwnLine.join("|/")+")[ >]");this.cleannewLevel=RegExp("^</?("+this.opts.newLevel.join("|")+")[ >]");this.rTestBlock=RegExp("^("+this.opts.blockLevelElements.join("|")+")$","i");if(this.opts.linebreaks===!1&&(this.opts.allowedTags!==!1&&c.inArray("p",this.opts.allowedTags)==="-1"&&
this.opts.allowedTags.push("p"),this.opts.deniedTags!==!1)){var a=c.inArray("p",this.opts.deniedTags);a!=="-1"&&this.opts.deniedTags.splice(a,a)}if(this.browser("msie")||this.browser("opera"))this.opts.buttons=this.removeFromArrayByValue(this.opts.buttons,"horizontalrule");this.opts.curLang=this.opts.langs[this.opts.lang];this.buildStart()},initToolbar:function(b){return{html:{title:b.html,func:"toggle"},formatting:{title:b.formatting,func:"show",dropdown:{p:{title:b.paragraph,func:"formatBlocks"},
blockquote:{title:b.quote,func:"formatQuote",className:"redactor_format_blockquote"},pre:{title:b.code,func:"formatBlocks",className:"redactor_format_pre"},h1:{title:b.header1,func:"formatBlocks",className:"redactor_format_h1"},h2:{title:b.header2,func:"formatBlocks",className:"redactor_format_h2"},h3:{title:b.header3,func:"formatBlocks",className:"redactor_format_h3"},h4:{title:b.header4,func:"formatBlocks",className:"redactor_format_h4"}}},bold:{title:b.bold,exec:"bold"},italic:{title:b.italic,
exec:"italic"},deleted:{title:b.deleted,exec:"strikethrough"},underline:{title:b.underline,exec:"underline"},unorderedlist:{title:"&bull; "+b.unorderedlist,exec:"insertunorderedlist"},orderedlist:{title:"1. "+b.orderedlist,exec:"insertorderedlist"},outdent:{title:"< "+b.outdent,func:"indentingOutdent"},indent:{title:"> "+b.indent,func:"indentingIndent"},image:{title:b.image,func:"imageShow"},video:{title:b.video,func:"videoShow"},file:{title:b.file,func:"fileShow"},table:{title:b.table,func:"show",
dropdown:{insert_table:{title:b.insert_table,func:"tableShow"},separator_drop1:{name:"separator"},insert_row_above:{title:b.insert_row_above,func:"tableAddRowAbove"},insert_row_below:{title:b.insert_row_below,func:"tableAddRowBelow"},insert_column_left:{title:b.insert_column_left,func:"tableAddColumnLeft"},insert_column_right:{title:b.insert_column_right,func:"tableAddColumnRight"},separator_drop2:{name:"separator"},add_head:{title:b.add_head,func:"tableAddHead"},delete_head:{title:b.delete_head,
func:"tableDeleteHead"},separator_drop3:{name:"separator"},delete_column:{title:b.delete_column,func:"tableDeleteColumn"},delete_row:{title:b.delete_row,func:"tableDeleteRow"},delete_table:{title:b.delete_table,func:"tableDeleteTable"}}},link:{title:b.link,func:"show",dropdown:{link:{title:b.link_insert,func:"linkShow"},unlink:{title:b.unlink,exec:"unlink"}}},fontcolor:{title:b.fontcolor,func:"show"},backcolor:{title:b.backcolor,func:"show"},alignment:{title:b.alignment,func:"show",dropdown:{alignleft:{title:b.align_left,
func:"alignmentLeft"},aligncenter:{title:b.align_center,func:"alignmentCenter"},alignright:{title:b.align_right,func:"alignmentRight"},justify:{title:b.align_justify,func:"alignmentJustify"}}},alignleft:{title:b.align_left,func:"alignmentLeft"},aligncenter:{title:b.align_center,func:"alignmentCenter"},alignright:{title:b.align_right,func:"alignmentRight"},justify:{title:b.align_justify,func:"alignmentJustify"},horizontalrule:{exec:"inserthorizontalrule",title:b.horizontalrule}}},callback:function(b,
d,a){b=this.opts[b+"Callback"];return c.isFunction(b)?d===!1?b.call(this,a):b.call(this,d,a):a},destroy:function(){clearInterval(this.autosaveInterval);c(window).off(".redactor");this.$element.off(".redactor").removeData("redactor");var b=this.get();if(this.opts.textareamode)this.$box.after(this.$source),this.$box.remove(),this.$source.val(b).show();else{var d=this.$editor;if(this.opts.iframe)d=this.$element;this.$box.after(d);this.$box.remove();d.removeClass("redactor_editor").removeClass("redactor_editor_wym").removeAttr("contenteditable").html(b).show()}},
get:function(){return this.$source.val()},getCodeIframe:function(){this.$editor.removeAttr("contenteditable").removeAttr("dir");var b=this.outerHtml(this.$frame.contents().children());this.$editor.attr({contenteditable:!0,dir:this.opts.direction});return b},set:function(b,c){b=b.toString();this.opts.fullpage?this.setCodeIframe(b):this.setEditor(b,c)},setEditor:function(b,c){c!==!1&&(b=this.cleanSavePreCode(b),b=this.cleanStripTags(b),b=this.cleanConvertProtected(b),b=this.cleanConvertInlineTags(b),
b=this.opts.linebreaks===!1?this.cleanConverters(b):b.replace(/<p(.*?)>([\w\W]*?)<\/p>/gi,"$2<br>"));b=this.cleanEmpty(b);this.$editor.html(b);this.sync()},setCodeIframe:function(b){var c=this.iframePage();this.$frame[0].src="about:blank";b=this.cleanConvertProtected(b);b=this.cleanConvertInlineTags(b);b=this.cleanRemoveSpaces(b);c.open();c.write(b);c.close();if(this.opts.fullpage)this.$editor=this.$frame.contents().find("body").attr({contenteditable:!0,dir:this.opts.direction});this.sync()},setFullpageOnInit:function(b){b=
this.cleanSavePreCode(b,!0);b=this.cleanConverters(b);b=this.cleanEmpty(b);this.$editor.html(b);this.sync()},sync:function(){var b="";this.cleanUnverified();b=this.opts.fullpage?this.getCodeIframe():this.$editor.html();b=this.syncClean(b);b=this.cleanRemoveSpaces(b);b=this.cleanRemoveEmptyTags(b);b=b.replace(/<\/li><(ul|ol)>([\w\W]*?)<\/(ul|ol)>/gi,"<$1>$2</$1></li>");c.trim(b)==="<br>"&&(b="");b!==""&&(b=this.cleanHtml(b));b=this.callback("syncBefore",!1,b);this.$source.val(b);typeof htmlEncode!=
"undefined"&&c("#"+this.$element[0].id+"_code").html(htmlEncode(b));this.callback("syncAfter",!1,b);this.callback("change",!1,b)},syncClean:function(b){this.opts.fullpage||(b=this.cleanStripTags(b));b=c.trim(b);b=this.placeholderRemoveFromCode(b);b=b.replace(/&#x200b;/gi,"");b=b.replace(/&#8203;/gi,"");b=b.replace(/&nbsp;/gi," ");b=b.replace("<\!--?php","<?php");b=b.replace("?--\>","?>");b=b.replace(/<span(.*?)data-redactor="verified"(.*?)>([\w\W]*?)<\/span>/gi,'<font$1data-redactor="verified"$2>$3</font>');
b=b.replace(/<span(.*?)>([\w\W]*?)<\/span>/gi,"$2");b=b.replace(/<font(.*?)data-redactor="verified"(.*?)>([\w\W]*?)<\/font>/gi,"<span$1$2>$3</span>");b=b.replace(/<br\s?\/?>\n?<\/(.*?)>/gi,"</$1>");b=b.replace(/<span(.*?)data-redactor-inlineMethods=""(.*?)>([\w\W]*?)<\/span>/gi,"<span$1$2>$3</span>");b=b.replace(/<span\s*?>([\w\W]*?)<\/span>/gi,"$1");b=b.replace(/<span\s*?id="selection-marker(.*?)"(.*?)>([\w\W]*?)<\/span>/gi,"");return b=this.cleanReConvertProtected(b)},buildStart:function(){this.content=
"";this.$box=c('<div class="redactor_box" />');if(this.$source[0].tagName==="TEXTAREA")this.opts.textareamode=!0;this.opts.mobile===!1&&this.isMobile()?this.buildMobile():(this.buildContent(),this.opts.iframe?(this.opts.autoresize=!1,this.iframeStart()):this.opts.textareamode?this.buildFromTextarea():this.buildFromElement(),this.opts.iframe||(this.buildOptions(),this.buildAfter()))},buildMobile:function(){if(!this.opts.textareamode)this.$editor=this.$source,this.$editor.hide(),this.$source=this.buildCodearea(this.$editor),
this.$source.val(this.content);this.$box.insertAfter(this.$source).append(this.$source)},buildContent:function(){this.content=this.opts.textareamode?c.trim(this.$source.val()):c.trim(this.$source.html())},buildFromTextarea:function(){this.$editor=c("<div />");this.$box.insertAfter(this.$source).append(this.$editor).append(this.$source);this.buildAddClasses(this.$editor);this.buildEnable()},buildFromElement:function(){this.$editor=this.$source;this.$source=this.buildCodearea(this.$editor);this.$box.insertAfter(this.$editor).append(this.$editor).append(this.$source);
this.buildEnable()},buildCodearea:function(b){return c("<textarea />").attr("name",b.attr("id")).css("height",this.sourceHeight)},buildAddClasses:function(b){c.each(this.$source.get(0).className.split(/\s+/),function(c,a){b.addClass("redactor_"+a)})},buildEnable:function(){this.$editor.addClass("redactor_editor").attr({contenteditable:!0,dir:this.opts.direction});this.$source.attr("dir",this.opts.direction).hide();this.set(this.content)},buildOptions:function(){var b=this.$editor;if(this.opts.iframe)b=
this.$frame;this.opts.tabindex&&b.attr("tabindex",this.opts.tabindex);this.opts.minHeight&&b.css("min-height",this.opts.minHeight+"px");this.opts.wym&&this.$editor.addClass("redactor_editor_wym");this.opts.autoresize||b.css("height",this.sourceHeight)},buildAfter:function(){if(this.opts.toolbar)this.opts.toolbar=this.initToolbar(this.opts.curLang),this.toolbarBuild();this.modalTemplatesInit();this.buildPlugins();this.browser("opera")||this.pasteInit();this.buildBindKeyboard();this.opts.autosave&&
this.autosave();setTimeout(c.proxy(this.observeStart,this),4);if(this.browser("mozilla"))try{this.document.execCommand("enableObjectResizing",!1,!1),this.document.execCommand("enableInlineTableEditing",!1,!1)}catch(b){}this.opts.focus&&setTimeout(c.proxy(this.focus,this),100);this.opts.visual||setTimeout(c.proxy(function(){this.opts.visual=!0;this.toggle(!1)},this),200);this.callback("init")},buildBindKeyboard:function(){this.$editor.on("keydown.redactor",c.proxy(function(b){var d=b.which,a=b.ctrlKey||
b.metaKey,e=this.getParent(),g=this.getCurrent(),f=this.getBlock(),h=!1;this.callback("keydown",b);if(e&&c(e).get(0).tagName==="PRE"||g&&c(g).get(0).tagName==="PRE")h=!0,d===this.keyCode.DOWN&&this.insertAfterLastElement(f);d===this.keyCode.DOWN&&(e&&c(e).get(0).tagName==="BLOCKQUOTE"&&this.insertAfterLastElement(e),g&&c(g).get(0).tagName==="BLOCKQUOTE"&&this.insertAfterLastElement(g));a&&!b.shiftKey&&this.shortcuts(b,d);if(a&&d===90&&!b.shiftKey&&!b.altKey)b.preventDefault(),this.opts.buffer.length?
this.bufferUndo():this.document.execCommand("undo",!1,!1);else if(a&&d===90&&b.shiftKey&&!b.altKey)b.preventDefault(),this.opts.rebuffer.length!=0?this.bufferRedo():this.document.execCommand("redo",!1,!1);else{if(a)if(d===65)this.selectall=!0;else if(d!=this.keyCode.LEFT_WIN&&!a)this.selectall=!1;if(d==this.keyCode.ENTER&&!b.shiftKey&&!b.ctrlKey&&!b.metaKey){if(e.nodeType==1&&(e.tagName=="TD"||e.tagName=="TH"))return this.insertNode(document.createElement("br")),b.preventDefault(),!1;if(h===!0)return this.bufferSet(),
b.preventDefault(),g=c(g).parent().text(),this.insertNode(document.createTextNode("\n")),g.search(/\s$/)==-1&&this.insertNode(document.createTextNode("\n")),this.sync(),!1;else{if(!this.opts.linebreaks)if(f&&/^(P|H[1-6]|LI|ADDRESS|SECTION|HEADER|FOOTER|ASIDE|ARTICLE)$/i.test(f.tagName))setTimeout(c.proxy(function(){var a=this.getBlock();if(a.tagName==="DIV"&&!c(a).hasClass("redactor_editor")){var b=c("<p>"+this.opts.invisibleSpace+"</p>");c(a).replaceWith(b);this.selectionStart(b)}},this),1);else if(f===
!1)return g=c("<p>"+this.opts.invisibleSpace+"</p>"),this.insertNode(g[0]),this.selectionStart(g),!1;if(this.opts.linebreaks)if(f&&/^(P|H[1-6]|LI|ADDRESS|SECTION|HEADER|FOOTER|ASIDE|ARTICLE)$/i.test(f.tagName))setTimeout(c.proxy(function(){var a=this.getBlock();(a.tagName==="DIV"||a.tagName==="P")&&!c(a).hasClass("redactor_editor")&&this.replaceLineBreak(a)},this),1);else{this.insertLineBreak();b.preventDefault();return}if(f.tagName=="BLOCKQUOTE"||f.tagName=="FIGCAPTION"){this.insertLineBreak();b.preventDefault();
return}}}else if(d===this.keyCode.ENTER&&(b.ctrlKey||b.shiftKey))this.bufferSet(),b.preventDefault(),this.insertLineBreak();if(d===this.keyCode.TAB&&this.opts.shortcuts){if(!this.opts.tabFocus)return!0;if(this.isEmpty(this.get()))return!0;b.preventDefault();h===!0&&!b.shiftKey?(this.bufferSet(),this.insertNode(document.createTextNode("\t")),this.sync()):b.shiftKey?this.indentingOutdent():this.indentingIndent();return!1}d===this.keyCode.BACKSPACE&&typeof g.nodeValue!=="undefined"&&g.nodeValue!==null&&
(b=c.trim(g.nodeValue.replace(/[^\u0000-~]/g,"")),g.remove&&g.nodeType===3&&g.nodeValue.charCodeAt(0)==8203&&b==""&&g.remove())}},this));this.$editor.on("keyup.redactor",c.proxy(function(b){var d=b.which,a=this.getParent(),e=this.getCurrent();if(!this.opts.linebreaks&&e.nodeType==3&&(a==!1||a.tagName=="BODY"))a=c("<p>").append(c(e).clone()),c(e).replaceWith(a),e=c(a).next(),e[0].tagName=="BR"&&e.remove(),this.selectionEnd(a);this.opts.convertLinks&&d===this.keyCode.ENTER&&this.formatLinkify(this.opts.linkProtocol);
if(this.opts.linebreaks===!1&&(d===this.keyCode.DELETE||d===this.keyCode.BACKSPACE))return this.formatEmpty(b);this.callback("keyup",b);this.sync()},this));if(c.isFunction(this.opts.focusCallback))this.$editor.on("focus.redactor",c.proxy(this.opts.focusCallback,this));if(c.isFunction(this.opts.blurCallback))this.$editor.on("blur.redactor",c.proxy(this.opts.blurCallback,this))},buildPlugins:function(){this.opts.plugins&&c.each(this.opts.plugins,c.proxy(function(b,d){RedactorPlugins[d]&&(c.extend(this,
RedactorPlugins[d]),c.isFunction(RedactorPlugins[d].init)&&this.init())},this))},iframeStart:function(){this.iframeCreate();this.opts.textareamode?this.iframeAppend(this.$source):(this.$sourceOld=this.$source.hide(),this.$source=this.buildCodearea(this.$sourceOld),this.iframeAppend(this.$sourceOld))},iframeAppend:function(b){this.$source.attr("dir",this.opts.direction).hide();this.$box.insertAfter(b).append(this.$frame).append(this.$source)},iframeCreate:function(){this.$frame=c('<iframe style="width: 100%;" frameborder="0" />').one("load",
c.proxy(function(){if(this.opts.fullpage){this.iframePage();if(this.content==="")this.content=this.opts.invisibleSpace;this.$frame.contents()[0].write(this.content);this.$frame.contents()[0].close();var b=setInterval(c.proxy(function(){this.$frame.contents().find("body").html()&&(clearInterval(b),this.iframeLoad())},this),0)}else this.iframeLoad()},this))},iframeDoc:function(){return this.$frame[0].contentWindow.document},iframePage:function(){var b=this.iframeDoc();b.documentElement&&b.removeChild(b.documentElement);
return b},iframeAddCss:function(b){b=b||this.opts.css;this.isString(b)&&this.$frame.contents().find("head").append('<link rel="stylesheet" href="'+b+'" />');c.isArray(b)&&c.each(b,c.proxy(function(b,a){this.iframeAddCss(a)},this))},iframeLoad:function(){this.$editor=this.$frame.contents().find("body").attr({contenteditable:!0,dir:this.opts.direction});if(this.$editor[0])this.document=this.$editor[0].ownerDocument,this.window=this.document.defaultView||window;this.iframeAddCss();this.opts.fullpage?
this.setFullpageOnInit(this.$editor.html()):this.set(this.content);this.buildOptions();this.buildAfter()},placeholderStart:function(b){if(this.isEmpty(b)){if(this.$element.attr("placeholder"))this.opts.placeholder=this.$element.attr("placeholder");if(this.opts.placeholder==="")this.opts.placeholder=!1;if(this.opts.placeholder!==!1)return this.opts.focus=!1,this.$editor.one("focus.redactor_placeholder",c.proxy(this.placeholderFocus,this)),c('<span class="redactor_placeholder" data-redactor="verified">').attr("contenteditable",
!1).text(this.opts.placeholder)}return!1},placeholderFocus:function(){this.$editor.find("span.redactor_placeholder").remove();var b="";if(this.opts.linebreaks===!1)b=this.opts.emptyHtml;this.$editor.off("focus.redactor_placeholder");this.$editor.html(b);this.opts.linebreaks===!1&&this.selectionStart(this.$editor.children()[0]);this.sync()},placeholderRemove:function(){this.opts.placeholder=!1;this.$editor.find("span.redactor_placeholder").remove();this.$editor.off("focus.redactor_placeholder")},placeholderRemoveFromCode:function(b){return b.replace(/<span class="redactor_placeholder"(.*?)>(.*?)<\/span>/i,
"")},shortcuts:function(b,c){this.opts.shortcuts&&(b.altKey?c===48?this.shortcutsLoadFormat(b,"p"):c===49?this.shortcutsLoadFormat(b,"h1"):c===50?this.shortcutsLoadFormat(b,"h2"):c===51?this.shortcutsLoadFormat(b,"h3"):c===52?this.shortcutsLoadFormat(b,"h4"):c===53?this.shortcutsLoadFormat(b,"h5"):c===54&&this.shortcutsLoadFormat(b,"h6"):c===77?this.shortcutsLoad(b,"removeFormat"):c===66?this.shortcutsLoad(b,"bold"):c===73?this.shortcutsLoad(b,"italic"):c===74?this.shortcutsLoad(b,"insertunorderedlist"):
c===75?this.shortcutsLoad(b,"insertorderedlist"):c===76?this.shortcutsLoad(b,"superscript"):c===72&&this.shortcutsLoad(b,"subscript"))},shortcutsLoad:function(b,c){b.preventDefault();this.execCommand(c,!1)},shortcutsLoadFormat:function(b,c){b.preventDefault();this.formatBlocks(c)},focus:function(){this.browser("opera")?this.$editor.focus():this.window.setTimeout(c.proxy(this.focusSet,this,!0),1)},focusEnd:function(){this.focusSet()},focusSet:function(b){this.$editor.focus();var c=this.getRange();
c.selectNodeContents(this.$editor[0]);c.collapse(b||!1);b=this.getSelection();b.removeAllRanges();b.addRange(c)},toggle:function(b){if(this.opts.visual){b!==!1&&this.selectionSave();var d=null;this.opts.iframe?(d=this.$frame.height(),this.opts.fullpage&&this.$editor.removeAttr("contenteditable"),this.$frame.hide()):(d=this.$editor.innerHeight(),this.$editor.hide());this.modified=b=this.$source.val();this.$source.height(d).show().focus();this.$source.on("keydown.redactor-textarea",function(a){if(a.keyCode===
9){var a=c(this),b=a.get(0).selectionStart;a.val(a.val().substring(0,b)+"\t"+a.val().substring(a.get(0).selectionEnd));a.get(0).selectionStart=a.get(0).selectionEnd=b+1;return!1}});this.buttonInactiveVisual();this.buttonActive("html");this.opts.visual=!1}else{b=this.$source.hide().val();if(typeof this.modified!=="undefined")this.modified=this.cleanRemoveSpaces(this.modified,!1)!==this.cleanRemoveSpaces(b,!1);this.modified&&(this.opts.fullpage&&b===""?this.setFullpageOnInit(b):(this.set(b),this.opts.fullpage&&
this.buildBindKeyboard()));this.opts.iframe?this.$frame.show():this.$editor.show();this.opts.fullpage&&this.$editor.attr("contenteditable",!0);this.$source.off("keydown.redactor-textarea");this.$editor.focus();this.selectionRestore();this.observeStart();this.buttonActiveVisual();this.buttonInactive("html");this.opts.visual=!0}},autosave:function(){var b=!1;this.autosaveInterval=setInterval(c.proxy(function(){var d=this.get();b!==d&&c.ajax({url:this.opts.autosave,type:"post",data:this.$source.attr("name")+
"="+escape(encodeURIComponent(d)),success:c.proxy(function(a){this.callback("autosave",!1,a);b=d},this)})},this),this.opts.autosaveInterval*1E3)},toolbarBuild:function(){if(this.opts.air)this.opts.buttons=this.opts.airButtons;else if(!this.opts.buttonSource){var b=this.opts.buttons.indexOf("html"),d=this.opts.buttons[b+1];this.opts.buttons.splice(b,1);d==="|"&&this.opts.buttons.splice(b,1)}c.extend(this.opts.toolbar,this.opts.buttonsCustom);c.each(this.opts.buttonsAdd,c.proxy(function(a,b){this.opts.buttons.push(b)},
this));this.opts.toolbar&&c.each(this.opts.toolbar.formatting.dropdown,c.proxy(function(a){c.inArray(a,this.opts.formattingTags)=="-1"&&delete this.opts.toolbar.formatting.dropdown[a]},this));if(this.opts.buttons.length===0)return!1;this.airEnable();this.$toolbar=c("<ul>").addClass("redactor_toolbar").attr("id","redactor_toolbar_"+this.uuid);this.opts.air?(this.$air=c('<div class="redactor_air">').attr("id","redactor_air_"+this.uuid).hide(),this.$air.append(this.$toolbar),c("body").append(this.$air)):
this.opts.toolbarExternal?c(this.opts.toolbarExternal).html(this.$toolbar):this.$box.prepend(this.$toolbar);c.each(this.opts.buttons,c.proxy(function(a,b){if(b==="|")this.$toolbar.append(c(this.opts.buttonSeparator));else if(this.opts.toolbar[b]){var d=this.opts.toolbar[b];if(this.opts.fileUpload===!1&&b==="file")return!0;this.$toolbar.append(c("<li>").append(this.buttonBuild(b,d)))}},this));this.$toolbar.find("a").attr("tabindex","-1");this.opts.toolbarFixed&&(this.toolbarObserveScroll(),c(document).on("scroll.redactor",
c.proxy(this.toolbarObserveScroll,this)));if(this.opts.activeButtons)this.$editor.on("mouseup.redactor keyup.redactor",c.proxy(this.buttonActiveObserver,this))},toolbarObserveScroll:function(){var b=c(this.document).scrollTop(),d=this.$box.offset().top,a=0,e=d+this.$box.height()+40;if(b>d){d="100%";if(this.opts.toolbarFixedBox)a=this.$box.offset().left,d=this.$box.innerWidth(),this.$toolbar.addClass("toolbar_fixed_box");this.toolbarFixed=!0;this.$toolbar.css({position:"fixed",width:d,zIndex:1005,
top:this.opts.toolbarFixedTopOffset+"px",left:a});b<e?this.$toolbar.css("visibility","visible"):this.$toolbar.css("visibility","hidden")}else this.toolbarFixed=!1,this.$toolbar.css({position:"relative",width:"auto",top:0,left:a}),this.opts.toolbarFixedBox&&this.$toolbar.removeClass("toolbar_fixed_box")},airEnable:function(){if(this.opts.air)this.$editor.on("mouseup.redactor keyup.redactor",this,c.proxy(function(b){var d=this.getSelectionText();b.type==="mouseup"&&d!=""&&this.airShow(b);if(b.type===
"keyup"&&b.shiftKey&&d!="")b=c(this.getElement(this.getSelection().focusNode)),d=b.offset(),d.height=b.height(),this.airShow(d,!0)},this))},airShow:function(b,d){if(this.opts.air){var a,e;c(".redactor_air").hide();d?(a=b.left,e=b.top+b.height+14,this.opts.iframe&&(e+=this.$box.position().top-c(this.document).scrollTop(),a+=this.$box.position().left)):(e=this.$air.innerWidth(),a=b.clientX,c(this.document).width()<a+e&&(a-=e),e=b.clientY+14,this.opts.iframe?(e+=this.$box.position().top,a+=this.$box.position().left):
e+=c(this.document).scrollTop());this.$air.css({left:a+"px",top:e+"px"}).show();this.airBindHide()}},airBindHide:function(){if(this.opts.air){var b=c.proxy(function(b){c(b).on("mousedown.redactor",c.proxy(function(a){c(a.target).closest(this.$toolbar).length===0&&(this.$air.fadeOut(100),this.selectionRemove(),c(b).off(a))},this)).on("keydown.redactor",c.proxy(function(a){a.which===this.keyCode.ESC&&this.getSelection().collapseToStart();this.$air.fadeOut(100);c(b).off(a)},this))},this);b(document);
this.opts.iframe&&b(this.document)}},airBindMousemoveHide:function(){if(this.opts.air){var b=c.proxy(function(b){c(b).on("mousemove.redactor",c.proxy(function(a){c(a.target).closest(this.$toolbar).length===0&&(this.$air.fadeOut(100),c(b).off(a))},this))},this);b(document);this.opts.iframe&&b(this.document)}},pickerBuild:function(b,d){b.width(210);var a="color";d==="backcolor"&&(a="background-color");for(var e=this.opts.colors.length,g=this,f=0;f<e;f++){var h=this.opts.colors[f],h=c('<a rel="'+h+'" href="javascript:;" class="redactor_color_link"></a>').css({backgroundColor:h});
b.append(h);h.on("click",function(){var b=c(this).attr("rel");d==="backcolor"&&(b=c(this).css("background-color"));g.pickerSet(a,b)})}e=c('<a href="javascript:;" class="redactor_color_none"></a>').html(this.opts.curLang.none).on("click",function(){g.pickerSet(a,!1)});b.append(e)},pickerSet:function(b,c){this.bufferSet();this.$editor.focus();this.inlineRemoveStyle(b);c!==!1&&this.inlineSetStyle(b,c);this.opts.air&&this.$air.fadeOut(100);this.sync()},dropdownBuild:function(b,d){c.each(d,c.proxy(function(a,
d){if(!d.className)d.className="";var g;d.name==="separator"?g=c('<a class="redactor_separator_drop">'):(g=c('<a href="javascript:;" class="'+d.className+" redactor_dropdown_"+a+'">'+d.title+"</a>"),g.on("click",c.proxy(function(b){b.preventDefault&&b.preventDefault();if(this.browser("msie"))b.returnValue=!1;d.callback&&d.callback.call(this,a,g,d);d.exec&&this.execCommand(d.exec,a);if(d.func)this[d.func](a);this.buttonActiveObserver();this.opts.air&&this.$air.fadeOut(100)},this)));b.append(g)},this))},
dropdownShow:function(b,d,a){if(!this.opts.visual)return b.preventDefault(),!1;if(this.buttonGet(a).hasClass("dropact"))this.dropdownHideAll();else{this.dropdownHideAll();this.buttonActive(a);this.buttonGet(a).addClass("dropact");var a=this.buttonGet(a).position(),e=a.left+"px";this.opts.air?d.css({position:"absolute",left:e,top:"29px"}).show():this.opts.toolbarFixed&&this.toolbarFixed?d.css({position:"fixed",left:e,top:"29px"}).show():d.css({position:"absolute",left:e,top:a.top+29+"px"}).show()}a=
c.proxy(function(a){this.dropdownHide(a,d)},this);c(document).one("click",a);this.$editor.one("click",a);b.stopPropagation()},dropdownHideAll:function(){this.$toolbar.find("a.dropact").removeClass("redactor_act").removeClass("dropact");c(".redactor_dropdown").hide()},dropdownHide:function(b,d){c(b.target).hasClass("dropact")||(d.removeClass("dropact"),this.dropdownHideAll())},buttonBuild:function(b,d){var a=c('<a href="javascript:;" title="'+d.title+'" class="redactor_btn redactor_btn_'+b+'"></a>'),
e=c('<div class="redactor_dropdown" style="display: none;">');a.on("click",c.proxy(function(c){c.preventDefault&&c.preventDefault();if(this.browser("msie"))c.returnValue=!1;if(!this.opts.visual&&b!=="html")return!1;d.exec?(this.execCommand(d.exec,b),this.airBindMousemoveHide()):d.func&&d.func!=="show"?(this[d.func](b),this.airBindMousemoveHide()):d.callback?(d.callback.call(this,b,a,d),this.airBindMousemoveHide()):(b==="backcolor"||b==="fontcolor"||d.dropdown)&&this.dropdownShow(c,e,b);this.buttonActiveObserver()},
this));if(b==="backcolor"||b==="fontcolor"||d.dropdown)e.appendTo(this.$toolbar),b==="backcolor"||b==="fontcolor"?this.pickerBuild(e,b):this.dropdownBuild(e,d.dropdown);return a},buttonGet:function(b){if(!this.opts.toolbar)return!1;return c(this.$toolbar.find("a.redactor_btn_"+b))},buttonActive:function(b){this.buttonGet(b).addClass("redactor_act")},buttonInactive:function(b){this.buttonGet(b).removeClass("redactor_act")},buttonInactiveAll:function(){c.each(this.opts.activeButtons,c.proxy(function(b,
c){this.buttonInactive(c)},this))},buttonActiveVisual:function(){this.$toolbar.find("a.redactor_btn").not("a.redactor_btn_html").removeClass("redactor_button_disabled")},buttonInactiveVisual:function(){this.$toolbar.find("a.redactor_btn").not("a.redactor_btn_html").addClass("redactor_button_disabled")},buttonChangeIcon:function(b,c){this.buttonGet(b).addClass("redactor_btn_"+c)},buttonRemoveIcon:function(b,c){this.buttonGet(b).removeClass("redactor_btn_"+c)},buttonAddSeparator:function(){this.$toolbar.append(c(this.opts.buttonSeparator))},
buttonAddSeparatorAfter:function(b){this.buttonGet(b).parent().after(c(this.opts.buttonSeparator))},buttonAddSeparatorBefore:function(b){this.buttonGet(b).parent().before(c(this.opts.buttonSeparator))},buttonRemoveSeparatorAfter:function(b){this.buttonGet(b).parent().next().remove()},buttonRemoveSeparatorBefore:function(b){this.buttonGet(b).parent().prev().remove()},buttonSetRight:function(b){this.opts.toolbar&&this.buttonGet(b).parent().addClass("redactor_btn_right")},buttonSetLeft:function(b){this.opts.toolbar&&
this.buttonGet(b).parent().removeClass("redactor_btn_right")},buttonAdd:function(b,d,a,e){this.opts.toolbar&&(b=this.buttonBuild(b,{title:d,callback:a,dropdown:e}),this.$toolbar.append(c("<li>").append(b)))},buttonAddFirst:function(b,d,a,e){this.opts.toolbar&&(b=this.buttonBuild(b,{title:d,callback:a,dropdown:e}),this.$toolbar.prepend(c("<li>").append(b)))},buttonAddAfter:function(b,d,a,e,g){this.opts.toolbar&&(d=this.buttonBuild(d,{title:a,callback:e,dropdown:g}),this.buttonGet(b).parent().after(c("<li>").append(d)))},
buttonAddBefore:function(b,d,a,e,g){this.opts.toolbar&&(d=this.buttonBuild(d,{title:a,callback:e,dropdown:g}),this.buttonGet(b).parent().before(c("<li>").append(d)))},buttonRemove:function(b,c){var a=this.buttonGet(b);c&&a.parent().next().remove();a.parent().removeClass("redactor_btn_right");a.remove()},buttonActiveObserver:function(){var b=this.getParent();this.buttonInactiveAll();b&&b.tagName==="A"?this.$toolbar.find("a.redactor_dropdown_link").text(this.opts.curLang.link_edit):this.$toolbar.find("a.redactor_dropdown_link").text(this.opts.curLang.link_insert);
this.opts.activeButtonsAdd&&(c.each(this.opts.activeButtonsAdd,c.proxy(function(a,b){this.opts.activeButtons.push(b)},this)),c.extend(this.opts.activeButtonsStates,this.opts.activeButtonsAdd));c.each(this.opts.activeButtonsStates,c.proxy(function(a,d){c(b).closest(a,this.$editor.get()[0]).length!=0&&this.buttonActive(d)},this));var d=c(b).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0]);if(d.length)switch(d.css("text-align")){case "right":this.buttonActive("alignright");break;
case "center":this.buttonActive("aligncenter");break;case "justify":this.buttonActive("justify");break;default:this.buttonActive("alignleft")}},exec:function(b,c,a){b==="formatblock"&&this.browser("msie")&&(c="<"+c+">");b==="inserthtml"&&this.browser("msie")?(this.$editor.focus(),this.document.selection.createRange().pasteHTML(c)):this.document.execCommand(b,!1,c);a!==!1&&this.sync();this.callback("execCommand",b,c)},execCommand:function(b,d,a){if(!this.opts.visual)return this.$source.focus(),!1;
if(b==="inserthtml")this.insertHtml(d,a),this.callback("execCommand",b,d);else{if(this.currentOrParentIs("PRE")&&!this.opts.formattingPre)return!1;if(b==="insertunorderedlist"||b==="insertorderedlist"){var e=this.getParent(),a=c(e).closest("ol, ul"),e=!1;if(a.length){var e=!0,g=a[0].tagName;if(b==="insertunorderedlist"&&g==="OL"||b==="insertorderedlist"&&g==="UL")e=!1}if(e){this.selectionSave();e=this.getNodes();a=this.getBlocks(e);typeof e[0]!="undefined"&&e.length>1&&e[0].nodeType==3&&a.unshift(this.getBlock());
var f="",h="";c.each(a,c.proxy(function(a,b){if(b.tagName=="LI"){var d=c(b),e=d.clone();e.find("ul","ol").remove();f+=this.opts.linebreaks===!1?this.outerHtml(c("<p>").append(e.contents())):e.html()+"<br>";a==0?(d.addClass("redactor-replaced").empty(),h=this.outerHtml(d)):d.remove()}},this));html=this.$editor.html().replace(h,"</"+g+">"+f+"<"+g+">");this.$editor.html(html);this.$editor.find(g+":empty").remove()}else this.selectionSave(),this.document.execCommand(b),e=this.getParent(),a=c(e).closest("ol, ul"),
a.length&&((this.browser("msie")||this.browser("mozilla"))&&e.tagName!=="LI"&&c(e).replaceWith(c(e).html()),g=a.parent(),this.isParentRedactor(g)&&this.nodeTestBlocks(g[0])&&g.replaceWith(g.contents())),this.browser("mozilla")&&this.$editor.focus();this.selectionRestore();this.sync();this.callback("execCommand",b,d)}else{if(b==="unlink"&&(e=this.getParent(),c(e)[0].tagName==="A")){c(e).replaceWith(c(e).text());this.sync();this.callback("execCommand",b,d);return}this.exec(b,d,a);b==="inserthorizontalrule"&&
this.$editor.find("hr").removeAttr("id")}}},indentingIndent:function(){this.indentingStart("indent")},indentingOutdent:function(){this.indentingStart("outdent")},indentingStart:function(b){if(b==="indent"){if((b=this.getBlock())&&b.tagName=="LI"){this.selectionSave();var b=this.getParent(),d=c(b).closest("ol, ul")[0].tagName,a=this.getBlocks();c.each(a,function(a,b){if(b.tagName=="LI"){var f=c(b).prev();if(f.size()!=0&&f[0].tagName=="LI"){var h=f.children("ul, ol");h.size()==0?f.append(c("<"+d+">").append(b)):
h.append(b)}}});this.selectionRestore()}}else{this.selectionSave();if((b=this.getBlock())&&b.tagName=="LI")a=this.getBlocks(),this.insideOutdent(b,0,a);this.selectionRestore()}},insideOutdent:function(b,d,a){if(b&&b.tagName=="LI"){var e=c(b).parent().parent();e.size()!=0&&e[0].tagName=="LI"?e.after(b):typeof a[d]!="undefined"?(b=a[d],d++,this.insideOutdent(b,d,a)):this.execCommand("insertunorderedlist")}},cleanEmpty:function(b){var c=this.placeholderStart(b);if(c!==!1)return c;if(this.opts.linebreaks===
!1)b===""?b=this.opts.emptyHtml:b.search(/^<hr\s?\/?>$/gi)!==-1&&(b="<hr>"+this.opts.emptyHtml);return b},cleanConverters:function(b){this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p$1>$2</p>"));this.opts.paragraphy&&(b=this.cleanParagraphy(b));return b},cleanConvertProtected:function(b){b=b.replace(/<script(.*?)>([\w\W]*?)<\/script>/gi,'<title type="text/javascript" style="display: none;" class="redactor-script-tag"$1>$2</title>');b=b.replace(/<style(.*?)>([\w\W]*?)<\/style>/gi,
'<section$1 style="display: none;" rel="redactor-style-tag">$2</section>');b=b.replace(/<form(.*?)>([\w\W]*?)<\/form>/gi,'<section$1 rel="redactor-form-tag">$2</section>');return b=this.opts.phpTags?b.replace(/<\?php([\w\W]*?)\?>/gi,'<section style="display: none;" rel="redactor-php-tag">$1</section>'):b.replace(/<\?php([\w\W]*?)\?>/gi,"")},cleanReConvertProtected:function(b){b=b.replace(/<title type="text\/javascript" style="display: none;" class="redactor-script-tag"(.*?)>([\w\W]*?)<\/title>/gi,
'<script$1 type="text/javascript">$2<\/script>');b=b.replace(/<section(.*?) style="display: none;" rel="redactor-style-tag">([\w\W]*?)<\/section>/gi,"<style$1>$2</style>");b=b.replace(/<section(.*?)rel="redactor-form-tag"(.*?)>([\w\W]*?)<\/section>/gi,"<form$1$2>$3</form>");this.opts.phpTags&&(b=b.replace(/<section style="display: none;" rel="redactor-php-tag">([\w\W]*?)<\/section>/gi,"<?php\r\n$1\r\n?>"));return b},cleanRemoveSpaces:function(b,d){if(d!==!1){var d=[],a=0,e;e=b.match(/<(pre|style|script|title)(.*?)>([\w\W]*?)<\/(pre|style|script|title)>/gi);
e!==null&&c.each(e,function(c,e){a=c;b=b.replace(e,"buffer_"+a);d.push(e)});this.opts.phpTags&&(e=b.match(/<\?php([\w\W]*?)\?>/gi),e!==null&&c.each(e,function(c,e){a+=c;b=b.replace(e,"buffer_"+c);d.push(e)}))}b=b.replace(/\n/g," ");b=b.replace(/[\t]*/g,"");b=b.replace(/\n\s*\n/g,"\n");b=b.replace(/^[\s\n]*/g," ");b=b.replace(/[\s\n]*$/g," ");b=b.replace(/>\s{2,}</g,"><");d!==!1&&(b=this.cleanReplacer(d,b));return b=b.replace(/\n\n/g,"\n")},cleanReplacer:function(b,d){b&&c.each(b,function(a,b){d=d.replace("buffer_"+
a,b)});return d},cleanRemoveEmptyTags:function(b){for(var b=b.replace(/<span>([\w\W]*?)<\/span>/gi,"$1"),b=b.replace(/[\u200B-\u200D\uFEFF]/g,""),c=["<pre></pre>","<blockquote>\\s*</blockquote>","<dd></dd>","<dt></dt>","<em>\\s*</em>","<ul></ul>","<ol></ol>","<li></li>","<table></table>","<tr></tr>","<span>\\s*<span>","<span>&nbsp;<span>","<b>\\s*</b>","<b>&nbsp;</b>","<p>\\s*</p>","<p></p>","<p>&nbsp;</p>","<p>\\s*<br>\\s*</p>","<div>\\s*</div>","<div>\\s*<br>\\s*</div>"],a=c.length,e=0;e<a;++e)b=
b.replace(RegExp(c[e],"gi"),"");return b},cleanParagraphy:function(b){function d(a,c,d){return b.replace(RegExp(a,c),d)}b=c.trim(b);if(this.opts.linebreaks===!0)return b;if(b===""||b==="<p></p>")return this.opts.emptyHtml;b+="\n";var a=[],e=0;b.search(/<(table|div|pre|object)/gi)!==-1&&c.each(b.match(/<(table|div|pre|object)(.*?)>([\w\W]*?)<\/(table|div|pre|object)>/gi),function(c,d){e++;a[e]=d;b=b.replace(d,"{replace"+e+"}\n")});this.opts.phpTags&&b.search(/<section(.*?)rel="redactor-php-tag">/gi)!==
-1&&c.each(b.match(/<section(.*?)rel="redactor-php-tag">([\w\W]*?)<\/section>/gi),function(c,d){e++;a[e]=d;b=b.replace(d,"{replace"+e+"}\n")});var b=b.replace(/<\!\-\-([\w\W]*?)\-\->/gi,"<comment>$1</comment>"),b=b.replace(/<br \/>\s*<br \/>/gi,"\n\n"),b=d("(<(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)[^>]*>)",
"gi","\n$1"),b=d("(</(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)>)","gi","$1\n\n"),b=d("\r\n","g","\n"),b=d("\r","g","\n"),b=d("/\n\n+/","g","\n\n"),g=b.split(RegExp("\ns*\n","g"),-1),b="",f;for(f in g)g.hasOwnProperty(f)&&(b+=g[f].search("{replace")==
-1?"<p>"+g[f].replace(/^\n+|\n+$/g,"")+"</p>":g[f]);b.search(/<blockquote/gi)!==-1&&c.each(b.match(/<blockquote(.*?)>([\w\W]*?)<\/blockquote>/gi),function(a,c){var d="",d=c.replace("<p>",""),d=d.replace("</p>","<br>");b=b.replace(c,d)});b=d("<p>s*</p>","gi","");b=d("<p>([^<]+)</(div|address|form)>","gi","<p>$1</p></$2>");b=d("<p>s*(</?(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)[^>]*>)s*</p>",
"gi","$1");b=d("<p>(<li.+?)</p>","gi","$1");b=d("<p>s*(</?(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)[^>]*>)","gi","$1");b=d("(</?(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)[^>]*>)s*</p>",
"gi","$1");b=d("(</?(comment|html|body|head|title|meta|style|script|link|iframe|table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|option|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary)[^>]*>)s*<br />","gi","$1");b=d("<br />(s*</?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","gi","$1");b=d("\n</p>","gi","</p>");b=d("</li><p>","gi","</li>");b=d("</ul><p>(.*?)</li>",
"gi","</ul></li>");b=d("</ol><p>","gi","</ol>");b=d("<p>\t?\n?<p>","gi","<p>");b=d("</dt><p>","gi","</dt>");b=d("</dd><p>","gi","</dd>");b=d("<br></p></blockquote>","gi","</blockquote>");c.each(a,function(a,c){b=b.replace("{replace"+a+"}",c)});b=b.replace(/<comment>([\w\W]*?)<\/comment>/gi,"<\!--$1--\>");return c.trim(b)},cleanConvertInlineTags:function(b){var c="strong";this.opts.boldTag==="b"&&(c="b");var a="em";this.opts.italicTag==="i"&&(a="i");b=b.replace(/<span style="font-style: italic;">([\w\W]*?)<\/span>/gi,
"<"+a+">$1</"+a+">");b=b.replace(/<span style="font-weight: bold;">([\w\W]*?)<\/span>/gi,"<"+c+">$1</"+c+">");b=this.opts.boldTag==="strong"?b.replace(/<b>([\w\W]*?)<\/b>/gi,"<strong>$1</strong>"):b.replace(/<strong>([\w\W]*?)<\/strong>/gi,"<b>$1</b>");b=this.opts.italicTag==="em"?b.replace(/<i>([\w\W]*?)<\/i>/gi,"<em>$1</em>"):b.replace(/<em>([\w\W]*?)<\/em>/gi,"<i>$1</i>");b=b.replace(/<strike>([\w\W]*?)<\/strike>/gi,"<del>$1</del>");/<span(.*?)data-redactor="verified"(.*?)>([\w\W]*?)<\/span>/gi.test(b)||
(b=b.replace(/<span(.*?)(?!data-redactor="verified")(.*?)>([\w\W]*?)<\/span>/gi,'<span$1 data-redactor="verified"$2>$3</span>'));return b},cleanStripTags:function(b){if(b==""||typeof b=="undefined")return b;var d=!1;this.opts.allowedTags!==!1&&(d=!0);var a=d===!0?this.opts.allowedTags:this.opts.deniedTags,b=b.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(b,g){return d===!0?c.inArray(g.toLowerCase(),a)>"-1"?b:"":c.inArray(g.toLowerCase(),a)>"-1"?"":b});return b=this.cleanConvertInlineTags(b)},
cleanSavePreCode:function(b,d){var a=b.match(/<(pre|code)(.*?)>([\w\W]*?)<\/(pre|code)>/gi);a!==null&&c.each(a,c.proxy(function(a,c){var f=c.match(/<(pre|code)(.*?)>([\w\W]*?)<\/(pre|code)>/i);f[3]=f[3].replace(/&nbsp;/g," ");d!==!1&&(f[3]=this.cleanEncodeEntities(f[3]));b=b.replace(c,"<"+f[1]+f[2]+">"+f[3]+"</"+f[1]+">")},this));return b},cleanEncodeEntities:function(b){b=String(b).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');return String(b).replace(/&/g,
"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},cleanUnverified:function(){var b=this.$editor.find("img, a, b, strong, sub, sup, i, em, u, small, strike, del, span, cite");b.filter('[style*="font-size"][style*="line-height"]').css("font-size","").css("line-height","");b.filter('[style*="background-color: transparent;"][style*="line-height"]').css("background-color","").css("line-height","");b.filter('[style*="background-color: transparent;"]').css("background-color","");
c.each(b,c.proxy(function(b,a){this.removeEmptyAttr(a,"style")},this));this.$editor.find('div[style="text-align: -webkit-auto;"]').contents().unwrap()},cleanHtml:function(b){var c=0,a=b.length,e=0,g=null,e=null,f="",h="",f="";for(this.cleanlevel=0;c<a;c++){e=c;if(-1==b.substr(c).indexOf("<")){h+=b.substr(c);break}for(;e<a&&b.charAt(e)!="<";)e++;c!=e&&(f=b.substr(c,e-c),f.match(/^\s{2,}$/g)||("\n"==h.charAt(h.length-1)?h+=this.cleanGetTabs():"\n"==f.charAt(0)&&(h+="\n"+this.cleanGetTabs(),f=f.replace(/^\s+/,
"")),h+=f),f.match(/\n/)&&(h+="\n"+this.cleanGetTabs()));for(g=e;e<a&&">"!=b.charAt(e);)e++;f=b.substr(g,e-g);c=e;if("!--"==f.substr(1,3)){if(!f.match(/--$/)){for(;"--\>"!=b.substr(e,3);)e++;e+=2;f=b.substr(g,e-g);c=e}"\n"!=h.charAt(h.length-1)&&(h+="\n");h+=this.cleanGetTabs();h+=f+">\n"}else if("!"==f[1])h=this.placeTag(f+">",h);else if("?"==f[1])h+=f+">\n";else if(e=f.match(/^<(script|style|pre)/i)){if(e[1]=e[1].toLowerCase(),f=this.cleanTag(f),h=this.placeTag(f,h),e=String(b.substr(c+1)).toLowerCase().indexOf("</"+
e[1]))f=b.substr(c+1,e),c+=e,h+=f}else f=this.cleanTag(f),h=this.placeTag(f,h)}return this.cleanFinish(h)},cleanGetTabs:function(){for(var b="",c=0;c<this.cleanlevel;c++)b+="\t";return b},cleanFinish:function(b){b=b.replace(/\n\s*\n/g,"\n");b=b.replace(/^[\s\n]*/,"");b=b.replace(/[\s\n]*$/,"");b=b.replace(/<script(.*?)>\n<\/script>/gi,"<script$1><\/script>");this.cleanlevel=0;return b},cleanTag:function(b){var c="",b=b.replace(/\n/g," "),b=b.replace(/\s{2,}/g," "),b=b.replace(/^\s+|\s+$/g," "),a=
"";b.match(/\/$/)&&(a="/",b=b.replace(/\/+$/,""));for(var e;e=/\s*([^= ]+)(?:=((['"']).*?\3|[^ ]+))?/.exec(b);)e[2]?c+=e[1].toLowerCase()+"="+e[2]:e[1]&&(c+=e[1].toLowerCase()),c+=" ",b=b.substr(e[0].length);return c.replace(/\s*$/,"")+a+">"},placeTag:function(b,c){var a=b.match(this.cleannewLevel);if(b.match(this.cleanlineBefore)||a)c=c.replace(/\s*$/,""),c+="\n";a&&"/"==b.charAt(1)&&this.cleanlevel--;"\n"==c.charAt(c.length-1)&&(c+=this.cleanGetTabs());a&&"/"!=b.charAt(1)&&this.cleanlevel++;c+=
b;if(b.match(this.cleanlineAfter)||b.match(this.cleannewLevel))c=c.replace(/ *$/,""),c+="\n";return c},alignmentLeft:function(){this.alignmentSet("","JustifyLeft")},alignmentRight:function(){this.alignmentSet("right","JustifyRight")},alignmentCenter:function(){this.alignmentSet("center","JustifyCenter")},alignmentJustify:function(){this.alignmentSet("justify","JustifyFull")},alignmentSet:function(b,d){this.bufferSet();if(this.oldIE())return this.document.execCommand(d,!1,!1),!0;this.selectionSave();
var a=this.getBlocks();c.each(a,c.proxy(function(a,d){var f=!1;if(f=c.inArray(d.tagName,this.opts.alignmentTags)!==-1?c(d):c(d).closest(this.opts.alignmentTags.toString().toLowerCase(),this.$editor[0]))f.css("text-align",b),this.removeEmptyAttr(f,"style")},this));this.selectionRestore();this.sync()},formatEmpty:function(b){var d=c.trim(this.$editor.html()),d=d.replace(/<br\s?\/?>/i,""),a=d.replace(/<p>\s?<\/p>/gi,"");if(d===""||a==="")b.preventDefault(),this.$editor.html(c(this.opts.emptyHtml).get(0)),
this.focus();this.sync()},formatBlocks:function(b){this.bufferSet();var d=this.getBlocks();this.selectionSave();c.each(d,c.proxy(function(a,c){c.tagName!=="LI"&&this.formatBlock(b,c)},this));this.selectionRestore();this.sync()},formatBlock:function(b,d){d===!1&&(d=this.getBlock());if(d===!1)return this.opts.linebreaks===!0&&this.execCommand("formatblock",b),!0;var a="";b!=="pre"?a=c(d).contents():(a=c(d).html(),c.trim(a)===""&&(a='<span id="selection-marker-1"></span>'));d.tagName==="PRE"&&(b="p");
this.opts.linebreaks===!0&&b==="p"?c(d).replaceWith(c("<div>").append(a).html()+"<br>"):(a=c("<"+b+">").append(a),c(d).replaceWith(a))},formatChangeTag:function(b,d,a){a!==!1&&this.selectionSave();var e=c("<"+d+"/>");c(b).replaceWith(function(){return e.append(c(this).contents())});a!==!1&&this.selectionRestore();return e},formatQuote:function(){this.bufferSet();if(this.opts.linebreaks===!1){this.selectionSave();var b=this.getBlocks();b&&c.each(b,c.proxy(function(a,b){b.tagName==="BLOCKQUOTE"?this.formatBlock("p",
b,!1):b.tagName!=="LI"&&this.formatBlock("blockquote",b,!1)},this));this.selectionRestore()}else if(b=this.getBlock(),b.tagName==="BLOCKQUOTE")this.selectionSave(),c(b).replaceWith(c(b).html()+"<br>"),this.selectionRestore();else{var b=this.selectionWrap("blockquote"),d=c(b).html();c.each(["ul","ol","table","tr","tbody","thead","tfoot","dl"],function(a,b){d=d.replace(RegExp("<"+b+"(.*?)>","gi"),"");d=d.replace(RegExp("</"+b+">","gi"),"")});var a=this.opts.blockLevelElements;a.push("td");c.each(a,
function(a,b){d=d.replace(RegExp("<"+b+"(.*?)>","gi"),"");d=d.replace(RegExp("</"+b+">","gi"),"<br>")});c(b).html(d);this.selectionElement(b);b=c(b).next();b[0].tagName==="BR"&&b.remove()}this.sync()},blockRemoveAttr:function(b){var d=this.getBlocks();c(d).removeAttr(b);this.sync()},blockSetAttr:function(b,d){var a=this.getBlocks();c(a).attr(b,d);this.sync()},blockRemoveStyle:function(b){var d=this.getBlocks();c(d).css(b,"");this.removeEmptyAttr(d,"style");this.sync()},blockSetStyle:function(b,d){var a=
this.getBlocks();c(a).css(b,d);this.sync()},blockRemoveClass:function(b){var d=this.getBlocks();c(d).removeClass(b);this.removeEmptyAttr(d,"class");this.sync()},blockSetClass:function(b){var d=this.getBlocks();c(d).addClass(b);this.sync()},inlineRemoveClass:function(b){this.selectionSave();this.inlineEachNodes(function(d){c(d).removeClass(b);this.removeEmptyAttr(d,"class")});this.selectionRestore();this.sync()},inlineSetClass:function(b){var d=this.getCurrent();c(d).hasClass(b)||this.inlineMethods("addClass",
b)},inlineRemoveStyle:function(b){this.selectionSave();this.inlineEachNodes(function(d){c(d).css(b,"");this.removeEmptyAttr(d,"style")});this.selectionRestore();this.sync()},inlineSetStyle:function(b,c){this.inlineMethods("css",b,c)},inlineRemoveAttr:function(b){this.selectionSave();var d=this.getRange(),a=this.getElement(),e=this.getNodes();if(d.collapsed||d.startContainer===d.endContainer&&a)e=c(a);c(e).removeAttr(b);this.inlineUnwrapSpan();this.selectionRestore();this.sync()},inlineSetAttr:function(b,
c){this.inlineMethods("attr",b,c)},inlineMethods:function(b,d,a){this.selectionSave();var e=this.getRange(),g=this.getElement();if(e.collapsed||e.startContainer===e.endContainer&&g)c(g)[b](d,a);else this.document.execCommand("fontSize",!1,4),e=this.$editor.find("font"),c.each(e,c.proxy(function(c,e){this.inlineSetMethods(b,e,d,a)},this));this.selectionRestore();this.sync()},inlineSetMethods:function(b,d,a,e){var g=c(d).parent();g&&g[0].tagName==="SPAN"?c(d).replaceWith(c(d).html()):(g=c('<span data-redactor="verified" data-redactor-inlineMethods>').append(c(d).contents()),
c(d).replaceWith(g));c(g)[b](a,e);return g},inlineEachNodes:function(b){var d=this.getRange(),a=this.getElement(),e=this.getNodes(),g;if(d.collapsed||d.startContainer===d.endContainer&&a)e=c(a),g=!0;c.each(e,c.proxy(function(a,d){if(!g&&d.tagName!=="SPAN")if(d.parentNode.tagName==="SPAN"&&!c(d.parentNode).hasClass("redactor_editor"))d=d.parentNode;else return;b.call(this,d)},this))},inlineUnwrapSpan:function(){var b=this.$editor.find("span[data-redactor-inlineMethods]");c.each(b,c.proxy(function(b,
a){var e=c(a);e.attr("class")===void 0&&e.attr("style")===void 0&&e.contents().unwrap()},this))},inlineFormat:function(b){this.selectionSave();this.document.execCommand("fontSize",!1,4);var d=this.$editor.find("font");c.each(d,function(a,d){var g=c("<"+b+"/>").append(c(d).contents());c(d).replaceWith(g)});this.selectionRestore();this.sync()},inlineRemoveFormat:function(b){this.selectionSave();var d=b.toUpperCase(),b=this.getNodes();c.each(b,function(a,b){b.tagName===d&&c(b).replaceWith(c(b).contents())});
this.selectionRestore();this.sync()},insertHtml:function(b,d){var a=this.getCurrent(),e=a.parentNode;this.$editor.focus();this.bufferSet();var g=c("<div>"+b+"</div>"),b=g.html(),b=this.cleanRemoveEmptyTags(b),g=c("<div>"+b+"</div>"),f=this.getBlock();if(g.contents().length==1){var h=g.contents()[0].tagName;if(h!="P"&&h==f.tagName||h=="PRE")b=g.text(),g=c("<div>").append(b)}if(!this.opts.linebreaks&&g.contents().length==1&&g.contents()[0].nodeType==3&&(this.getRangeSelectedNodes().length>2||!a||a.tagName==
"BODY"&&!e||e.tagName=="HTML"))b="<p>"+b+"</p>";f.tagName=="BLOCKQUOTE"&&b.indexOf("<a")===-1?this.insertText(b):g.contents().length>1&&f||g.contents().is("p, :header, ul, ol, div, table, blockquote, pre, address, section, header, footer, aside, article")?this.browser("msie")?this.document.selection.createRange().pasteHTML(b):this.document.execCommand("inserthtml",!1,b):this.insertHtmlAdvanced(b);this.selectall&&this.window.setTimeout(c.proxy(function(){this.opts.linebreaks?this.focusEnd():this.selectionEnd(this.$editor.contents().last())},
this),1);this.observeStart();d!==!1&&this.sync()},insertHtmlAdvanced:function(b){var c=this.getSelection();if(c.getRangeAt&&c.rangeCount){var a=c.getRangeAt(0);a.deleteContents();var e=this.document.createElement("div");e.innerHTML=b;for(var b=this.document.createDocumentFragment(),g,f;g=e.firstChild;)f=b.appendChild(g);a.insertNode(b);f&&(a=a.cloneRange(),a.setStartAfter(f),a.collapse(!0),c.removeAllRanges(),c.addRange(a))}},insertText:function(b){var d=c(b);d.length&&(b=d.text());this.$editor.focus();
this.browser("msie")?this.document.selection.createRange().pasteHTML(b):this.document.execCommand("inserthtml",!1,b);this.sync()},insertNode:function(b){var b=b[0]||b,c=this.getSelection();c.getRangeAt&&c.rangeCount&&(range=c.getRangeAt(0),range.deleteContents(),range.insertNode(b),range.setEndAfter(b),range.setStartAfter(b),c.removeAllRanges(),c.addRange(range))},insertAfterLastElement:function(b){if(this.isEndOfElement()&&this.opts.linebreaks===!1){if(this.$editor.contents().last()[0]!==b)return!1;
this.bufferSet();var d=c(this.opts.emptyHtml);c(b).after(d);this.selectionStart(d)}},insertLineBreak:function(){this.selectionSave();this.$editor.find("#selection-marker-1").before("<br>"+(this.browser("webkit")?this.opts.invisibleSpace:""));this.selectionRestore()},insertDoubleLineBreak:function(){this.selectionSave();this.$editor.find("#selection-marker-1").before("<br><br>"+(this.browser("webkit")?this.opts.invisibleSpace:""));this.selectionRestore()},replaceLineBreak:function(b){var d=c("<br>"+
this.opts.invisibleSpace);c(b).replaceWith(d);this.selectionStart(d)},pasteInit:function(){if(this.isMobile())return!1;this.$editor.on("paste.redactor",c.proxy(function(){if(!this.opts.cleanup)return!0;this.selectionSave();if(!this.selectall)this.opts.autoresize===!0?(this.$editor.height(this.$editor.height()),this.saveScroll=this.document.body.scrollTop):this.saveScroll=this.$editor.scrollTop();var b=this.extractContent();setTimeout(c.proxy(function(){var c=this.extractContent();this.$editor.append(b);
this.selectionRestore();this.pasteClean(this.getFragmentHtml(c));this.opts.autoresize===!0&&this.$editor.css("height","auto")},this),1)},this))},pasteClean:function(b){b=this.callback("pasteBefore",!1,b);if(this.currentOrParentIs("PRE"))return b=this.pastePre(b),this.pasteInsert(b),!0;b=b.replace(/<\!--[\s\S]*?--\>|<\?(?:php)?[\s\S]*?\?>/gi,"");b=b.replace(/(&nbsp;){2,}/gi,"&nbsp;");b=b.replace(/&nbsp;/gi," ");b=b.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2");b=this.cleanStripTags(b);
b=b.replace(/<td><\/td>/gi,"[td]");b=b.replace(/<td>&nbsp;<\/td>/gi,"[td]");b=b.replace(/<td><br><\/td>/gi,"[td]");b=b.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]');b=b.replace(/<iframe(.*?)>([\w\W]*?)<\/iframe>/gi,"[iframe$1]$2[/iframe]");b=b.replace(/<video(.*?)>([\w\W]*?)<\/video>/gi,"[video$1]$2[/video]");b=b.replace(/<audio(.*?)>([\w\W]*?)<\/audio>/gi,"[audio$1]$2[/audio]");b=b.replace(/<embed(.*?)>([\w\W]*?)<\/embed>/gi,"[embed$1]$2[/embed]");b=b.replace(/<object(.*?)>([\w\W]*?)<\/object>/gi,
"[object$1]$2[/object]");b=b.replace(/<param(.*?)>/gi,"[param$1]");b=b.replace(/<img(.*?)style="(.*?)"(.*?)>/gi,"[img$1$3]");b=b.replace(/<(\w+)([\w\W]*?)>/gi,"<$1>");b=b.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,"");b=b.replace(/<div>\s*?\t*?\n*?(<ul>|<ol>|<p>)/gi,"$1");b=b.replace(/\[td\]/gi,"<td>&nbsp;</td>");b=b.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>');b=b.replace(/\[iframe(.*?)\]([\w\W]*?)\[\/iframe\]/gi,"<iframe$1>$2</iframe>");b=b.replace(/\[video(.*?)\]([\w\W]*?)\[\/video\]/gi,
"<video$1>$2</video>");b=b.replace(/\[audio(.*?)\]([\w\W]*?)\[\/audio\]/gi,"<audio$1>$2</audio>");b=b.replace(/\[embed(.*?)\]([\w\W]*?)\[\/embed\]/gi,"<embed$1>$2</embed>");b=b.replace(/\[object(.*?)\]([\w\W]*?)\[\/object\]/gi,"<object$1>$2</object>");b=b.replace(/\[param(.*?)\]/gi,"<param$1>");b=b.replace(/\[img(.*?)\]/gi,"<img$1>");this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>"),b=b.replace(/<\/div><p>/gi,"<p>"),b=b.replace(/<\/p><\/div>/gi,"</p>"));b=this.cleanParagraphy(b);
b=b.replace(/<span(.*?)>([\w\W]*?)<\/span>/gi,"$2");b=b.replace(/<img>/gi,"");b=b.replace(/<[^\/>][^>][^img|param|source]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,"");b=b.replace(/\n{3,}/gi,"\n");b=b.replace(/<p><p>/gi,"<p>");b=b.replace(/<\/p><\/p>/gi,"</p>");this.opts.linebreaks===!0&&(b=b.replace(/<p(.*?)>([\w\W]*?)<\/p>/gi,"$2<br>"));b=b.replace(/<[^\/>][^>][^img|param|source]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,"");if(this.browser("mozilla"))for(;/<br>$/gi.test(b);)b=b.replace(/<br>$/gi,"");
for(;/<font>([\w\W]*?)<\/font>/gi.test(b);)b=b.replace(/<font>([\w\W]*?)<\/font>/gi,"$1");this.pasteInsert(b)},pastePre:function(b){var b=b.replace(/<br>|<\/H[1-6]>|<\/p>|<\/div>/gi,"\n"),c=this.document.createElement("div");c.innerHTML=b;return this.cleanEncodeEntities(c.textContent||c.innerText)},pasteInsert:function(b){this.selectall&&(this.opts.linebreaks?this.$editor.html(""):this.$editor.html(this.opts.emptyHtml),this.$editor.focus());b=this.callback("pasteAfter",!1,b);this.insertHtml(b);this.selectall=
!1;this.opts.autoresize?c(this.document.body).scrollTop(this.saveScroll):this.$editor.scrollTop(this.saveScroll)},bufferSet:function(b){b!==void 0?this.opts.buffer.push(b):(this.selectionSave(),this.opts.buffer.push(this.$editor.html()),this.selectionRemoveMarkers(!0))},bufferUndo:function(){this.opts.buffer.length===0?this.$editor.focus():(this.selectionSave(),this.opts.rebuffer.push(this.$editor.html()),this.selectionRestore(!1,!0),this.$editor.html(this.opts.buffer.pop()),this.selectionRestore(),
setTimeout(c.proxy(this.observeStart,this),100))},bufferRedo:function(){if(this.opts.rebuffer.length===0)return this.$editor.focus(),!1;this.selectionSave();this.opts.buffer.push(this.$editor.html());this.selectionRestore(!1,!0);this.$editor.html(this.opts.rebuffer.pop());this.selectionRestore(!0);setTimeout(c.proxy(this.observeStart,this),4)},observeStart:function(){this.observeImages();this.observeTables()},observeTables:function(){this.$editor.find("table").on("click",c.proxy(this.tableObserver,
this))},observeImages:function(){if(this.opts.observeImages===!1)return!1;this.$editor.find("img").each(c.proxy(function(b,d){this.browser("msie")&&c(d).attr("unselectable","on");this.imageResize(d)},this))},getSelection:function(){return this.opts.rangy?this.opts.iframe?rangy.getSelection(this.$frame[0]):rangy.getSelection():this.document.getSelection()},getRange:function(){if(this.opts.rangy)return this.opts.iframe?rangy.createRange(this.iframeDoc()):rangy.createRange();else{if(this.document.getSelection){var b=
this.document.getSelection();if(b.getRangeAt&&b.rangeCount)return b.getRangeAt(0)}return this.document.createRange()}},selectionElement:function(b){this.setCaret(b)},selectionStart:function(b){this.selectionSet(b[0]||b,0,null,0)},selectionEnd:function(b){this.selectionSet(b[0]||b,1,null,1)},selectionSet:function(b,c,a,e){a==null&&(a=b);e==null&&(e=c);var g=this.getSelection();if(g){var f=this.getRange();f.setStart(b,c);f.setEnd(a,e);try{g.removeAllRanges()}catch(h){}g.addRange(f)}},selectionWrap:function(b){var b=
b.toLowerCase(),c=this.getBlock();if(c)return b=this.formatChangeTag(c,b),this.sync(),b;c=this.getSelection().getRangeAt(0);b=document.createElement(b);b.appendChild(c.extractContents());c.insertNode(b);this.selectionElement(b);return b},selectionAll:function(){var b=this.getRange();b.selectNodeContents(this.$editor[0]);var c=this.getSelection();c.removeAllRanges();c.addRange(b)},selectionRemove:function(){this.getSelection().removeAllRanges()},getCaretOffset:function(b){var d=0,d=this.getSelection().getRangeAt(0),
a=d.cloneRange();a.selectNodeContents(b);a.setEnd(d.endContainer,d.endOffset);return d=c.trim(a.toString()).length},getCaretOffsetRange:function(){return new i(this.getSelection().getRangeAt(0))},setCaret:function(b,c,a){typeof a==="undefined"&&(a=c);var b=b[0]||b,e=this.getRange();e.selectNodeContents(b);var b=this.getTextNodesIn(b),g=!1,f=0,h;if(b.length==1&&c)e.setStart(b[0],c),e.setEnd(b[0],a);else for(var i=0,k;k=b[i++];){h=f+k.length;if(!g&&c>=f&&(c<h||c==h&&i<b.length))e.setStart(k,c-f),g=
!0;if(g&&a<=h){e.setEnd(k,a-f);break}f=h}c=this.getSelection();c.removeAllRanges();c.addRange(e)},getTextNodesIn:function(b){var c=[];if(b.nodeType==3)c.push(b);else for(var b=b.childNodes,a=0,e=b.length;a<e;++a)c.push.apply(c,this.getTextNodesIn(b[a]));return c},selectionSave:function(){this.isFocused()||this.$editor.focus();this.opts.rangy?this.savedSel=rangy.saveSelection():this.selectionCreateMarker(this.getRange())},selectionCreateMarker:function(b){if(b){var d=c('<span id="selection-marker-1">'+
this.opts.invisibleSpace+"</span>",this.document)[0],a=c('<span id="selection-marker-2">'+this.opts.invisibleSpace+"</span>",this.document)[0];b.collapsed===!0?this.selectionSetMarker(b,d,!0):(this.selectionSetMarker(b,d,!0),this.selectionSetMarker(b,a,!1));this.savedSel=this.$editor.html();this.selectionRestore(!1,!1)}},selectionSetMarker:function(b,c,a){b=b.cloneRange();b.collapse(a);b.insertNode(c);b.detach()},selectionRestore:function(b,c){if(this.opts.rangy)rangy.restoreSelection(this.savedSel);
else{b===!0&&this.savedSel&&this.$editor.html(this.savedSel);var a=this.$editor.find("span#selection-marker-1"),e=this.$editor.find("span#selection-marker-2");this.isFocused()||this.$editor.focus();a.length!=0&&e.length!=0?this.selectionSet(a[0],0,e[0],0):a.length!=0&&this.selectionSet(a[0],0,null,0);if(c!==!1)this.selectionRemoveMarkers(),this.savedSel=!1}},selectionRemoveMarkers:function(){this.opts.rangy?rangy.removeMarkers(this.savedSel):(this.$editor.find("span#selection-marker-1").remove(),
this.$editor.find("span#selection-marker-2").remove())},getCurrent:function(){var b=!1,c=this.getSelection();if(c.rangeCount>0)b=c.getRangeAt(0).startContainer;return this.isParentRedactor(b)},getParent:function(b){return(b=b||this.getCurrent())?this.isParentRedactor(c(b).parent()[0]):!1},getBlock:function(b){for(typeof b==="undefined"&&(b=this.getCurrent());b;){if(this.nodeTestBlocks(b)){if(c(b).hasClass("redactor_editor"))break;return b}b=b.parentNode}return!1},getBlocks:function(b){var d=[];if(typeof b==
"undefined"){if((b=this.getRange())&&b.collapsed===!0)return[this.getBlock()];b=this.getNodes(b)}c.each(b,c.proxy(function(a,b){if(this.opts.iframe===!1&&c(b).parents("div.redactor_editor").size()==0)return!1;this.nodeTestBlocks(b)&&d.push(b)},this));d.length===0&&(d=[this.getBlock()]);return d},nodeTestBlocks:function(b){return b.nodeType==1&&this.rTestBlock.test(b.nodeName)},tagTestBlock:function(b){return this.rTestBlock.test(b)},getSelectedNodes:function(b){if(typeof b=="undefined"||b==!1)b=this.getRange();
if(b&&b.collapsed===!0)return[this.getCurrent()];b=this.getSelection();try{var c=b.getRangeAt(0).cloneContents()}catch(a){return!1}b=this.document.createElement("span");b.appendChild(c);window.selnodes=b.childNodes;for(var c=[],b=0,e=selnodes.length;b<e;b++)c.push(selnodes[b]);c.length==0&&c.push(this.getCurrent());return c},getNodes:function(b,d){if(this.opts.linebreaks)return this.getSelectedNodes(b);if(typeof b=="undefined"||b==!1)b=this.getRange();if(b&&b.collapsed===!0)if(typeof d==="undefined"&&
this.tagTestBlock(d)){var a=this.getBlock();return a.tagName==d?[a]:[]}else return[this.getCurrent()];var a=[],e=[],g=this.document.getSelection();g.isCollapsed||(a=this.getRangeSelectedNodes(g.getRangeAt(0)));c.each(a,c.proxy(function(a,b){if(this.opts.iframe===!1&&c(b).parents("div.redactor_editor").size()==0)return!1;typeof d==="undefined"?c.trim(b.textContent)!=""&&e.push(b):b.tagName==d&&e.push(b)},this));if(e.length==0)if(typeof d==="undefined"&&this.tagTestBlock(d))return a=this.getBlock(),
a.tagName==d?e.push(a):[];else e.push(this.getCurrent());return e},getElement:function(b){for(b||(b=this.getCurrent());b;){if(b.nodeType==1){if(c(b).hasClass("redactor_editor"))break;return b}b=b.parentNode}return!1},getRangeSelectedNodes:function(b){var b=b||this.getRange(),c=b.startContainer,a=b.endContainer;if(c==a)return[c];for(var e=[];c&&c!=a;)e.push(c=this.nextNode(c));for(c=b.startContainer;c&&c!=b.commonAncestorContainer;)e.unshift(c),c=c.parentNode;return e},nextNode:function(b){if(b.hasChildNodes())return b.firstChild;
else{for(;b&&!b.nextSibling;)b=b.parentNode;if(!b)return null;return b.nextSibling}},getSelectionText:function(){return this.getSelection().toString()},getSelectionHtml:function(){var b="",c=this.getSelection();if(c.rangeCount){for(var b=this.document.createElement("div"),a=c.rangeCount,e=0;e<a;++e)b.appendChild(c.getRangeAt(e).cloneContents());b=b.innerHTML}return this.syncClean(b)},tableShow:function(){this.selectionSave();this.modalInit(this.opts.curLang.table,this.opts.modal_table,300,c.proxy(function(){c("#redactor_insert_table_btn").click(c.proxy(this.tableInsert,
this));setTimeout(function(){c("#redactor_table_rows").focus()},200)},this))},tableInsert:function(){var b=c("#redactor_table_rows").val(),d=c("#redactor_table_columns").val(),a=c("<div></div>"),e=Math.floor(Math.random()*99999),g=c('<table id="table'+e+'"><tbody></tbody></table>'),f,h,i,k;for(f=0;f<b;f++){h=c("<tr></tr>");for(i=0;i<d;i++)k=c("<td>"+this.opts.invisibleSpace+"</td>"),f===0&&i===0&&k.append('<span id="selection-marker-1">'+this.opts.invisibleSpace+"</span>"),c(h).append(k);g.append(h)}a.append(g);
b=a.html();this.modalClose();this.selectionRestore();(d=this.getBlock()||this.getCurrent())?c(d).after(b):this.insertHtmlAdvanced(b);this.selectionRestore();e=this.$editor.find("#table"+e);this.tableObserver(e);this.buttonActiveObserver();e.removeAttr("id");this.sync()},tableObserver:function(b){this.$table=c(b.target||b).closest("table");this.$tbody=c(b.target).closest("tbody");this.$thead=this.$table.find("thead");this.$current_td=c(b.target||this.$table.find("td").first());this.$current_tr=c(b.target||
this.$table.find("tr").first()).closest("tr")},tableDeleteTable:function(){this.bufferSet();if(this.$table)this.$table.remove(),this.$table=!1,this.sync()},tableDeleteRow:function(){this.bufferSet();if(this.$current_tr){var b=this.$current_tr.prev().length?this.$current_tr.prev():this.$current_tr.next();b.length&&(b=b.children("td").first(),b.length&&(b.prepend('<span id="selection-marker-1">'+this.opts.invisibleSpace+"</span>"),this.selectionRestore()));this.$current_tr.remove();this.sync()}},tableDeleteColumn:function(){this.bufferSet();
var b=this.$current_td.get(0).cellIndex;this.$table.find("tr").each(c.proxy(function(d,a){var e=b-1<0?b+1:b-1;d===0&&(c(a).find("td").eq(e).prepend('<span id="selection-marker-1">'+this.opts.invisibleSpace+"</span>"),this.selectionRestore());c(a).find("td").eq(b).remove()},this));this.sync()},tableAddHead:function(){this.bufferSet();if(this.$table.find("thead").size()!==0)this.tableDeleteHead();else{var b=this.$table.find("tr").first().clone();b.find("td").html(this.opts.invisibleSpace);this.$thead=
c("<thead></thead>");this.$thead.append(b);this.$table.prepend(this.$thead);this.sync()}},tableDeleteHead:function(){this.bufferSet();c(this.$thead).remove();this.$thead=!1;this.sync()},tableAddRowAbove:function(){this.tableAddRow("before")},tableAddRowBelow:function(){this.tableAddRow("after")},tableAddColumnLeft:function(){this.tableAddColumn("before")},tableAddColumnRight:function(){this.tableAddColumn("after")},tableAddRow:function(b){this.bufferSet();var c=this.$current_tr.clone();c.find("td").html(this.opts.invisibleSpace);
b==="after"?this.$current_tr.after(c):this.$current_tr.before(c);this.sync()},tableAddColumn:function(b){this.bufferSet();var d=0;this.$current_tr.find("td").each(c.proxy(function(a,b){c(b)[0]===this.$current_td[0]&&(d=a)},this));this.$table.find("tr").each(c.proxy(function(a,e){var g=c(e).find("td").eq(d),f=g.clone();f.html(this.opts.invisibleSpace);b==="after"?g.after(f):g.before(f)},this));this.sync()},videoShow:function(){this.selectionSave();this.modalInit(this.opts.curLang.video,this.opts.modal_video,
600,c.proxy(function(){c("#redactor_insert_video_btn").click(c.proxy(this.videoInsert,this));setTimeout(function(){c("#redactor_insert_video_area").focus()},200)},this))},videoInsert:function(){var b=c("#redactor_insert_video_area").val(),b=this.cleanStripTags(b);this.selectionRestore();var d=this.getBlock()||this.getCurrent();d?(c(d).after(b),this.sync()):this.insertHtmlAdvanced(b);this.modalClose()},linkShow:function(){this.selectionSave();this.modalInit(this.opts.curLang.link,this.opts.modal_link,
460,c.proxy(function(){this.insert_link_node=!1;var b=this.getSelection(),d="",a="",e="",g=this.getParent();(a=c(g).parent().get(0))&&a.tagName==="A"&&(g=a);g&&g.tagName==="A"?(d=g.href,a=c(g).text(),e=g.target,this.insert_link_node=g):a=b.toString();c(".redactor_link_text").val(a);b=self.location.href.replace(/\/$/i,"");b=d.replace(b,"");g=c("#redactor_tabs").find("a");this.opts.linkEmail===!1&&g.eq(1).remove();this.opts.linkAnchor===!1&&g.eq(2).remove();this.opts.linkEmail===!1&&this.opts.linkAnchor===
!1?(c("#redactor_tabs").remove(),c("#redactor_link_url").val(b)):d.search("mailto:")===0?(this.modalSetTab.call(this,2),c("#redactor_tab_selected").val(2),c("#redactor_link_mailto").val(d.replace("mailto:",""))):b.search(/^#/gi)===0?(this.modalSetTab.call(this,3),c("#redactor_tab_selected").val(3),c("#redactor_link_anchor").val(b.replace(/^#/gi,""))):c("#redactor_link_url").val(b);e==="_blank"&&c("#redactor_link_blank").prop("checked",!0);c("#redactor_insert_link_btn").click(c.proxy(this.linkProcess,
this));setTimeout(function(){c("#redactor_link_url").focus()},200)},this))},linkProcess:function(){var b=c("#redactor_tab_selected").val(),d="",a="",e="",g="";b==="1"?(d=c("#redactor_link_url").val(),a=c("#redactor_link_url_text").val(),c("#redactor_link_blank").prop("checked")&&(e=' target="_blank"',g="_blank"),b=/^((xn--)?[a-z0-9]+(-[a-z0-9]+)*.)+[a-z]{2,}/i,d.search(/^(http|ftp|https):\/\/((xn--)?[a-z0-9]+(-[a-z0-9]+)*.)+[a-z]{2,}/i)==-1&&d.search(b)==0&&this.opts.linkProtocol&&(d=this.opts.linkProtocol+
d)):b==="2"?(d="mailto:"+c("#redactor_link_mailto").val(),a=c("#redactor_link_mailto_text").val()):b==="3"&&(d="#"+c("#redactor_link_anchor").val(),a=c("#redactor_link_anchor_text").val());this.linkInsert('<a href="'+d+'"'+e+">"+a+"</a>",c.trim(a),d,g)},linkInsert:function(b,d,a,e){this.selectionRestore();d!==""&&(this.insert_link_node?(this.bufferSet(),c(this.insert_link_node).text(d).attr("href",a),e!==""?c(this.insert_link_node).attr("target",e):c(this.insert_link_node).removeAttr("target"),this.sync()):
this.exec("inserthtml",b));this.modalClose()},fileShow:function(){this.selectionSave();this.modalInit(this.opts.curLang.file,this.opts.modal_file,500,c.proxy(function(){var b=this.getSelection(),d="",d=this.oldIE()?b.text:b.toString();c("#redactor_filename").val(d);this.isMobile()||this.draguploadInit("#redactor_file",{url:this.opts.fileUpload,uploadFields:this.opts.uploadFields,success:c.proxy(this.fileCallback,this),error:c.proxy(function(a,b){this.callback("fileUploadError",b)},this)});this.uploadInit("redactor_file",
{auto:!0,url:this.opts.fileUpload,success:c.proxy(this.fileCallback,this),error:c.proxy(function(a,b){this.callback("fileUploadError",b)},this)})},this))},fileCallback:function(b){this.selectionRestore();if(b!==!1){var d=c("#redactor_filename").val();if(d==="")d=b.filename;d='<a href="'+b.filelink+'" id="filelink-marker">'+d+"</a>";this.browser("webkit")&&this.window.chrome&&(d+="&nbsp;");this.execCommand("inserthtml",d,!1);d=c(this.$editor.find("a#filelink-marker"));d.size()!=0?d.removeAttr("id"):
d=!1;this.sync();this.callback("fileUpload",d,b)}this.modalClose()},imageShow:function(){this.selectionSave();this.modalInit(this.opts.curLang.image,this.opts.modal_image,610,c.proxy(function(){this.opts.imageGetJson?c.getJSON(this.opts.imageGetJson,c.proxy(function(b){var a={},e=0;c.each(b,c.proxy(function(b,c){typeof c.folder!=="undefined"&&(e++,a[c.folder]=e)},this));var g=!1;c.each(b,c.proxy(function(b,d){var e="";if(typeof d.title!=="undefined")e=d.title;var f=0;!c.isEmptyObject(a)&&typeof d.folder!==
"undefined"&&(f=a[d.folder],g===!1&&(g=".redactorfolder"+f));e=c('<img src="'+d.thumb+'" class="redactorfolder redactorfolder'+f+'" rel="'+d.image+'" title="'+e+'" />');c("#redactor_image_box").append(e);c(e).click(c.proxy(this.imageThumbClick,this))},this));if(!c.isEmptyObject(a)){c(".redactorfolder").hide();c(g).show();var f=c('<select id="redactor_image_box_select">');c.each(a,function(a,b){f.append(c('<option value="'+b+'">'+a+"</option>"))});c("#redactor_image_box").before(f);f.change(function(a){c(".redactorfolder").hide();
c(".redactorfolder"+c(a.target).val()).show()})}},this)):c("#redactor_tabs").find("a").eq(1).remove();if(this.opts.imageUpload||this.opts.s3)if(!this.isMobile()&&this.opts.s3===!1&&c("#redactor_file").length&&this.draguploadInit("#redactor_file",{url:this.opts.imageUpload,uploadFields:this.opts.uploadFields,success:c.proxy(this.imageCallback,this),error:c.proxy(function(b,a){this.callback("imageUploadError",a)},this)}),this.opts.s3===!1)this.uploadInit("redactor_file",{auto:!0,url:this.opts.imageUpload,
success:c.proxy(this.imageCallback,this),error:c.proxy(function(b,a){this.callback("imageUploadError",a)},this)});else c("#redactor_file").on("change.redactor",c.proxy(this.s3handleFileSelect,this));else if(c(".redactor_tab").hide(),this.opts.imageGetJson){var b=c("#redactor_tabs").find("a");b.eq(0).remove();b.eq(1).addClass("redactor_tabs_act");c("#redactor_tab2").show()}else c("#redactor_tabs").remove(),c("#redactor_tab3").show();c("#redactor_upload_btn").click(c.proxy(this.imageCallbackLink,this));
!this.opts.imageUpload&&!this.opts.imageGetJson&&setTimeout(function(){c("#redactor_file_link").focus()},200)},this))},imageEdit:function(b){var d=c(b.target),a=d.parent();this.modalInit(this.opts.curLang.image,this.opts.modal_image_edit,380,c.proxy(function(){c("#redactor_file_alt").val(d.attr("alt"));c("#redactor_image_edit_src").attr("href",d.attr("src"));c("#redactor_form_image_align").val(d.css("float"));c(a).get(0).tagName==="A"&&c("#redactor_file_link").val(c(a).attr("href"));c("#redactor_image_delete_btn").click(c.proxy(function(){this.imageRemove(d)},
this));c("#redactorSaveBtn").click(c.proxy(function(){this.imageSave(d)},this))},this))},imageRemove:function(b){var d=c(b).parent();c(b).remove();d.length&&d[0].tagName==="P"&&(this.$editor.focus(),this.selectionStart(d));this.callback("imageDelete",b);this.modalClose();this.sync()},imageSave:function(b){var d=c(b).parent();c(b).attr("alt",c("#redactor_file_alt").val());var a=c("#redactor_form_image_align").val();a==="left"?(c(b).css({"float":"left",margin:"0 10px 10px 0"}),c(b).addClass("fixed-width")):
(a==="right"?c(b).css({"float":"right",margin:"0 0 10px 10px"}):c(b).css({"float":"none",margin:"0"}),c(b).removeClass("fixed-width"));a=c.trim(c("#redactor_file_link").val());a!==""?c(d).get(0).tagName!=="A"?c(b).replaceWith('<a href="'+a+'">'+this.outerHtml(b)+"</a>"):c(d).attr("href",a):c(d).get(0).tagName==="A"&&c(d).replaceWith(this.outerHtml(b));this.modalClose();this.observeImages();this.sync()},imageResize:function(b){var d=c(b),a=!1,e=!1,g,f=d.width()/d.height();d.off("hover mousedown mouseup click mousemove");
d.hover(function(){d.css("cursor","nw-resize")},function(){d.css("cursor","");a=!1});d.mousedown(function(b){b.preventDefault();f=d.width()/d.height();e=a=!0;d.eq(0).offset();g=Math.round(b.pageY-d.eq(0).offset().top)});d.mouseup(c.proxy(function(){a=!1;d.css("cursor","");this.sync()},this));d.click(c.proxy(function(a){e&&this.imageEdit(a)},this));d.mousemove(function(b){if(a){e=!1;c(this).eq(0).offset();var h=Math.round(b.pageY-c(this).eq(0).offset().top)-g,i=d.height(),h=parseInt(i,10)+h,h=Math.round(h*
f);h>10&&d.width(h);c(this).eq(0).offset();g=Math.round(b.pageY-c(this).eq(0).offset().top)}})},imageThumbClick:function(b){b='<img id="image-marker" src="'+c(b.target).attr("rel")+'" alt="'+c(b.target).attr("title")+'" />';this.opts.paragraphy&&(b="<p>"+b+"</p>");this.imageInsert(b,!0)},imageCallbackLink:function(){var b=c("#redactor_file_link").val();b!==""?(b='<img id="image-marker" src="'+b+'" />',this.opts.linebreaks===!1&&(b="<p>"+b+"</p>"),this.imageInsert(b,!0)):this.modalClose()},imageCallback:function(b){this.imageInsert(b)},
imageInsert:function(b,d){this.selectionRestore();if(b!==!1){var a="";d!==!0?(a='<img id="image-marker" src="'+b.filelink+'" />',this.opts.paragraphy&&(a="<p>"+a+"</p>")):a=b;this.execCommand("inserthtml",a,!1);a=c(this.$editor.find("img#image-marker"));a.length?a.removeAttr("id"):a=!1;this.sync();d!==!0&&this.callback("imageUpload",a,b)}this.modalClose();this.observeImages()},modalTemplatesInit:function(){c.extend(this.opts,{modal_file:String()+'<section><div id="redactor-progress" class="redactor-progress redactor-progress-striped" style="display: none;"><div id="redactor-progress-bar" class="redactor-progress-bar" style="width: 100%;"></div></div><form id="redactorUploadFileForm" method="post" action="" enctype="multipart/form-data"><label>'+
this.opts.curLang.filename+'</label><input type="text" id="redactor_filename" class="redactor_input" /><div style="margin-top: 7px;"><input type="file" id="redactor_file" name="file" /></div></form></section>',modal_image_edit:String()+"<section><label>"+this.opts.curLang.title+'</label><input id="redactor_file_alt" class="redactor_input" /><label>'+this.opts.curLang.link+'</label><input id="redactor_file_link" class="redactor_input" /><label>'+this.opts.curLang.image_position+'</label><select id="redactor_form_image_align"><option value="none">'+
this.opts.curLang.none+'</option><option value="left">'+this.opts.curLang.left+'</option><option value="right">'+this.opts.curLang.right+'</option></select></section><footer><a href="#" id="redactor_image_delete_btn" class="redactor_modal_btn">'+this.opts.curLang._delete+'</a>&nbsp;&nbsp;&nbsp;<a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'</a><input type="button" name="save" class="redactor_modal_btn" id="redactorSaveBtn" value="'+this.opts.curLang.save+
'" /></footer>',modal_image:String()+'<section><div id="redactor_tabs"><a href="#" class="redactor_tabs_act">'+this.opts.curLang.upload+'</a><a href="#">'+this.opts.curLang.choose+'</a><a href="#">'+this.opts.curLang.link+'</a></div><div id="redactor-progress" class="redactor-progress redactor-progress-striped" style="display: none;"><div id="redactor-progress-bar" class="redactor-progress-bar" style="width: 100%;"></div></div><form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data"><div id="redactor_tab1" class="redactor_tab"><input type="file" id="redactor_file" name="file" /></div><div id="redactor_tab2" class="redactor_tab" style="display: none;"><div id="redactor_image_box"></div></div></form><div id="redactor_tab3" class="redactor_tab" style="display: none;"><label>'+
this.opts.curLang.image_web_link+'</label><input type="text" name="redactor_file_link" id="redactor_file_link" class="redactor_input"  /></div></section><footer><a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_upload_btn" value="'+this.opts.curLang.insert+'" /></footer>',modal_link:String()+'<section><form id="redactorInsertLinkForm" method="post" action=""><div id="redactor_tabs"><a href="#" class="redactor_tabs_act">URL</a><a href="#">Email</a><a href="#">'+
this.opts.curLang.anchor+'</a></div><input type="hidden" id="redactor_tab_selected" value="1" /><div class="redactor_tab" id="redactor_tab1"><label>URL</label><input type="text" id="redactor_link_url" class="redactor_input"  /><label>'+this.opts.curLang.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_url_text" /><label><input type="checkbox" id="redactor_link_blank"> '+this.opts.curLang.link_new_tab+'</label></div><div class="redactor_tab" id="redactor_tab2" style="display: none;"><label>Email</label><input type="text" id="redactor_link_mailto" class="redactor_input" /><label>'+
this.opts.curLang.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_mailto_text" /></div><div class="redactor_tab" id="redactor_tab3" style="display: none;"><label>'+this.opts.curLang.anchor+'</label><input type="text" class="redactor_input" id="redactor_link_anchor"  /><label>'+this.opts.curLang.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_anchor_text" /></div></form></section><footer><a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+
this.opts.curLang.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_link_btn" value="'+this.opts.curLang.insert+'" /></footer>',modal_table:String()+"<section><label>"+this.opts.curLang.rows+'</label><input type="text" size="5" value="2" id="redactor_table_rows" /><label>'+this.opts.curLang.columns+'</label><input type="text" size="5" value="3" id="redactor_table_columns" /></section><footer><a href="#" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+
'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_insert_table_btn" value="'+this.opts.curLang.insert+'" /></footer>',modal_video:String()+'<section><form id="redactorInsertVideoForm"><label>'+this.opts.curLang.video_html_code+'</label><textarea id="redactor_insert_video_area" style="width: 99%; height: 160px;"></textarea></form></section><footer><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+this.opts.curLang.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_video_btn" value="'+
this.opts.curLang.insert+'" /></footer>'})},modalInit:function(b,d,a,e){var g=c("#redactor_modal_overlay");if(!g.length)this.$overlay=g=c('<div id="redactor_modal_overlay" style="display: none;"></div>'),c("body").prepend(this.$overlay);if(this.opts.modalOverlay)g.show().on("click",c.proxy(this.modalClose,this));var f=c("#redactor_modal");if(!f.length)this.$modal=f=c('<div id="redactor_modal" style="display: none;"><div id="redactor_modal_close">&times;</div><header id="redactor_modal_header"></header><div id="redactor_modal_inner"></div></div>'),
c("body").append(this.$modal);c("#redactor_modal_close").on("click",c.proxy(this.modalClose,this));this.hdlModalClose=c.proxy(function(a){if(a.keyCode===this.keyCode.ESC)return this.modalClose(),!1},this);c(document).keyup(this.hdlModalClose);this.$editor.keyup(this.hdlModalClose);this.modalcontent=!1;d.indexOf("#")==0?(this.modalcontent=c(d),c("#redactor_modal_inner").empty().append(this.modalcontent.html()),this.modalcontent.html("")):c("#redactor_modal_inner").empty().append(d);f.find("#redactor_modal_header").html(b);
typeof c.fn.draggable!=="undefined"&&(f.draggable({handle:"#redactor_modal_header"}),f.find("#redactor_modal_header").css("cursor","move"));var h=c("#redactor_tabs");if(h.length){var i=this;h.find("a").each(function(a,b){a++;c(b).on("click",function(b){b.preventDefault();h.find("a").removeClass("redactor_tabs_act");c(this).addClass("redactor_tabs_act");c(".redactor_tab").hide();c("#redactor_tab"+a).show();c("#redactor_tab_selected").val(a);i.isMobile()===!1&&(b=f.outerHeight(),f.css("margin-top",
"-"+(b+10)/2+"px"))})})}f.find(".redactor_btn_modal_close").on("click",c.proxy(this.modalClose,this));this.isMobile()===!1?(f.css({position:"fixed",top:"-2000px",left:"50%",width:a+"px",marginLeft:"-"+(a+60)/2+"px"}).show(),this.modalSaveBodyOveflow=c(document.body).css("overflow"),c(document.body).css("overflow","hidden")):f.css({position:"fixed",width:"100%",height:"100%",top:"0",left:"0",margin:"0",minHeight:"300px"}).show();typeof e==="function"&&e();this.isMobile()===!1&&setTimeout(function(){var a=
f.outerHeight();f.css({top:"50%",height:"auto",minHeight:"auto",marginTop:"-"+(a+10)/2+"px"})},20)},modalClose:function(){c("#redactor_modal_close").off("click",this.modalClose);c("#redactor_modal").fadeOut("fast",c.proxy(function(){var b=c("#redactor_modal_inner");if(this.modalcontent!==!1)this.modalcontent.html(b.html()),this.modalcontent=!1;b.html("");this.opts.modalOverlay&&c("#redactor_modal_overlay").hide().off("click",this.modalClose);c(document).unbind("keyup",this.hdlModalClose);this.$editor.unbind("keyup",
this.hdlModalClose)},this));this.isMobile()===!1&&c(document.body).css("overflow",this.modalSaveBodyOveflow?this.modalSaveBodyOveflow:"visible");return!1},modalSetTab:function(b){c(".redactor_tab").hide();c("#redactor_tabs").find("a").removeClass("redactor_tabs_act").eq(b-1).addClass("redactor_tabs_act");c("#redactor_tab"+b).show()},s3handleFileSelect:function(b){for(var b=b.target.files,c=0,a;a=b[c];c++)this.s3uploadFile(a)},s3uploadFile:function(b){this.s3executeOnSignedUrl(b,c.proxy(function(c){this.s3uploadToS3(b,
c)},this))},s3executeOnSignedUrl:function(b,d){var a=new XMLHttpRequest;a.open("GET",this.opts.s3+"?name="+b.name+"&type="+b.type,!0);a.overrideMimeType("text/plain; charset=x-user-defined");a.onreadystatechange=function(){this.readyState==4&&this.status==200&&(c("#redactor-progress").fadeIn(),d(decodeURIComponent(this.responseText)))};a.send()},s3createCORSRequest:function(b,c){var a=new XMLHttpRequest;"withCredentials"in a?a.open(b,c,!0):typeof XDomainRequest!="undefined"?(a=new XDomainRequest,
a.open(b,c)):a=null;return a},s3uploadToS3:function(b,d){var a=this.s3createCORSRequest("PUT",d);if(a)a.onload=c.proxy(function(){if(a.status==200){c("#redactor-progress").hide();var b=d.split("?");if(!b[0])return!1;this.selectionRestore();var g="",g='<img id="image-marker" src="'+b[0]+'" />';this.opts.paragraphy&&(g="<p>"+g+"</p>");this.execCommand("inserthtml",g,!1);b=c(this.$editor.find("img#image-marker"));b.length?b.removeAttr("id"):b=!1;this.sync();this.callback("imageUpload",b,!1);this.modalClose();
this.observeImages()}},this),a.onerror=function(){},a.upload.onprogress=function(){},a.setRequestHeader("Content-Type",b.type),a.setRequestHeader("x-amz-acl","public-read"),a.send(b)},uploadInit:function(b,d){this.uploadOptions={url:!1,success:!1,error:!1,start:!1,trigger:!1,auto:!1,input:!1};c.extend(this.uploadOptions,d);var a=c("#"+b);a.length&&a[0].tagName==="INPUT"?(this.uploadOptions.input=a,this.el=c(a[0].form)):this.el=a;this.element_action=this.el.attr("action");this.uploadOptions.auto?c(this.uploadOptions.input).change(c.proxy(function(a){this.el.submit(function(){return!1});
this.uploadSubmit(a)},this)):this.uploadOptions.trigger&&c("#"+this.uploadOptions.trigger).click(c.proxy(this.uploadSubmit,this))},uploadSubmit:function(){c("#redactor-progress").fadeIn();this.uploadForm(this.element,this.uploadFrame())},uploadFrame:function(){this.id="f"+Math.floor(Math.random()*99999);var b=this.document.createElement("div");b.innerHTML='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"></iframe>';c(b).appendTo("body");this.uploadOptions.start&&this.uploadOptions.start();
c("#"+this.id).load(c.proxy(this.uploadLoaded,this));return this.id},uploadForm:function(b,d){if(this.uploadOptions.input){var a="redactorUploadForm"+this.id,e="redactorUploadFile"+this.id;this.form=c('<form  action="'+this.uploadOptions.url+'" method="POST" target="'+d+'" name="'+a+'" id="'+a+'" enctype="multipart/form-data" />');this.opts.uploadFields!==!1&&typeof this.opts.uploadFields==="object"&&c.each(this.opts.uploadFields,c.proxy(function(a,b){b.toString().indexOf("#")===0&&(b=c(b).val());
var d=c("<input/>",{type:"hidden",name:a,value:b});c(this.form).append(d)},this));var a=this.uploadOptions.input,g=c(a).clone();c(a).attr("id",e).before(g).appendTo(this.form);c(this.form).css("position","absolute").css("top","-2000px").css("left","-2000px").appendTo("body");this.form.submit()}else b.attr("target",d).attr("method","POST").attr("enctype","multipart/form-data").attr("action",this.uploadOptions.url),this.element.submit()},uploadLoaded:function(){var b=c("#"+this.id)[0],b=b.contentDocument?
b.contentDocument:b.contentWindow?b.contentWindow.document:window.frames[this.id].document;this.uploadOptions.success&&(c("#redactor-progress").hide(),typeof b!=="undefined"?(b=b.body.innerHTML.match(/\{(.|\n)*\}/)[0],b=b.replace(/^\[/,""),b=b.replace(/\]$/,""),b=c.parseJSON(b),typeof b.error=="undefined"?this.uploadOptions.success(b):(this.uploadOptions.error(this,b),this.modalClose())):(this.modalClose(),alert("Upload failed!")));this.el.attr("action",this.element_action);this.el.attr("target",
"")},draguploadInit:function(b,d){this.draguploadOptions=c.extend({url:!1,success:!1,error:!1,preview:!1,uploadFields:!1,text:this.opts.curLang.drop_file_here,atext:this.opts.curLang.or_choose},d);if(window.FormData===void 0)return!1;this.droparea=c('<div class="redactor_droparea"></div>');this.dropareabox=c('<div class="redactor_dropareabox">'+this.draguploadOptions.text+"</div>");this.dropalternative=c('<div class="redactor_dropalternative">'+this.draguploadOptions.atext+"</div>");this.droparea.append(this.dropareabox);
c(b).before(this.droparea);c(b).before(this.dropalternative);this.dropareabox.on("dragover",c.proxy(function(){return this.draguploadOndrag()},this));this.dropareabox.on("dragleave",c.proxy(function(){return this.draguploadOndragleave()},this));this.dropareabox.get(0).ondrop=c.proxy(function(a){a.preventDefault();this.dropareabox.removeClass("hover").addClass("drop");this.draguploadUpload(a.dataTransfer.files[0])},this)},draguploadUpload:function(b){var d=jQuery.ajaxSettings.xhr();d.upload&&d.upload.addEventListener("progress",
c.proxy(this.uploadProgress,this),!1);var a=new FormData;this.draguploadOptions.uploadFields!==!1&&typeof this.draguploadOptions.uploadFields==="object"&&c.each(this.draguploadOptions.uploadFields,c.proxy(function(b,d){d.toString().indexOf("#")===0&&(d=c(d).val());a.append(b,d)},this));a.append("file",b);c.ajax({url:this.draguploadOptions.url,dataType:"html",data:a,xhr:function(){return d},cache:!1,contentType:!1,processData:!1,type:"POST",success:c.proxy(function(a){a=a.replace(/^\[/,"");a=a.replace(/\]$/,
"");a=c.parseJSON(a);typeof a.error=="undefined"?this.draguploadOptions.success(a):(this.draguploadOptions.error(this,a),this.draguploadOptions.success(!1))},this)})},draguploadOndrag:function(){this.dropareabox.addClass("hover");return!1},draguploadOndragleave:function(){this.dropareabox.removeClass("hover");return!1},uploadProgress:function(b,c){this.dropareabox.text("Loading "+(b.loaded?parseInt(b.loaded/b.total*100,10):b)+"% "+(c||""))},isMobile:function(){return/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)},
outerHtml:function(b){return c("<div>").append(c(b).eq(0).clone()).html()},isString:function(b){return Object.prototype.toString.call(b)=="[object String]"},isEmpty:function(b){b=b.replace(/&#x200b;|<br>|<br\/>|&nbsp;/gi,"");b=b.replace(/\s/g,"");b=b.replace(/^<p>[^\w\d]*?<\/p>$/i,"");return b==""},browser:function(b){var c=navigator.userAgent.toLowerCase(),c=/(chrome)[ \/]([\w.]+)/.exec(c)||/(webkit)[ \/]([\w.]+)/.exec(c)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(c)||/(msie) ([\w.]+)/.exec(c)||
c.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(c)||[];if(b=="version")return c[2];if(b=="webkit")return c[1]=="chrome"||c[1]=="webkit";return c[1]==b},oldIE:function(){if(this.browser("msie")&&parseInt(this.browser("version"),10)<9)return!0;return!1},getFragmentHtml:function(b){var b=b.cloneNode(!0),c=this.document.createElement("div");c.appendChild(b);return c.innerHTML},extractContent:function(){for(var b=this.$editor[0],c=this.document.createDocumentFragment(),a;a=b.firstChild;)c.appendChild(a);
return c},isParentRedactor:function(b){if(!b)return!1;if(this.opts.iframe)return b;return c(b).parents("div.redactor_editor").length==0||c(b).hasClass("redactor_editor")?!1:b},currentOrParentIs:function(b){var c=this.getParent(),a=this.getCurrent();return c&&c.tagName===b?c:a&&a.tagName===b?a:!1},isEndOfElement:function(){var b=this.getBlock(),d=this.getCaretOffset(b),b=c.trim(c(b).text()).replace(/\n\r\n/g,"").length;return d==b?!0:!1},isFocused:function(){var b,d=this.getSelection();if(d.rangeCount&&
d.rangeCount>0)b=d.getRangeAt(0).startContainer;if(!b)return!1;if(this.opts.iframe)return this.getCaretOffsetRange().equals()?!this.$editor.is(b):!0;return c(b).closest("div.redactor_editor").length!=0},removeEmptyAttr:function(b,d){c(b).attr(d)==""&&c(b).removeAttr(d)},removeFromArrayByValue:function(b,c){for(var a=null;(a=b.indexOf(c))!==-1;)b.splice(a,1);return b}};f.prototype.init.prototype=f.prototype;c.Redactor.fn.formatLinkify=function(b){for(var d=/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,
a=/(^|&lt;|\s)(((https?|ftp):\/\/|mailto:).+?)(\s|&gt;|$)/g,e=(this.$editor?this.$editor.get(0):this).childNodes,g=e.length;g--;){var f=e[g];if(f.nodeType===3){var h=f.nodeValue;if(h&&(h.match(d)||h.match(a)))h=h.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(d,'$1<a href="'+b+'$2">$2</a>$3').replace(a,'$1<a href="$2">$2</a>$5'),c(f).after(h).remove()}else f.nodeType===1&&!/^(a|button|textarea)$/i.test(f.tagName)&&c.Redactor.fn.formatLinkify.call(f,b)}}})(jQuery);if(!RedactorPlugins)var RedactorPlugins={};
RedactorPlugins.fullscreen={init:function(){this.fullscreen=!1;this.buttonAdd("fullscreen","Fullscreen",$.proxy(this.toggleFullscreen,this));this.buttonSetRight("fullscreen");this.opts.fullscreen&&this.toggleFullscreen()},toggleFullscreen:function(){var c;if(this.fullscreen)this.buttonRemoveIcon("fullscreen","normalscreen"),this.buttonInactive("fullscreen"),this.fullscreen=!1,$(window).off("resize",$.proxy(this.fullScreenResize,this)),$("body, html").css("overflow",""),this.$box.removeClass("redactor_box_fullscreen").css({width:"auto",
height:"auto"}),this.opts.iframe&&(c=this.$editor.html()),this.tmpspan.after(this.$box).remove(),this.opts.iframe?this.fullscreenIframe(c):this.sync(),c=this.fsheight,this.opts.autoresize&&(c="auto"),this.opts.toolbarExternal&&(this.$box.css("top",this.boxcss.top),this.$toolbar.css({width:this.toolcss.width,top:this.toolcss.top,position:this.toolcss.position})),this.opts.iframe?this.$frame.css("height",c):this.$editor.css("height",c),this.$editor.css("height",c);else{this.buttonChangeIcon("fullscreen",
"normalscreen");this.buttonActive("fullscreen");this.fullscreen=!0;if(this.opts.toolbarExternal)this.toolcss={},this.boxcss={},this.toolcss.width=this.$toolbar.css("width"),this.toolcss.top=this.$toolbar.css("top"),this.toolcss.position=this.$toolbar.css("position"),this.boxcss.top=this.$box.css("top");this.fsheight=this.$editor.height();this.opts.iframe&&(c=this.get());this.tmpspan=$("<span></span>");this.$box.addClass("redactor_box_fullscreen").after(this.tmpspan);$("body, html").css("overflow",
"hidden");$("body").prepend(this.$box);this.opts.iframe&&this.fullscreenIframe(c);this.fullScreenResize();$(window).resize($.proxy(this.fullScreenResize,this));$(document).scrollTop(0,0)}this.focus();this.observeStart()},fullscreenIframe:function(c){this.$editor=this.$frame.contents().find("body").attr({contenteditable:!0,dir:this.opts.direction});if(this.$editor[0])this.document=this.$editor[0].ownerDocument,this.window=this.document.defaultView||window;this.iframeAddCss();this.opts.fullpage?this.setFullpageOnInit(c):
this.set(c);this.opts.wym&&this.$editor.addClass("redactor_editor_wym")},fullScreenResize:function(){if(!this.fullscreen)return!1;var c=this.$toolbar.height(),f=this.$editor.css("padding-top").replace("px",""),h=$(window).height()-c;this.$box.width($(window).width()-2).height(h+c);this.opts.toolbarExternal&&(this.$toolbar.css({top:"0px",position:"absolute",width:"100%"}),this.$box.css("top",c+"px"));this.opts.iframe?setTimeout($.proxy(function(){this.$frame.height(h)},this),1):this.$editor.height(h-
f*2);this.$editor.height(h)}};(function(){var c;c=function(){function c(){this.options_index=0;this.parsed=[]}c.prototype.add_node=function(c){return c.nodeName.toUpperCase()==="OPTGROUP"?this.add_group(c):this.add_option(c)};c.prototype.add_group=function(c){var f,b,d,a,e,g;f=this.parsed.length;this.parsed.push({array_index:f,group:!0,label:c.label,children:0,disabled:c.disabled});e=c.childNodes;g=[];d=0;for(a=e.length;d<a;d++)b=e[d],g.push(this.add_option(b,f,c.disabled));return g};c.prototype.add_option=function(c,f,b){if(c.nodeName.toUpperCase()===
"OPTION")return c.text!==""?(f!=null&&(this.parsed[f].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:c.value,text:c.text,html:c.innerHTML,selected:c.selected,disabled:b===!0?b:c.disabled,group_array_index:f,classes:c.className,style:c.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1};return c}();c.select_to_array=function(f){var h,i,b,d;h=new c;d=f.childNodes;i=
0;for(b=d.length;i<b;i++)f=d[i],h.add_node(f);return h.parsed};this.SelectParser=c}).call(this);
(function(){this.AbstractChosen=function(){function c(c,h){this.form_field=c;this.options=h!=null?h:{};this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers();this.finish_setup()}c.prototype.set_default_values=function(){var c=this;this.click_test_action=function(h){return c.test_active_click(h)};this.activate_action=function(h){return c.activate_field(h)};this.results_showing=this.mouse_on_container=this.active_field=
!1;this.result_single_selected=this.result_highlighted=null;this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||!1;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:!0;this.search_contains=this.options.search_contains||
!1;this.choices=0;this.single_backstroke_delete=this.options.single_backstroke_delete||!1;this.max_selected_options=this.options.max_selected_options||Infinity;return this.inherit_select_classes=this.options.inherit_select_classes||!1};c.prototype.set_default_text=function(){this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":
this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option";return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"};c.prototype.mouse_enter=function(){return this.mouse_on_container=!0};c.prototype.mouse_leave=function(){return this.mouse_on_container=!1};c.prototype.input_focus=function(){var c=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return c.container_mousedown()},
50)}else if(!this.active_field)return this.activate_field()};c.prototype.input_blur=function(){var c=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return c.blur_test()},100)};c.prototype.result_add_option=function(c){var h,i;return c.disabled?"":(c.dom_id=this.container_id+"_o_"+c.array_index,h=c.selected&&this.is_multiple?[]:["active-result"],c.selected&&h.push("result-selected"),c.group_array_index!=null&&h.push("group-option"),c.classes!==""&&h.push(c.classes),
i=c.style.cssText!==""?' style="'+c.style+'"':"",'<li id="'+c.dom_id+'" class="'+h.join(" ")+'"'+i+">"+c.html+"</li>")};c.prototype.results_update_field=function(){this.is_multiple||this.results_reset_cleanup();this.result_clear_highlight();this.result_single_selected=null;return this.results_build()};c.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()};c.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()};
c.prototype.keyup_checker=function(c){var h,i;h=(i=c.which)!=null?i:c.keyCode;this.search_field_scale();switch(h){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();else if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:c.preventDefault();if(this.results_showing)return this.result_select(c);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;
default:return this.results_search()}};c.prototype.generate_field_id=function(){var c;c=this.generate_random_id();return this.form_field.id=c};c.prototype.generate_random_char=function(){var c;c=Math.floor(Math.random()*36);return"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(c,c+1)};return c}()}).call(this);
(function(){var c,f,h,i,b={}.hasOwnProperty,d=function(a,c){function d(){this.constructor=a}for(var f in c)b.call(c,f)&&(a[f]=c[f]);d.prototype=c.prototype;a.prototype=new d;a.__super__=c.prototype;return a};i=this;c=jQuery;c.fn.extend({chosen:function(a){var b;b=/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];b={name:b[1]||"",version:b[2]||"0"};if(b.name==="msie"&&(b.version==="6.0"||b.version==="7.0"&&document.documentMode===7))return this;return this.each(function(){var b;b=c(this);
if(!b.hasClass("chzn-done"))return b.data("chosen",new f(this,a))})}});f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}d(b,a);b.prototype.setup=function(){this.form_field_jq=c(this.form_field);this.current_value=this.form_field_jq.val();return this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")};b.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")};b.prototype.set_up_html=function(){var a,b;this.container_id=this.form_field.id.length?
this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id();this.container_id+="_chzn";a=["chzn-container"];a.push("chzn-container-"+(this.is_multiple?"multi":"single"));this.inherit_select_classes&&this.form_field.className&&a.push(this.form_field.className);this.is_rtl&&a.push("chzn-rtl");this.f_width=this.form_field_jq.outerWidth();a={id:this.container_id,"class":a.join(" "),style:"width: "+this.f_width+"px;",title:this.form_field.title};a=c("<div />",a);this.is_multiple?a.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+
this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):a.html('<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>');this.form_field_jq.hide().after(a);
this.container=c("#"+this.container_id);this.dropdown=this.container.find("div.chzn-drop").first();a=this.container.height();b=this.f_width-h(this.dropdown);this.dropdown.css({width:b+"px",top:a+"px"});this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chzn-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),
this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),a=b-h(this.search_container)-h(this.search_field),this.search_field.css({width:a+"px"}));this.results_build();this.set_tab_index();return this.form_field_jq.trigger("liszt:ready",{chosen:this})};b.prototype.register_observers=function(){var a=this;this.container.mousedown(function(b){return a.container_mousedown(b)});
this.container.mouseup(function(b){return a.container_mouseup(b)});this.container.mouseenter(function(b){return a.mouse_enter(b)});this.container.mouseleave(function(b){return a.mouse_leave(b)});this.search_results.mouseup(function(b){return a.search_results_mouseup(b)});this.search_results.mouseover(function(b){return a.search_results_mouseover(b)});this.search_results.mouseout(function(b){return a.search_results_mouseout(b)});this.form_field_jq.bind("liszt:updated",function(b){return a.results_update_field(b)});
this.form_field_jq.bind("liszt:activate",function(b){return a.activate_field(b)});this.form_field_jq.bind("liszt:open",function(b){return a.container_mousedown(b)});this.search_field.blur(function(b){return a.input_blur(b)});this.search_field.keyup(function(b){return a.keyup_checker(b)});this.search_field.keydown(function(b){return a.keydown_checker(b)});this.search_field.focus(function(b){return a.input_focus(b)});return this.is_multiple?this.search_choices.click(function(b){return a.choices_click(b)}):
this.container.click(function(a){return a.preventDefault()})};b.prototype.search_field_disabled=function(){if(this.is_disabled=this.form_field_jq[0].disabled)return this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field();else if(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,!this.is_multiple)return this.selected_item.bind("focus",this.activate_action)};b.prototype.container_mousedown=
function(a){var b;if(!this.is_disabled)if(b=a!=null?c(a.target).hasClass("search-choice-close"):!1,a&&a.type==="mousedown"&&!this.results_showing&&a.preventDefault(),!this.pending_destroy_click&&!b){if(this.active_field){if(!this.is_multiple&&a&&(c(a.target)[0]===this.selected_item[0]||c(a.target).parents("a.chzn-single").length))a.preventDefault(),this.results_toggle()}else this.is_multiple&&this.search_field.val(""),c(document).click(this.click_test_action),this.results_show();return this.activate_field()}else return this.pending_destroy_click=
!1};b.prototype.container_mouseup=function(a){if(a.target.nodeName==="ABBR"&&!this.is_disabled)return this.results_reset(a)};b.prototype.blur_test=function(){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()};b.prototype.close_field=function(){c(document).unbind("click",this.click_test_action);this.active_field=!1;this.results_hide();this.container.removeClass("chzn-container-active");this.winnow_results_clear();this.clear_backstroke();this.show_search_field_default();
return this.search_field_scale()};b.prototype.activate_field=function(){this.container.addClass("chzn-container-active");this.active_field=!0;this.search_field.val(this.search_field.val());return this.search_field.focus()};b.prototype.test_active_click=function(a){return c(a.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()};b.prototype.results_build=function(){var a,b,c,d,e;this.parsing=!0;this.results_data=i.SelectParser.select_to_array(this.form_field);this.is_multiple&&
this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch"));a="";e=this.results_data;c=0;for(d=e.length;c<d;c++)b=e[c],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),
b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();this.search_results.html(a);return this.parsing=!1};b.prototype.result_add_group=function(a){return a.disabled?"":(a.dom_id=this.container_id+"_g_"+a.array_index,'<li id="'+a.dom_id+'" class="group-result">'+
c("<div />").text(a.label).html()+"</li>")};b.prototype.result_do_highlight=function(a){var b,c,d,e;if(a.length)if(this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),c=parseInt(this.search_results.css("maxHeight"),10),e=this.search_results.scrollTop(),d=c+e,b=this.result_highlight.position().top+this.search_results.scrollTop(),a=b+this.result_highlight.outerHeight(),a>=d)return this.search_results.scrollTop(a-c>0?a-c:0);else if(b<e)return this.search_results.scrollTop(b)};
b.prototype.result_clear_highlight=function(){this.result_highlight&&this.result_highlight.removeClass("highlighted");return this.result_highlight=null};b.prototype.results_show=function(){var a;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);a=this.is_multiple?this.container.height():
this.container.height()-1;this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this});this.dropdown.css({top:a+"px",left:0});this.results_showing=!0;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};b.prototype.results_hide=function(){this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop");this.result_clear_highlight();this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this});this.dropdown.css({left:"-9000px"});
return this.results_showing=!1};b.prototype.set_tab_index=function(){var a;if(this.form_field_jq.attr("tabindex"))return a=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",a)};b.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))};b.prototype.search_results_mouseup=
function(a){var b;b=c(a.target).hasClass("active-result")?c(a.target):c(a.target).parents(".active-result").first();if(b.length)return this.result_highlight=b,this.result_select(a),this.search_field.focus()};b.prototype.search_results_mouseover=function(a){if(a=c(a.target).hasClass("active-result")?c(a.target):c(a.target).parents(".active-result").first())return this.result_do_highlight(a)};b.prototype.search_results_mouseout=function(a){if(c(a.target).hasClass("active-result"))return this.result_clear_highlight()};
b.prototype.choices_click=function(a){a.preventDefault();if(this.active_field&&!c(a.target).hasClass("search-choice")&&!this.results_showing)return this.results_show()};b.prototype.choice_build=function(a){var b,d=this;if(this.is_multiple&&this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1;b=this.container_id+"_c_"+a.array_index;this.choices+=1;this.search_container.before(a.disabled?'<li class="search-choice search-choice-disabled" id="'+
b+'"><span>'+a.html+"</span></li>":'<li class="search-choice" id="'+b+'"><span>'+a.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+a.array_index+'"></a></li>');return c("#"+b).find("a").first().click(function(a){return d.choice_destroy_link_click(a)})};b.prototype.choice_destroy_link_click=function(a){a.preventDefault();return this.is_disabled?a.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(c(a.target)))};b.prototype.choice_destroy=function(a){if(this.result_deselect(a.attr("rel")))return this.choices-=
1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),a.parents("li").first().remove(),this.search_field_scale()};b.prototype.results_reset=function(){this.form_field.options[0].selected=!0;this.selected_item.find("span").text(this.default_text);this.is_multiple||this.selected_item.addClass("chzn-default");this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field)return this.results_hide()};
b.prototype.results_reset_cleanup=function(){this.current_value=this.form_field_jq.val();return this.selected_item.find("abbr").remove()};b.prototype.result_select=function(a){var b,c;if(this.result_highlight)return b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(b):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b,this.selected_item.removeClass("chzn-default")),b.addClass("result-selected"),
b=c.substr(c.lastIndexOf("_")+1),b=this.results_data[b],b.selected=!0,this.form_field.options[b.options_index].selected=!0,this.is_multiple?this.choice_build(b):(this.selected_item.find("span").first().text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()),(!a.metaKey&&!a.ctrlKey||!this.is_multiple)&&this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[b.options_index].value}),
this.current_value=this.form_field_jq.val(),this.search_field_scale()};b.prototype.result_activate=function(a){return a.addClass("active-result")};b.prototype.result_deactivate=function(a){return a.removeClass("active-result")};b.prototype.result_deselect=function(a){var b;b=this.results_data[a];return this.form_field.options[b.options_index].disabled?!1:(b.selected=!1,this.form_field.options[b.options_index].selected=!1,a=c("#"+this.container_id+"_o_"+a),a.removeClass("result-selected").addClass("active-result").show(),
this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[b.options_index].value}),this.search_field_scale(),!0)};b.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect&&this.selected_item.find("abbr").length<1)return this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')};b.prototype.winnow_results=function(){var a,b,d,e,f,h,i,n,r,s,z,v,E,y,w;this.no_results_clear();n=
0;r=this.search_field.val()===this.default_text?"":c("<div/>").text(c.trim(this.search_field.val())).html();f=RegExp((this.search_contains?"":"^")+r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");s=RegExp(r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");w=this.results_data;z=0;for(E=w.length;z<E;z++)if(b=w[z],!b.disabled&&!b.empty)if(b.group)c("#"+b.dom_id).css("display","none");else if(!this.is_multiple||!b.selected){a=!1;i=b.dom_id;h=c("#"+i);if(f.test(b.html))a=!0,n+=1;else if(this.enable_split_word_search&&
(b.html.indexOf(" ")>=0||b.html.indexOf("[")===0))if(e=b.html.replace(/\[|\]/g,"").split(" "),e.length){v=0;for(y=e.length;v<y;v++)d=e[v],f.test(d)&&(a=!0,n+=1)}a?(r.length?(a=b.html.search(s),d=b.html.substr(0,a+r.length)+"</em>"+b.html.substr(a+r.length),d=d.substr(0,a)+"<em>"+d.substr(a)):d=b.html,h.html(d),this.result_activate(h),b.group_array_index!=null&&c("#"+this.results_data[b.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&i===this.result_highlight.attr("id")&&
this.result_clear_highlight(),this.result_deactivate(h))}return n<1&&r.length?this.no_results(r):this.winnow_results_set_highlight()};b.prototype.winnow_results_clear=function(){var a,b,d,e,f;this.search_field.val("");b=this.search_results.find("li");f=[];d=0;for(e=b.length;d<e;d++)a=b[d],a=c(a),a.hasClass("group-result")?f.push(a.css("display","auto")):!this.is_multiple||!a.hasClass("result-selected")?f.push(this.result_activate(a)):f.push(void 0);return f};b.prototype.winnow_results_set_highlight=
function(){var a;if(!this.result_highlight&&(a=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[],a=a.length?a.first():this.search_results.find(".active-result").first(),a!=null))return this.result_do_highlight(a)};b.prototype.no_results=function(a){var b;b=c('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');b.find("span").first().html(a);return this.search_results.append(b)};b.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};
b.prototype.keydown_arrow=function(){var a;this.result_highlight?this.results_showing&&(a=this.result_highlight.nextAll("li.active-result").first())&&this.result_do_highlight(a):(a=this.search_results.find("li.active-result").first())&&this.result_do_highlight(c(a));if(!this.results_showing)return this.results_show()};b.prototype.keyup_arrow=function(){var a;if(!this.results_showing&&!this.is_multiple)return this.results_show();else if(this.result_highlight)return a=this.result_highlight.prevAll("li.active-result"),
a.length?this.result_do_highlight(a.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())};b.prototype.keydown_backstroke=function(){var a;if(this.pending_backstroke)return this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke();else if(a=this.search_container.siblings("li.search-choice").last(),a.length&&!a.hasClass("search-choice-disabled"))return this.pending_backstroke=a,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")};
b.prototype.clear_backstroke=function(){this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus");return this.pending_backstroke=null};b.prototype.keydown_checker=function(a){var b,c;b=(c=a.which)!=null?c:a.keyCode;this.search_field_scale();b!==8&&this.pending_backstroke&&this.clear_backstroke();switch(b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a);this.mouse_on_container=!1;break;
case 13:a.preventDefault();break;case 38:a.preventDefault();this.keyup_arrow();break;case 40:this.keydown_arrow()}};b.prototype.search_field_scale=function(){var a,b,d,e,f;if(this.is_multiple){b="position:absolute; left: -1000px; top: -1000px; display:none;";d=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];e=0;for(f=d.length;e<f;e++)a=d[e],b+=a+":"+this.search_field.css(a)+";";a=c("<div />",{style:b});a.text(this.search_field.val());c("body").append(a);
b=a.width()+25;a.remove();b>this.f_width-10&&(b=this.f_width-10);this.search_field.css({width:b+"px"});a=this.container.height();return this.dropdown.css({top:a+"px"})}};b.prototype.generate_random_id=function(){var a;for(a="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();c("#"+a).length>0;)a+=this.generate_random_char();return a};return b}(AbstractChosen);i.Chosen=f;h=function(a){return a.outerWidth()-a.width()};i.get_side_border_padding=h}).call(this);(function(c){c.widget("ui.tagit",{options:{allowDuplicates:!1,caseSensitive:!0,fieldName:"tags",placeholderText:null,readOnly:!1,removeConfirmation:!1,tagLimit:null,availableTags:[],autocomplete:{},showAutocompleteOnFocus:!1,allowSpaces:!1,singleField:!1,singleFieldDelimiter:",",singleFieldNode:null,animate:!0,tabIndex:null,beforeTagAdded:null,afterTagAdded:null,beforeTagRemoved:null,afterTagRemoved:null,onTagClicked:null,onTagLimitExceeded:null,onTagAdded:null,onTagRemoved:null,tagSource:null},_create:function(){var f=
this;this.element.is("input")?(this.tagList=c("<ul></ul>").insertAfter(this.element),this.options.singleField=!0,this.options.singleFieldNode=this.element,this.element.css("display","none")):this.tagList=this.element.find("ul, ol").andSelf().last();this.tagInput=c('<input type="text" />').addClass("ui-widget-content");this.options.readOnly&&this.tagInput.attr("disabled","disabled");this.options.tabIndex&&this.tagInput.attr("tabindex",this.options.tabIndex);this.options.placeholderText&&this.tagInput.attr("placeholder",
this.options.placeholderText);if(!this.options.autocomplete.source)this.options.autocomplete.source=function(b,a){var e=b.term.toLowerCase(),f=c.grep(this.options.availableTags,function(a){return a.toLowerCase().indexOf(e)===0});a(this._subtractArray(f,this.assignedTags()))};if(this.options.showAutocompleteOnFocus&&(this.tagInput.focus(function(){f._showAutocomplete()}),typeof this.options.autocomplete.minLength==="undefined"))this.options.autocomplete.minLength=0;if(c.isFunction(this.options.autocomplete.source))this.options.autocomplete.source=
c.proxy(this.options.autocomplete.source,this);if(c.isFunction(this.options.tagSource))this.options.tagSource=c.proxy(this.options.tagSource,this);this.tagList.addClass("tagit").addClass("ui-widget ui-widget-content ui-corner-all").append(c('<li class="tagit-new"></li>').append(this.tagInput)).click(function(b){var a=c(b.target);a.hasClass("tagit-label")?(a=a.closest(".tagit-choice"),a.hasClass("removed")||f._trigger("onTagClicked",b,{tag:a,tagLabel:f.tagLabel(a)})):f.tagInput.focus()});var h=!1;
if(this.options.singleField)if(this.options.singleFieldNode){var i=c(this.options.singleFieldNode),b=i.val().split(this.options.singleFieldDelimiter);i.val("");c.each(b,function(b,a){f.createTag(a,null,!0);h=!0})}else this.options.singleFieldNode=c('<input type="hidden" style="display:none;" value="" name="'+this.options.fieldName+'" />'),this.tagList.after(this.options.singleFieldNode);h||this.tagList.children("li").each(function(){c(this).hasClass("tagit-new")||(f.createTag(c(this).text(),c(this).attr("class"),
!0),c(this).remove())});this.tagInput.keydown(function(b){if(b.which==c.ui.keyCode.BACKSPACE&&f.tagInput.val()===""){var a=f._lastTag();!f.options.removeConfirmation||a.hasClass("remove")?f.removeTag(a):f.options.removeConfirmation&&a.addClass("remove ui-state-highlight")}else f.options.removeConfirmation&&f._lastTag().removeClass("remove ui-state-highlight");if(b.which===c.ui.keyCode.COMMA||b.which===c.ui.keyCode.ENTER||b.which==c.ui.keyCode.TAB&&f.tagInput.val()!==""||b.which==c.ui.keyCode.SPACE&&
f.options.allowSpaces!==!0&&(c.trim(f.tagInput.val()).replace(/^s*/,"").charAt(0)!='"'||c.trim(f.tagInput.val()).charAt(0)=='"'&&c.trim(f.tagInput.val()).charAt(c.trim(f.tagInput.val()).length-1)=='"'&&c.trim(f.tagInput.val()).length-1!==0))b.which===c.ui.keyCode.ENTER&&f.tagInput.val()===""||b.preventDefault(),f.createTag(f._cleanedInput()),f.tagInput.autocomplete("close")}).blur(function(){f.tagInput.data("autocomplete-open")||f.createTag(f._cleanedInput())});if(this.options.availableTags||this.options.tagSource||
this.options.autocomplete.source)i={select:function(b,a){f.createTag(a.item.value);return!1}},c.extend(i,this.options.autocomplete),i.source=this.options.tagSource||i.source,this.tagInput.autocomplete(i).bind("autocompleteopen",function(){f.tagInput.data("autocomplete-open",!0)}).bind("autocompleteclose",function(){f.tagInput.data("autocomplete-open",!1)})},_cleanedInput:function(){return c.trim(this.tagInput.val().replace(/^"(.*)"$/,"$1"))},_lastTag:function(){return this.tagList.find(".tagit-choice:last:not(.removed)")},
_tags:function(){return this.tagList.find(".tagit-choice:not(.removed)")},assignedTags:function(){var f=this,h=[];this.options.singleField?(h=c(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter),h[0]===""&&(h=[])):this._tags().each(function(){h.push(f.tagLabel(this))});return h},_updateSingleTagsField:function(f){c(this.options.singleFieldNode).val(f.join(this.options.singleFieldDelimiter)).trigger("change")},_subtractArray:function(f,h){for(var i=[],b=0;b<f.length;b++)c.inArray(f[b],
h)==-1&&i.push(f[b]);return i},tagLabel:function(f){return this.options.singleField?c(f).find(".tagit-label:first").text():c(f).find("input:first").val()},_showAutocomplete:function(){this.tagInput.autocomplete("search","")},_findTagByLabel:function(f){var h=this,i=null;this._tags().each(function(){if(h._formatStr(f)==h._formatStr(h.tagLabel(this)))return i=c(this),!1});return i},_isNew:function(c){return!this._findTagByLabel(c)},_formatStr:function(f){if(this.options.caseSensitive)return f;return c.trim(f.toLowerCase())},
_effectExists:function(f){return Boolean(c.effects&&(c.effects[f]||c.effects.effect&&c.effects.effect[f]))},createTag:function(f,h,i){var b=this,f=c.trim(f);if(f==="")return!1;if(!this.options.allowDuplicates&&!this._isNew(f))return f=this._findTagByLabel(f),this._trigger("onTagExists",null,{existingTag:f,duringInitialization:i})!==!1&&this._effectExists("highlight")&&f.effect("highlight"),!1;if(this.options.tagLimit&&this._tags().length>=this.options.tagLimit)return this._trigger("onTagLimitExceeded",
null,{duringInitialization:i}),!1;var d=c(this.options.onTagClicked?'<a class="tagit-label"></a>':'<span class="tagit-label"></span>').text(f),a=c("<li></li>").addClass("tagit-choice ui-widget-content ui-state-default ui-corner-all").addClass(h).append(d);this.options.readOnly?a.addClass("tagit-choice-read-only"):(a.addClass("tagit-choice-editable"),h=c("<span></span>").addClass("ui-icon ui-icon-close"),h=c('<a><span class="text-icon">\u00d7</span></a>').addClass("tagit-close").append(h).click(function(){b.removeTag(a)}),
a.append(h));this.options.singleField||(d=d.html(),a.append('<input type="hidden" style="display:none;" value="'+d+'" name="'+this.options.fieldName+'" />'));this._trigger("beforeTagAdded",null,{tag:a,tagLabel:this.tagLabel(a),duringInitialization:i})!==!1&&(this.options.singleField&&(d=this.assignedTags(),d.push(f),this._updateSingleTagsField(d)),this._trigger("onTagAdded",null,a),this.tagInput.val(""),this.tagInput.parent().before(a),this._trigger("afterTagAdded",null,{tag:a,tagLabel:this.tagLabel(a),
duringInitialization:i}),this.options.showAutocompleteOnFocus&&!i&&setTimeout(function(){b._showAutocomplete()},0))},removeTag:function(f,h){h=typeof h==="undefined"?this.options.animate:h;f=c(f);this._trigger("onTagRemoved",null,f);if(this._trigger("beforeTagRemoved",null,{tag:f,tagLabel:this.tagLabel(f)})!==!1){if(this.options.singleField){var i=this.assignedTags(),b=this.tagLabel(f),i=c.grep(i,function(c){return c!=b});this._updateSingleTagsField(i)}h?(f.addClass("removed"),i=this._effectExists("blind")?
["blind",{direction:"horizontal"},"fast"]:["fast"],i.push(function(){f.remove()}),f.fadeOut("fast").hide.apply(f,i).dequeue()):f.remove();this._trigger("afterTagRemoved",null,{tag:f,tagLabel:this.tagLabel(f)})}},removeTagByLabel:function(c,h){var i=this._findTagByLabel(c);if(!i)throw"No such tag exists with the name '"+c+"'";this.removeTag(i,h)},removeAll:function(){var c=this;this._tags().each(function(h,i){c.removeTag(i,!1)})}})})(jQuery);/*
: Licensed under Apache License v2.0. See http://www.apache.org/licenses/LICENSE-2.0
 @website: http://www.improvely.com/
*/
(function(c){var f=function(f,i,b){var d=typeof i=="object",a,e=[{caption:gettext("Next Month"),value:[moment().add("month",1).startOf("month"),moment().add("month",1).endOf("month")]},{caption:gettext("Next 30 Days"),value:[new Date,moment().add("days",29)]},{caption:gettext("Next 7 Days"),value:[new Date,moment().add("days",6)]},{caption:gettext("Tomorrow"),value:[moment().add("days",1),moment().add("days",1)]}],g=[{caption:gettext("Yesterday"),value:[moment().subtract("days",1),moment().subtract("days",
1)]},{caption:gettext("Last 7 Days"),value:[moment().subtract("days",6),new Date]},{caption:gettext("Last 30 Days"),value:[moment().subtract("days",29),new Date]},{caption:gettext("Last Month"),value:[moment().startOf("month"),moment().endOf("month")]}],j={};if(d&&i.presets)if(i.presets=="future"){for(var m=0;m<e.length;m++)j[e[m].caption]=e[m].value;j[gettext("Today")]=[new Date,new Date]}else if(i.presets=="past"){j[gettext("Today")]=[new Date,new Date];for(m=0;m<g.length;m++)j[g[m].caption]=g[m].value}else if(i.presets==
"past-future"){for(m=0;m<e.length;m++)j[e[m].caption]=e[m].value;j[gettext("Today")]=[new Date,new Date];for(m=0;m<g.length;m++)j[g[m].caption]=g[m].value}this.startDate=moment().startOf("day");this.endDate=moment().endOf("day");this.dropdownAdjusts=this.showDropdowns=this.cleared=this.changed=this.maxDate=this.minDate=!1;this.ranges={};this.dateLimit=!1;this.opens="right";this.cb=function(){};this.format="MM/DD/YYYY";this.separator=" - ";this.showWeekNumbers=!1;this.buttonClasses=["btn"];this.applyClass=
"btn btn-small btn-success btn_green";this.clearClass="btn btn-small";a=this.locale={applyLabel:"Apply",clearLabel:"Clear",fromLabel:"From",toLabel:"To",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:moment()._lang._weekdaysMin,monthNames:moment()._lang._monthsShort,firstDay:0};this.leftCalendar={month:moment([this.startDate.year(),this.startDate.month(),1]),calendar:[]};this.rightCalendar={month:moment([this.endDate.year(),this.endDate.month(),1]),calendar:[]};this.element=c(f);if(this.element.hasClass("pull-right"))this.opens=
"left";if(this.element.is("input"))this.element.on({click:c.proxy(this.show,this),focus:c.proxy(this.show,this)});else this.element.on("click",c.proxy(this.show,this));if(d){typeof i.locale=="object"&&c.each(a,function(b,c){a[b]=i.locale[b]||c});if(i.applyClass)this.applyClass=i.applyClass;if(i.clearClass)this.clearClass=i.clearClass}this.container=c('<div class="daterangepicker dropdown-menu"><div class="calendar left"></div><div class="calendar right"></div><div class="ranges"><div class="range_inputs"><div class="daterangepicker_start_input" style="float: left"><label for="daterangepicker_start">'+
this.locale.fromLabel+'</label><input class="input-mini" type="text" name="daterangepicker_start" value="" disabled="disabled" /></div><div class="daterangepicker_end_input" style="float: left; padding-left: 11px"><label for="daterangepicker_end">'+this.locale.toLabel+'</label><input class="input-mini" type="text" name="daterangepicker_end" value="" disabled="disabled" /></div><button class="'+this.applyClass+' applyBtn" disabled="disabled">'+this.locale.applyLabel+'</button>&nbsp;<button class="'+
this.clearClass+' clearBtn">'+this.locale.clearLabel+"</button></div></div></div>").appendTo("body");if(d){if(typeof i.format=="string")this.format=i.format;if(typeof i.separator=="string")this.separator=i.separator;if(typeof i.startDate=="string")this.startDate=moment(i.startDate,this.format).startOf("day");if(typeof i.endDate=="string")this.endDate=moment(i.endDate,this.format).endOf("day");if(typeof i.minDate=="string")this.minDate=moment(i.minDate,this.format).startOf("day");if(typeof i.maxDate==
"string")this.maxDate=moment(i.maxDate,this.format).endOf("day");if(typeof i.startDate=="object")this.startDate=i.startDate instanceof Date?moment(i.startDate).startOf("day"):i.startDate.startOf("day");if(typeof i.endDate=="object")this.endDate=i.endDate instanceof Date?moment(i.endDate).endOf("day"):i.endDate.endOf("day");if(typeof i.minDate=="object")this.minDate=i.minDate instanceof Date?moment(i.minDate).startOf("day"):i.minDate.startOf("day");if(typeof i.maxDate=="object")this.maxDate=i.maxDate instanceof
Date?moment(i.maxDate).endOf("day"):i.maxDate.endOf("day");if(typeof i.ranges!="object")i.ranges=j;if(typeof i.ranges=="object"){for(var q in i.ranges)f=moment(i.ranges[q][0]).startOf("day"),e=moment(i.ranges[q][1]).endOf("day"),this.minDate&&f.isBefore(this.minDate)&&(f=moment(this.minDate)),this.maxDate&&e.isAfter(this.maxDate)&&(e=moment(this.maxDate)),this.minDate&&e.isBefore(this.minDate)||this.maxDate&&f.isAfter(this.maxDate)||(this.ranges[q]=[f,e]);f="<ul>";for(q in this.ranges)f+="<li>"+q+
"</li>";f+="<li>"+this.locale.customRangeLabel+"</li>";f+="</ul>";this.container.find(".ranges").prepend(f)}if(typeof i.dateLimit=="object")this.dateLimit=i.dateLimit;if(typeof i.locale=="object"&&typeof i.locale.firstDay=="number")for(q=this.locale.firstDay=i.locale.firstDay;q>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),q--;if(typeof i.opens=="string")this.opens=i.opens;if(typeof i.showWeekNumbers=="boolean")this.showWeekNumbers=i.showWeekNumbers;if(typeof i.buttonClasses=="string")this.buttonClasses=
[i.buttonClasses];if(typeof i.buttonClasses=="object")this.buttonClasses=i.buttonClasses;if(typeof i.showDropdowns=="boolean")this.showDropdowns=i.showDropdowns;if(typeof i.dropdownAdjusts=="boolean")this.dropdownAdjusts=i.dropdownAdjusts}var k=this.container;c.each(this.buttonClasses,function(a,b){k.find("button").addClass(b)});this.opens=="right"&&(q=this.container.find(".calendar.left"),f=this.container.find(".calendar.right"),q.removeClass("left").addClass("right"),f.removeClass("right").addClass("left"));
if(typeof i=="undefined"||typeof i.ranges=="undefined")this.container.find(".calendar").show(),this.move();if(typeof b=="function")this.cb=b;this.container.addClass("opens"+this.opens);if((!d||typeof i.startDate=="undefined"&&typeof i.endDate=="undefined")&&c(this.element).is("input[type=text]"))if(b=c(this.element).val().split(this.separator),b.length==2)this.startDate=moment(b[0],this.format).startOf("day"),this.endDate=moment(b[1],this.format).endOf("day");this.container.on("mousedown",c.proxy(this.mousedown,
this));this.container.find(".calendar").on("click",".prev",c.proxy(this.clickPrev,this));this.container.find(".calendar").on("click",".next",c.proxy(this.clickNext,this));this.container.find(".ranges").on("click","button.applyBtn",c.proxy(this.clickApply,this));this.container.find(".ranges").on("click","button.clearBtn",c.proxy(this.clickClear,this));this.container.find(".calendar").on("click","td.available",c.proxy(this.clickDate,this));this.container.find(".calendar").on("mouseenter","td.available",
c.proxy(this.enterDate,this));this.container.find(".calendar").on("mouseleave","td.available",c.proxy(this.updateView,this));this.container.find(".ranges").on("click","li",c.proxy(this.clickRange,this));this.container.find(".ranges").on("mouseenter","li",c.proxy(this.enterRange,this));this.container.find(".ranges").on("mouseleave","li",c.proxy(this.updateView,this));this.container.find(".calendar").on("change","select.yearselect",c.proxy(this.updateYear,this));this.container.find(".calendar").on("change",
"select.monthselect",c.proxy(this.updateMonth,this));this.element.on("keyup",c.proxy(this.updateFromControl,this));this.updateView();this.updateCalendars()};f.prototype={constructor:f,mousedown:function(f){f.stopPropagation();(!this.showDropdowns||c(f.target).not("select").length)&&f.preventDefault()},updateView:function(){this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year());this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year());this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.format));
this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.format));this.startDate.isSame(this.endDate)||this.startDate.isBefore(this.endDate)?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled")},updateFromControl:function(){if(this.element.is("input")&&this.element.val().length){var c=this.element.val().split(this.separator),f=moment(c[0],this.format).startOf("day"),c=moment(c[1],this.format).endOf("day");
if(!(f==null||c==null)&&!c.isBefore(f))this.startDate=f,this.endDate=c,this.updateView(),this.cb(this.startDate,this.endDate),this.updateCalendars()}},notify:function(){this.cleared||this.updateView();this.element.is("input")&&this.element.val(this.cleared?"":this.startDate.format(this.format)+this.separator+this.endDate.format(this.format));var c=this.cleared?null:this.startDate,f=this.cleared?null:this.endDate;this.cleared=!1;this.cb(c,f)},move:function(){var f=c(this.container).find(".ranges").outerWidth();
c(this.container).find(".calendar").is(":visible")&&(f+=c(this.container).find(".calendar").outerWidth()*2+24);this.opens=="left"?(this.container.css({top:this.element.offset().top+this.element.outerHeight(),right:c(window).width()-this.element.offset().left-this.element.outerWidth(),left:"auto","min-width":f}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):(this.container.css({top:this.element.offset().top+this.element.outerHeight(),left:this.element.offset().left,right:"auto",
"min-width":f}),this.container.offset().left+this.container.outerWidth()>c(window).width()&&this.container.css({left:"auto",right:0}))},show:function(f){this.container.show();this.move();f&&(f.stopPropagation(),f.preventDefault());this.changed=!1;this.element.trigger("shown",{target:f.target,picker:this});c(document).on("mousedown",c.proxy(this.hide,this))},hide:function(){this.container.hide();c(document).off("mousedown",this.hide);if(this.changed)this.changed=!1,this.notify()},enterRange:function(c){c=
c.target.innerHTML;c==this.locale.customRangeLabel?this.updateView():(c=this.ranges[c],this.container.find("input[name=daterangepicker_start]").val(c[0].format(this.format)),this.container.find("input[name=daterangepicker_end]").val(c[1].format(this.format)))},clickRange:function(c){c=c.target.innerHTML;c==this.locale.customRangeLabel?(this.container.find(".calendar").show(),this.move()):(c=this.ranges[c],this.startDate=c[0],this.endDate=c[1],this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year()),
this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year()),this.updateCalendars(),this.changed=!0,this.container.find(".calendar").hide(),this.move(),this.hide())},clickPrev:function(f){c(f.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.subtract("month",1):this.rightCalendar.month.subtract("month",1);this.updateCalendars()},clickNext:function(f){c(f.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.add("month",1):this.rightCalendar.month.add("month",
1);this.updateCalendars()},enterDate:function(f){var i=c(f.target).attr("data-title"),b=i.substr(1,1),i=i.substr(3,1);c(f.target).parents(".calendar").hasClass("left")?this.container.find("input[name=daterangepicker_start]").val(this.leftCalendar.calendar[b][i].format(this.format)):this.container.find("input[name=daterangepicker_end]").val(this.rightCalendar.calendar[b][i].format(this.format))},clickDate:function(f){var i=c(f.target).attr("data-title"),b=i.substr(1,1),d=i.substr(3,1),i=c(f.target).parents(".calendar");
if(i.hasClass("left")){var a=this.leftCalendar.calendar[b][d],b=this.endDate;typeof this.dateLimit=="object"&&(d=moment(a).add(this.dateLimit).endOf("day"),b.isAfter(d)&&(b=d));this.element.trigger("clicked",{dir:"left",picker:this})}else a=this.startDate,b=this.rightCalendar.calendar[b][d],typeof this.dateLimit=="object"&&(d=moment(b).subtract(this.dateLimit).startOf("day"),a.isBefore(d)&&(a=d)),this.element.trigger("clicked",{dir:"right",picker:this});i.find("td").removeClass("active");if(a.isSame(b)||
a.isBefore(b)){c(f.target).addClass("active");if(!a.isSame(this.startDate)||!b.isSame(this.endDate))this.changed=!0;this.startDate=a;this.endDate=b}else if(a.isAfter(b))c(f.target).addClass("active"),this.changed=!0,this.startDate=a,this.endDate=moment(a).add("day",1).endOf("day");this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year());this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year());this.updateCalendars()},clickApply:function(){this.hide()},
clickClear:function(){this.cleared=this.changed=!0;this.hide()},updateYear:function(f){var i=parseInt(c(f.target).val());c(f.target).closest(".calendar").hasClass("left")?this.leftCalendar.month.month(this.startDate.month()).year(i):this.rightCalendar.month.month(this.endDate.month()).year(i);this.updateCalendars()},updateMonth:function(f){var i=parseInt(c(f.target).val());c(f.target).closest(".calendar").hasClass("left")?this.leftCalendar.month.month(i).year(this.startDate.year()):this.rightCalendar.month.month(i).year(this.endDate.year());
this.updateCalendars()},updateCalendars:function(){this.leftCalendar.calendar=this.buildCalendar(this.leftCalendar.month.month(),this.leftCalendar.month.year(),"left");this.rightCalendar.calendar=this.buildCalendar(this.rightCalendar.month.month(),this.rightCalendar.month.year(),"right");this.container.find(".calendar.left").html(this.renderCalendar(this.leftCalendar.calendar,this.startDate,this.minDate,this.maxDate));this.container.find(".calendar.right").html(this.renderCalendar(this.rightCalendar.calendar,
this.endDate,this.startDate,this.maxDate));this.container.find(".ranges li").removeClass("active");var c=!0,f=0,b;for(b in this.ranges)this.startDate.isSame(this.ranges[b][0])&&this.endDate.isSame(this.ranges[b][1])&&(c=!1,this.container.find(".ranges li:eq("+f+")").addClass("active")),f++;c&&this.container.find(".ranges li:last").addClass("active");this.element.trigger("updated",this)},buildCalendar:function(c,f,b){for(var c=moment([f,c,1]),d=moment(c).subtract("month",1).month(),a=moment(c).subtract("month",
1).year(),e=moment([a,d]).daysInMonth(),g=c.day(),c=[],f=0;f<6;f++)c[f]=[];f=e-g+this.locale.firstDay+1;f>e&&(f-=7);g==this.locale.firstDay&&(f=e-6);b=b=="right"?moment([a,d,f]).endOf("day"):moment([a,d,f]).startOf("day");for(a=d=f=0;f<42;f++,d++,b=moment(b).add("day",1))f>0&&d%7==0&&(d=0,a++),c[a][d]=b;return c},renderDropdowns:function(c,f,b){for(var d=c.month(),a='<select class="monthselect">',e=0;e<12;e++)a+="<option value='"+e+"'"+(e===d?" selected='selected'":"")+">"+this.locale.monthNames[e]+
"</option>";a+="</select>";c=c.year();b=b&&b.year()||c+5;d='<select class="yearselect">';for(f=f&&f.year()||c-50;f<=b;f++)d+='<option value="'+f+'"'+(f===c?' selected="selected"':"")+">"+f+"</option>";d+="</select>";return a+d},renderCalendar:function(f,i,b,d){var a='<table class="table-condensed">';a+="<thead>";a+="<tr>";this.showWeekNumbers&&(a+="<th></th>");a+=!b||b.isBefore(f[1][1])?'<th class="prev available"><i class="icon-arrow-left"></i></th>':"<th></th>";var e=this.locale.monthNames[f[1][1].month()]+
f[1][1].format(" YYYY");this.showDropdowns&&(e=this.renderDropdowns(f[1][1],b,d));a+='<th colspan="5" style="width: auto">'+e+"</th>";a+=!d||d.isAfter(f[1][1])?'<th class="next available"><i class="icon-arrow-right"></i></th>':"<th></th>";a+="</tr>";a+="<tr>";this.showWeekNumbers&&(a+='<th class="week">'+this.locale.weekLabel+"</th>");c.each(this.locale.daysOfWeek,function(b,c){a+="<th>"+c+"</th>"});a+="</tr>";a+="</thead>";a+="<tbody>";for(e=0;e<6;e++){a+="<tr>";this.showWeekNumbers&&(a+='<td class="week">'+
f[e][0].week()+"</td>");for(var g=0;g<7;g++){var j="available ";j+=f[e][g].month()==f[1][1].month()?"":"off";b&&f[e][g].isBefore(b)||d&&f[e][g].isAfter(d)?j=" off disabled ":f[e][g].isSame(i)?(j+=" active ",f[e][g].isSame(this.startDate)&&(j+=" start-date "),f[e][g].isSame(this.endDate)&&(j+=" end-date ")):f[e][g]>=this.startDate&&f[e][g]<=this.endDate&&(j+=" in-range ",f[e][g].isSame(this.startDate)&&(j+=" start-date "),f[e][g].isSame(this.endDate)&&(j+=" end-date "));var m="r"+e+"c"+g;a+='<td class="'+
j.replace(/\s+/g," ").replace(/^\s?(.*?)\s?$/,"$1")+'" data-title="'+m+'">'+f[e][g].date()+"</td>"}a+="</tr>"}a+="</tbody>";a+="</table>";return a}};c.fn.daterangepicker=function(h,i){this.each(function(){var b=c(this);b.data("daterangepicker")||b.data("daterangepicker",new f(b,h,i))});return this}})(window.jQuery);$(document).ready(function(){$("#content").on("click","a.link_satais_pos_dialog",function(c){c.preventDefault();var f=$(this).attr("data-dialog_url"),h={object_id:$(this).attr("data-object_id")};$(".satais_pos_dialog").dialog("destroy").remove();$("#satais_pos_dialog").remove();$.ajax({url:f,type:"GET",data:h,success:function(c){if(typeof c!="object"){var b=$('<div id="satais_pos_dialog">'+c+"</div>").dialog({modal:!0,resizable:!1,dialogClass:"satais_pos_dialog",title:'<h3 class="bg_light">Get the latest vessel position through satellite AIS</h3>',
width:600});b.find("#satais_pos_dialog_ok").click(function(c){c.preventDefault();b.find("#buttons").html("<img src=\"/static/images/jquerymobile/ajax-loader.gif\"><span style='float:right'>"+_("Report is being generated")+"</span>");h.finalaction=!0;$.ajax({url:f,type:"GET",data:h,success:function(a){setTimeout(function(){b.html(a);b.find("#satais_pos_dialog_cancel").click(function(a){a.preventDefault();b.dialog("close");location.reload()})},2500)}})});b.find("#satais_pos_dialog_cancel").click(function(c){c.preventDefault();
b.dialog("close")})}}})});open_dialog=="satpos_dialog"&&$("#content a.link_satais_pos_dialog").trigger("click")});$(document).ready(function(){$("#content").on("click","a.link_exportdialog",function(c){c.preventDefault();var f=$(this).attr("data-dialog_url"),c=$(this).attr("data-tablename"),h=$(this).attr("data-exporttype"),i=$(this).attr("data-object_id"),b={tablename:c,exporttype:h};if(typeof i!=="undefined")b.object_id=i;$(".exportdialog").dialog("destroy").remove();$("#exportdialog").remove();$.ajax({url:f,type:"GET",data:b,success:function(c){var a=$('<div id="exportdialog">'+c+"</div>").dialog({modal:!0,
resizable:!1,dialogClass:"exportdialog",title:'<h3 class="bg_light">FleetMon Vessel Database Report Generator</h3>',width:600});a.find("#exportdialog_ok").click(function(c){c.preventDefault();a.find("#buttons").html("<img src=\"/static/images/jquerymobile/ajax-loader.gif\"><span style='float:right'>"+_("Report is being generated")+"</span>");var c=$(this).attr("data-fs_checksum"),d=$(this).attr("data-rowcount");b.finalaction=!0;b.fs_checksum=c;b.rowcount=d;$.ajax({url:f,type:"GET",data:b,success:function(b){a.html(b);
a.find("#exportdialog_cancel").click(function(b){b.preventDefault();a.dialog("close")})}})});a.find("#exportdialog_cancel").click(function(b){b.preventDefault();a.dialog("close")})}})});ds.handleExportDownloadButtons=function(c,f,h,i){var h=gettext("Downloads reflect your current filter settings. The maximum allowed download size is %d rows."),h=h.replace("%d",f),b="<i></i> "+ngettext("Download %d row","Download %d rows",c),b=b.replace("%d",c);i.html(b);ds.username!=null&&(c>f||c==0?(f="",f=c==0?
"<p style='color:red'>"+gettext("No data for download.")+"</p>"+h:"<p style='color:red'>"+gettext("Maximum download size exceeded.")+"</p>"+h,i.attr("data-original-title",f),i.removeClass().addClass("btn_disabled tooltip-bs-html btn_big halflings download-alt gray")):(i.attr("data-original-title",h),i.removeClass().addClass("btn_green tooltip-bs-html btn_big halflings download-alt white link_exportdialog")))}});(function(){function c(f,h,i){var b=c.resolve(f);if(null==b)throw i=i||f,h=h||"root",b=Error('Failed to require "'+i+'" from "'+h+'"'),b.path=i,b.parent=h,b.require=!0,b;h=c.modules[b];if(!h.exports)h.exports={},h.client=h.component=!0,h.call(this,h.exports,c.relative(b),h);return h.exports}c.modules={};c.aliases={};c.resolve=function(f){f.charAt(0)==="/"&&(f=f.slice(1));for(var h=[f,f+".js",f+".json",f+"/index.js",f+"/index.json"],i=0;i<h.length;i++){f=h[i];if(c.modules.hasOwnProperty(f))return f;
if(c.aliases.hasOwnProperty(f))return c.aliases[f]}};c.normalize=function(c,h){var i=[];if("."!=h.charAt(0))return h;for(var c=c.split("/"),h=h.split("/"),b=0;b<h.length;++b)".."==h[b]?c.pop():"."!=h[b]&&""!=h[b]&&i.push(h[b]);return c.concat(i).join("/")};c.register=function(f,h){c.modules[f]=h};c.alias=function(f,h){if(!c.modules.hasOwnProperty(f))throw Error('Failed to alias "'+f+'", it does not exist');c.aliases[h]=f};c.relative=function(f){function h(b){var d=h.resolve(b);return c(d,f,b)}var i=
c.normalize(f,"..");h.resolve=function(b){var d=b.charAt(0);if("/"==d)return b.slice(1);if("."==d)return c.normalize(i,b);var d=f.split("/"),a;a:{for(a=d.length;a--;)if(d[a]==="deps")break a;a=-1}a+=1;a||(a=0);return b=d.slice(0,a+1).join("/")+"/deps/"+b};h.exists=function(b){return c.modules.hasOwnProperty(h.resolve(b))};return h};c.register("component-emitter/index.js",function(c,h,i){function b(c){if(c){for(var a in b.prototype)c[a]=b.prototype[a];return c}}i.exports=b;b.prototype.on=function(b,
a){this._callbacks=this._callbacks||{};(this._callbacks[b]=this._callbacks[b]||[]).push(a);return this};b.prototype.once=function(b,a){function c(){f.off(b,c);a.apply(this,arguments)}var f=this;this._callbacks=this._callbacks||{};a._off=c;this.on(b,c);return this};b.prototype.off=b.prototype.removeListener=b.prototype.removeAllListeners=function(b,a){this._callbacks=this._callbacks||{};var c=this._callbacks[b];if(!c)return this;if(1==arguments.length)return delete this._callbacks[b],this;var f=c.indexOf(a._off||
a);~f&&c.splice(f,1);return this};b.prototype.emit=function(b){this._callbacks=this._callbacks||{};var a=[].slice.call(arguments,1),c=this._callbacks[b];if(c)for(var c=c.slice(0),f=0,h=c.length;f<h;++f)c[f].apply(this,a);return this};b.prototype.listeners=function(b){this._callbacks=this._callbacks||{};return this._callbacks[b]||[]};b.prototype.hasListeners=function(b){return!!this.listeners(b).length}});c.register("dropzone/index.js",function(c,h,i){i.exports=h("./lib/dropzone.js")});c.register("dropzone/lib/dropzone.js",
function(c,h,i){(function(){var b,c,a,e,f,j={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a},q=[].slice;c=typeof Emitter!=="undefined"&&Emitter!==null?Emitter:h("emitter");e=function(){};b=function(a){function b(a,d){var e,f,g;this.element=a;this.version=b.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,"");this.clickableElements=
[];this.listeners=[];this.files=[];if(typeof this.element==="string")this.element=document.querySelector(this.element);if(!(this.element&&this.element.nodeType!=null))throw Error("Invalid dropzone element.");if(this.element.dropzone)throw Error("Dropzone already attached.");b.instances.push(this);a.dropzone=this;e=(g=b.optionsForElement(this.element))!=null?g:{};this.options=c({},this.defaultOptions,e,d!=null?d:{});if(this.options.forceFallback||!b.isBrowserSupported())return this.options.fallback.call(this);
if(this.options.url==null)this.options.url=this.element.getAttribute("action");if(!this.options.url)throw Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(this.options.acceptedMimeTypes)this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes;this.options.method=this.options.method.toUpperCase();(f=this.getExistingFallback())&&
f.parentNode&&f.parentNode.removeChild(f);this.previewsContainer=this.options.previewsContainer?b.getElement(this.options.previewsContainer,"previewsContainer"):this.element;if(this.options.clickable)this.clickableElements=this.options.clickable===!0?[this.element]:b.getElements(this.options.clickable,"clickable");this.init()}var c;m(b,a);b.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","selectedfiles","addedfile","removedfile","thumbnail","error","errormultiple",
"processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded"];b.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,
acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MB). Max filesize: {{maxFilesize}}MB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",
dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can only upload {{maxFiles}} files.",accept:function(a,b){return b()},init:function(){return e},forceFallback:!1,fallback:function(){var a,c,d,e,f;this.element.className=""+this.element.className+" dz-browser-not-supported";f=this.element.getElementsByTagName("div");d=0;for(e=f.length;d<e;d++)if(a=f[d],/(^| )dz-message($| )/.test(a.className))c=
a,a.className="dz-message";c||(c=b.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(c));if(a=c.getElementsByTagName("span")[0])a.textContent=this.options.dictFallbackMessage;return this.element.appendChild(this.getFallbackForm())},resize:function(a){var b,c,d;b={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height};c=a.width/a.height;d=this.options.thumbnailWidth/this.options.thumbnailHeight;a.height<this.options.thumbnailHeight||a.width<this.options.thumbnailWidth?
(b.trgHeight=b.srcHeight,b.trgWidth=b.srcWidth):c>d?(b.srcHeight=a.height,b.srcWidth=b.srcHeight*d):(b.srcWidth=a.width,b.srcHeight=b.srcWidth/d);b.srcX=(a.width-b.srcWidth)/2;b.srcY=(a.height-b.srcHeight)/2;return b},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:e,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},
dragleave:function(){return this.element.classList.remove("dz-drag-hover")},selectedfiles:function(){if(this.element===this.previewsContainer)return this.element.classList.add("dz-started")},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var c=this;a.previewElement=b.createElement(this.options.previewTemplate);a.previewTemplate=a.previewElement;this.previewsContainer.appendChild(a.previewElement);a.previewElement.querySelector("[data-dz-name]").textContent=
a.name;a.previewElement.querySelector("[data-dz-size]").innerHTML=this.filesize(a.size);if(this.options.addRemoveLinks)a._removeLink=b.createElement('<a class="dz-remove" href="javascript:undefined;">'+this.options.dictRemoveFile+"</a>"),a._removeLink.addEventListener("click",function(d){d.preventDefault();d.stopPropagation();return a.status===b.UPLOADING?b.confirm(c.options.dictCancelUploadConfirmation,function(){return c.removeFile(a)}):c.options.dictRemoveFileConfirmation?b.confirm(c.options.dictRemoveFileConfirmation,
function(){return c.removeFile(a)}):c.removeFile(a)}),a.previewElement.appendChild(a._removeLink);return this._updateMaxFilesReachedClass()},removedfile:function(a){var b;(b=a.previewElement)!=null&&b.parentNode.removeChild(a.previewElement);return this._updateMaxFilesReachedClass()},thumbnail:function(a,b){var c;a.previewElement.classList.remove("dz-file-preview");a.previewElement.classList.add("dz-image-preview");c=a.previewElement.querySelector("[data-dz-thumbnail]");c.alt=a.name;return c.src=
b},error:function(a,b){a.previewElement.classList.add("dz-error");return a.previewElement.querySelector("[data-dz-errormessage]").textContent=b},errormultiple:e,processing:function(a){a.previewElement.classList.add("dz-processing");if(a._removeLink)return a._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:e,uploadprogress:function(a,b){return a.previewElement.querySelector("[data-dz-uploadprogress]").style.width=""+b+"%"},totaluploadprogress:e,sending:e,sendingmultiple:e,
success:function(a){return a.previewElement.classList.add("dz-success")},successmultiple:e,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:e,complete:function(a){if(a._removeLink)return a._removeLink.textContent=this.options.dictRemoveFile},completemultiple:e,maxfilesexceeded:e,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-details">\n    <div class="dz-filename"><span data-dz-name></span></div>\n    <div class="dz-size" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark"><span>\u2714</span></div>\n  <div class="dz-error-mark"><span>\u2718</span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'};
c=function(){var a,b,c,d,e,f,g;d=arguments[0];c=2<=arguments.length?q.call(arguments,1):[];f=0;for(g=c.length;f<g;f++)for(a in b=c[f],b)e=b[a],d[a]=e;return d};b.prototype.getAcceptedFiles=function(){var a,b,c,d,e;d=this.files;e=[];b=0;for(c=d.length;b<c;b++)a=d[b],a.accepted&&e.push(a);return e};b.prototype.getRejectedFiles=function(){var a,b,c,d,e;d=this.files;e=[];b=0;for(c=d.length;b<c;b++)a=d[b],a.accepted||e.push(a);return e};b.prototype.getQueuedFiles=function(){var a,c,d,e,f;e=this.files;
f=[];c=0;for(d=e.length;c<d;c++)a=e[c],a.status===b.QUEUED&&f.push(a);return f};b.prototype.getUploadingFiles=function(){var a,c,d,e,f;e=this.files;f=[];c=0;for(d=e.length;c<d;c++)a=e[c],a.status===b.UPLOADING&&f.push(a);return f};b.prototype.init=function(){var a,c,d,e,f,g,h=this;this.element.tagName==="form"&&this.element.setAttribute("enctype","multipart/form-data");this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(b.createElement('<div class="dz-default dz-message"><span>'+
this.options.dictDefaultMessage+"</span></div>"));this.clickableElements.length&&(d=function(){h.hiddenFileInput&&document.body.removeChild(h.hiddenFileInput);h.hiddenFileInput=document.createElement("input");h.hiddenFileInput.setAttribute("type","file");h.hiddenFileInput.setAttribute("multiple","multiple");h.options.acceptedFiles!=null&&h.hiddenFileInput.setAttribute("accept",h.options.acceptedFiles);h.hiddenFileInput.style.visibility="hidden";h.hiddenFileInput.style.position="absolute";h.hiddenFileInput.style.top=
"0";h.hiddenFileInput.style.left="0";h.hiddenFileInput.style.height="0";h.hiddenFileInput.style.width="0";document.body.appendChild(h.hiddenFileInput);return h.hiddenFileInput.addEventListener("change",function(){var a;a=h.hiddenFileInput.files;a.length&&(h.emit("selectedfiles",a),h.handleFiles(a));return d()})},d());this.URL=(a=window.URL)!=null?a:window.webkitURL;g=this.events;e=0;for(f=g.length;e<f;e++)a=g[e],this.on(a,this.options[a]);this.on("uploadprogress",function(){return h.updateTotalUploadProgress()});
this.on("removedfile",function(){return h.updateTotalUploadProgress()});this.on("canceled",function(a){return h.emit("complete",a)});c=function(a){a.stopPropagation();return a.preventDefault?a.preventDefault():a.returnValue=!1};this.listeners=[{element:this.element,events:{dragstart:function(a){return h.emit("dragstart",a)},dragenter:function(a){c(a);return h.emit("dragenter",a)},dragover:function(a){c(a);return h.emit("dragover",a)},dragleave:function(a){return h.emit("dragleave",a)},drop:function(a){c(a);
return h.drop(a)},dragend:function(a){return h.emit("dragend",a)}}}];this.clickableElements.forEach(function(a){return h.listeners.push({element:a,events:{click:function(c){if(a!==h.element||c.target===h.element||b.elementInside(c.target,h.element.querySelector(".dz-message")))return h.hiddenFileInput.click()}}})});this.enable();return this.options.init.call(this)};b.prototype.destroy=function(){var a;this.disable();this.removeAllFiles(!0);if((a=this.hiddenFileInput)!=null&&a.parentNode)this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),
this.hiddenFileInput=null;return delete this.element.dropzone};b.prototype.updateTotalUploadProgress=function(){var a,b,c,d,e,f;b=c=0;if(this.getAcceptedFiles().length){f=this.getAcceptedFiles();d=0;for(e=f.length;d<e;d++)a=f[d],c+=a.upload.bytesSent,b+=a.upload.total;a=100*c/b}else a=100;return this.emit("totaluploadprogress",a,b,c)};b.prototype.getFallbackForm=function(){var a,c;if(a=this.getExistingFallback())return a;a='<div class="dz-fallback">';this.options.dictFallbackText&&(a+="<p>"+this.options.dictFallbackText+
"</p>");a+='<input type="file" name="'+this.options.paramName+(this.options.uploadMultiple?"[]":"")+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><button type="submit">Upload!</button></div>';a=b.createElement(a);this.element.tagName!=="FORM"?(c=b.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),c.appendChild(a)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",
this.options.method));return c!=null?c:a};b.prototype.getExistingFallback=function(){var a,b,c,d,e;b=function(a){var b,c,d;c=0;for(d=a.length;c<d;c++)if(b=a[c],/(^| )fallback($| )/.test(b.className))return b};e=["div","form"];c=0;for(d=e.length;c<d;c++)if(a=e[c],a=b(this.element.getElementsByTagName(a)))return a};b.prototype.setupEventListeners=function(){var a,b,c,d,e,f,g;f=this.listeners;g=[];d=0;for(e=f.length;d<e;d++)a=f[d],g.push(function(){var d,e;d=a.events;e=[];for(b in d)c=d[b],e.push(a.element.addEventListener(b,
c,!1));return e}());return g};b.prototype.removeEventListeners=function(){var a,b,c,d,e,f,g;f=this.listeners;g=[];d=0;for(e=f.length;d<e;d++)a=f[d],g.push(function(){var d,e;d=a.events;e=[];for(b in d)c=d[b],e.push(a.element.removeEventListener(b,c,!1));return e}());return g};b.prototype.disable=function(){var a,b,c,d,e;this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")});this.removeEventListeners();d=this.files;e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push(this.cancelUpload(a));
return e};b.prototype.enable=function(){this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")});return this.setupEventListeners()};b.prototype.filesize=function(a){var b;a>=1E11?(a/=1E11,b="TB"):a>=1E8?(a/=1E8,b="GB"):a>=1E5?(a/=1E5,b="MB"):a>=100?(a/=100,b="KB"):(a*=10,b="b");return"<strong>"+Math.round(a)/10+"</strong> "+b};b.prototype._updateMaxFilesReachedClass=function(){return this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?this.element.classList.add("dz-max-files-reached"):
this.element.classList.remove("dz-max-files-reached")};b.prototype.drop=function(a){var b;if(a.dataTransfer&&(this.emit("drop",a),b=a.dataTransfer.files,this.emit("selectedfiles",b),b.length))(a=a.dataTransfer.items)&&a.length&&(a[0].webkitGetAsEntry!=null||a[0].getAsEntry!=null)?this.handleItems(a):this.handleFiles(b)};b.prototype.handleFiles=function(a){var b,c,d,e;e=[];c=0;for(d=a.length;c<d;c++)b=a[c],e.push(this.addFile(b));return e};b.prototype.handleItems=function(a){var b,c,d,e;d=0;for(e=
a.length;d<e;d++)c=a[d],c.webkitGetAsEntry!=null?(b=c.webkitGetAsEntry(),b.isFile?this.addFile(c.getAsFile()):b.isDirectory&&this.addDirectory(b,b.name)):this.addFile(c.getAsFile())};b.prototype.accept=function(a,c){return a.size>this.options.maxFilesize*1048576?c(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):b.isValidFile(a,this.options.acceptedFiles)?this.options.maxFiles&&this.getAcceptedFiles().length>=
this.options.maxFiles?(c(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",a)):this.options.accept.call(this,a,c):c(this.options.dictInvalidFileType)};b.prototype.addFile=function(a){var c=this;a.upload={progress:0,total:a.size,bytesSent:0};this.files.push(a);a.status=b.ADDED;this.emit("addedfile",a);this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=this.options.maxThumbnailFilesize*1048576&&this.createThumbnail(a);return this.accept(a,
function(b){return b?(a.accepted=!1,c._errorProcessing([a],b)):c.enqueueFile(a)})};b.prototype.enqueueFiles=function(a){var b,c,d;c=0;for(d=a.length;c<d;c++)b=a[c],this.enqueueFile(b);return null};b.prototype.enqueueFile=function(a){var c=this;a.accepted=!0;if(a.status===b.ADDED){if(a.status=b.QUEUED,this.options.autoProcessQueue)return setTimeout(function(){return c.processQueue()},1)}else throw Error("This file can't be queued because it has already been processed or was rejected.");};b.prototype.addDirectory=
function(a,b){var c=this;return a.createReader().readEntries(function(d){var e,f;e=0;for(f=d.length;e<f;e++)a=d[e],a.isFile?a.file(function(a){if(!(c.options.ignoreHiddenFiles&&a.name.substring(0,1)==="."))return a.fullPath=""+b+"/"+a.name,c.addFile(a)}):a.isDirectory&&c.addDirectory(a,""+b+"/"+a.name)},function(a){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log(a):void 0:void 0})};b.prototype.removeFile=function(a){a.status===b.UPLOADING&&this.cancelUpload(a);
this.files=f(this.files,a);this.emit("removedfile",a);if(this.files.length===0)return this.emit("reset")};b.prototype.removeAllFiles=function(a){var c,d,e,f;a==null&&(a=!1);f=this.files.slice();d=0;for(e=f.length;d<e;d++)c=f[d],(c.status!==b.UPLOADING||a)&&this.removeFile(c);return null};b.prototype.createThumbnail=function(a){var b,c=this;b=new FileReader;b.onload=function(){var d;d=new Image;d.onload=function(){var b,e,f,g,h,i,j;a.width=d.width;a.height=d.height;f=c.options.resize.call(c,a);if(f.trgWidth==
null)f.trgWidth=c.options.thumbnailWidth;if(f.trgHeight==null)f.trgHeight=c.options.thumbnailHeight;b=document.createElement("canvas");e=b.getContext("2d");b.width=f.trgWidth;b.height=f.trgHeight;e.drawImage(d,(g=f.srcX)!=null?g:0,(h=f.srcY)!=null?h:0,f.srcWidth,f.srcHeight,(i=f.trgX)!=null?i:0,(j=f.trgY)!=null?j:0,f.trgWidth,f.trgHeight);b=b.toDataURL("image/png");return c.emit("thumbnail",a,b)};return d.src=b.result};return b.readAsDataURL(a)};b.prototype.processQueue=function(){var a,b,c,d;b=this.options.parallelUploads;
a=c=this.getUploadingFiles().length;if(!(c>=b)&&(d=this.getQueuedFiles(),d.length>0))if(this.options.uploadMultiple)return this.processFiles(d.slice(0,b-c));else for(;a<b;){if(!d.length)break;this.processFile(d.shift());a++}};b.prototype.processFile=function(a){return this.processFiles([a])};b.prototype.processFiles=function(a){var c,d,e;d=0;for(e=a.length;d<e;d++)c=a[d],c.processing=!0,c.status=b.UPLOADING,this.emit("processing",c);this.options.uploadMultiple&&this.emit("processingmultiple",a);return this.uploadFiles(a)};
b.prototype._getFilesWithXhr=function(a){var b;return function(){var c,d,e,f;e=this.files;f=[];c=0;for(d=e.length;c<d;c++)b=e[c],b.xhr===a&&f.push(b);return f}.call(this)};b.prototype.cancelUpload=function(a){var c,d,e,f;if(a.status===b.UPLOADING){d=this._getFilesWithXhr(a.xhr);e=0;for(f=d.length;e<f;e++)c=d[e],c.status=b.CANCELED;a.xhr.abort();a=0;for(e=d.length;a<e;a++)c=d[a],this.emit("canceled",c);this.options.uploadMultiple&&this.emit("canceledmultiple",d)}else if((c=a.status)===b.ADDED||c===
b.QUEUED)a.status=b.CANCELED,this.emit("canceled",a),this.options.uploadMultiple&&this.emit("canceledmultiple",[a]);if(this.options.autoProcessQueue)return this.processQueue()};b.prototype.uploadFile=function(a){return this.uploadFiles([a])};b.prototype.uploadFiles=function(a){var d,e,f,g,h,i,j,k,m,q,B,O,R,M=this;m=new XMLHttpRequest;g=0;for(h=a.length;g<h;g++)d=a[g],d.xhr=m;m.open(this.options.method,this.options.url,!0);m.withCredentials=!!this.options.withCredentials;j=null;f=function(){var b,
c,e;e=[];b=0;for(c=a.length;b<c;b++)d=a[b],e.push(M._errorProcessing(a,j||M.options.dictResponseError.replace("{{statusCode}}",m.status),m));return e};k=function(b){var c,e,f;if(b!=null){c=100*b.loaded/b.total;e=0;for(f=a.length;e<f;e++)d=a[e],d.upload={progress:c,total:b.total,bytesSent:b.loaded}}else{b=!0;c=100;e=0;for(f=a.length;e<f;e++)d=a[e],d.upload.progress===100&&d.upload.bytesSent===d.upload.total||(b=!1),d.upload.progress=c,d.upload.bytesSent=d.upload.total;if(b)return}f=[];b=0;for(e=a.length;b<
e;b++)d=a[b],f.push(M.emit("uploadprogress",d,c,d.upload.bytesSent));return f};m.onload=function(c){var d;if(a[0].status!==b.CANCELED&&m.readyState===4){j=m.responseText;if(m.getResponseHeader("content-type")&&~m.getResponseHeader("content-type").indexOf("application/json"))try{j=JSON.parse(j)}catch(e){c=e,j="Invalid JSON response from server."}k();return 200<=(d=m.status)&&d<300?M._finished(a,j,c):f()}};m.onerror=function(){if(a[0].status!==b.CANCELED)return f()};((q=m.upload)!=null?q:m).onprogress=
k;h={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};this.options.headers&&c(h,this.options.headers);for(e in h)g=h[e],m.setRequestHeader(e,g);e=new FormData;if(this.options.params)for(i in h=this.options.params,h)g=h[i],e.append(i,g);i=0;for(g=a.length;i<g;i++)d=a[i],this.emit("sending",d,m,e);this.options.uploadMultiple&&this.emit("sendingmultiple",a,m,e);if(this.element.tagName==="FORM"){R=this.element.querySelectorAll("input, textarea, select, button");
q=0;for(O=R.length;q<O;q++)i=R[q],g=i.getAttribute("name"),h=i.getAttribute("type"),(!h||(B=h.toLowerCase())!=="checkbox"&&B!=="radio"||i.checked)&&e.append(g,i.value)}B=0;for(i=a.length;B<i;B++)d=a[B],e.append(""+this.options.paramName+(this.options.uploadMultiple?"[]":""),d,d.name);return m.send(e)};b.prototype._finished=function(a,c,d){var e,f,g;f=0;for(g=a.length;f<g;f++)e=a[f],e.status=b.SUCCESS,this.emit("success",e,c,d),this.emit("complete",e);this.options.uploadMultiple&&(this.emit("successmultiple",
a,c,d),this.emit("completemultiple",a));if(this.options.autoProcessQueue)return this.processQueue()};b.prototype._errorProcessing=function(a,c,d){var e,f,g;f=0;for(g=a.length;f<g;f++)e=a[f],e.status=b.ERROR,this.emit("error",e,c,d),this.emit("complete",e);this.options.uploadMultiple&&(this.emit("errormultiple",a,c,d),this.emit("completemultiple",a));if(this.options.autoProcessQueue)return this.processQueue()};return b}(c);b.version="3.7.1";b.options={};b.optionsForElement=function(c){if(c.id)return b.options[a(c.id)]};
b.instances=[];b.forElement=function(a){typeof a==="string"&&(a=document.querySelector(a));if((a!=null?a.dropzone:void 0)==null)throw Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return a.dropzone};b.autoDiscover=!0;b.discover=function(){var a,c,d,e,f;document.querySelectorAll?c=document.querySelectorAll(".dropzone"):(c=[],a=function(a){var b,
d,e,f;f=[];d=0;for(e=a.length;d<e;d++)b=a[d],/(^| )dropzone($| )/.test(b.className)?f.push(c.push(b)):f.push(void 0);return f},a(document.getElementsByTagName("div")),a(document.getElementsByTagName("form")));f=[];d=0;for(e=c.length;d<e;d++)a=c[d],b.optionsForElement(a)!==!1?f.push(new b(a)):f.push(void 0);return f};b.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];b.isBrowserSupported=function(){var a,c,d,e,f;a=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&
document.querySelector)if("classList"in document.createElement("a")){f=b.blacklistedBrowsers;d=0;for(e=f.length;d<e;d++)c=f[d],c.test(navigator.userAgent)&&(a=!1)}else a=!1;else a=!1;return a};f=function(a,b){var c,d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],c!==b&&f.push(c);return f};a=function(a){return a.replace(/[\-_](\w)/g,function(a){return a[1].toUpperCase()})};b.createElement=function(a){var b;b=document.createElement("div");b.innerHTML=a;return b.childNodes[0]};b.elementInside=function(a,
b){if(a===b)return!0;for(;a=a.parentNode;)if(a===b)return!0;return!1};b.getElement=function(a,b){var c;typeof a==="string"?c=document.querySelector(a):a.nodeType!=null&&(c=a);if(c==null)throw Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");return c};b.getElements=function(a,b){var c,d,e,f,g;if(a instanceof Array){d=[];try{e=0;for(f=a.length;e<f;e++)c=a[e],d.push(this.getElement(c,b))}catch(h){d=null}}else if(typeof a==="string"){d=[];g=document.querySelectorAll(a);
e=0;for(f=g.length;e<f;e++)c=g[e],d.push(c)}else a.nodeType!=null&&(d=[a]);if(!(d!=null&&d.length))throw Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return d};b.confirm=function(a,b,c){if(window.confirm(a))return b();else if(c!=null)return c()};b.isValidFile=function(a,b){var c,d,e,f,g;if(!b)return!0;b=b.split(",");d=a.type;c=d.replace(/\/.*$/,"");f=0;for(g=b.length;f<g;f++)if(e=b[f],e=e.trim(),e.charAt(0)==="."){if(a.name.indexOf(e,
a.name.length-e.length)!==-1)return!0}else if(/\/\*$/.test(e)){if(c===e.replace(/\/.*$/,""))return!0}else if(d===e)return!0;return!1};if(typeof jQuery!=="undefined"&&jQuery!==null)jQuery.fn.dropzone=function(a){return this.each(function(){return new b(this,a)})};typeof i!=="undefined"&&i!==null?i.exports=b:window.Dropzone=b;b.ADDED="added";b.QUEUED="queued";b.ACCEPTED=b.QUEUED;b.UPLOADING="uploading";b.PROCESSING=b.UPLOADING;b.CANCELED="canceled";b.ERROR="error";b.SUCCESS="success";b._autoDiscoverFunction=
function(){if(b.autoDiscover)return b.discover()};(function(a,b){var c,d,e,f,g,h,i,j,m;e=!1;m=!0;d=a.document;j=d.documentElement;c=d.addEventListener?"addEventListener":"attachEvent";i=d.addEventListener?"removeEventListener":"detachEvent";h=d.addEventListener?"":"on";f=function(c){if(!(c.type==="readystatechange"&&d.readyState!=="complete")&&((c.type==="load"?a:d)[i](h+c.type,f,!1),!e&&(e=!0)))return b.call(a,c.type||c)};g=function(){try{j.doScroll("left")}catch(a){setTimeout(g,50);return}return f("poll")};
if(d.readyState!=="complete"){if(d.createEventObject&&j.doScroll){try{m=!a.frameElement}catch(q){}m&&g()}d[c](h+"DOMContentLoaded",f,!1);d[c](h+"readystatechange",f,!1);return a[c](h+"load",f,!1)}})(window,b._autoDiscoverFunction)}).call(this)});c.alias("component-emitter/index.js","dropzone/deps/emitter/index.js");c.alias("component-emitter/index.js","emitter/index.js");typeof exports=="object"?module.exports=c("dropzone"):typeof define=="function"&&define.amd?define(function(){return c("dropzone")}):
this.Dropzone=c("dropzone")})();
